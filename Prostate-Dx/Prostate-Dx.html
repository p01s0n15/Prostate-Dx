<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>75e7922411da412ea6869c4db747f630</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="1"
data-_cell_guid="b1076dfc-b9ad-4769-8c92-a6c4dae69d19"
data-_uuid="8f2839f25d086af736a60e9eeb907d3b93b6e0e5"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:19:15.902869Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:19:15.902408Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:19:18.774717Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:19:18.773562Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:19:15.902818Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#imports here </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pydicom</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pydicom <span class="im">as</span> dicom</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="2"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:19:18.777679Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:19:18.777112Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:19:18.799245Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:19:18.797859Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:19:18.777640Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EDA on 1st dataset(worldwidecovid)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>path_data_1_combined <span class="op">=</span> <span class="st">&quot;/kaggle/input/world-wide-covid-dataset/PROSTATE_MRI&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#read metadata sheet</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(os.path.join(path_data_1_combined,<span class="st">&#39;metadata.csv&#39;</span>))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="3"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:19:18.800594Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:19:18.800252Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:19:18.820479Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:19:18.819253Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:19:18.800559Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head())</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#this tells us that multiple mri scans have been taken for each patient</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>                                          Series UID    Collection  \
0  1.3.6.1.4.1.14519.5.2.1.9823.1001.165695987073...  PROSTATE-MRI   
1  1.3.6.1.4.1.14519.5.2.1.9823.1001.124620957890...  PROSTATE-MRI   
2  1.3.6.1.4.1.14519.5.2.1.9823.1001.124348664925...  PROSTATE-MRI   
3  1.3.6.1.4.1.14519.5.2.1.9823.1001.249502735639...  PROSTATE-MRI   
4  1.3.6.1.4.1.14519.5.2.1.9823.1001.337753368395...  PROSTATE-MRI   

   3rd Party Analysis                           Data Description URI  \
0                 NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
1                 NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
2                 NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
3                 NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
4                 NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   

             Subject ID                                          Study UID  \
0  MIP-PROSTATE-01-0001  1.3.6.1.4.1.14519.5.2.1.9823.1001.120983205477...   
1  MIP-PROSTATE-01-0001  1.3.6.1.4.1.14519.5.2.1.9823.1001.120983205477...   
2  MIP-PROSTATE-01-0001  1.3.6.1.4.1.14519.5.2.1.9823.1001.120983205477...   
3  MIP-PROSTATE-01-0001  1.3.6.1.4.1.14519.5.2.1.9823.1001.120983205477...   
4  MIP-PROSTATE-01-0001  1.3.6.1.4.1.14519.5.2.1.9823.1001.120983205477...   

  Study Description  Study Date Series Description             Manufacturer  \
0  MRI Prostate ERC  04-30-2006        DCE 262 pre  Philips Medical Systems   
1  MRI Prostate ERC  04-30-2006         T2 TSE sag  Philips Medical Systems   
2  MRI Prostate ERC  04-30-2006         T2 TSE cor  Philips Medical Systems   
3  MRI Prostate ERC  04-30-2006      dSShDWI SENSE  Philips Medical Systems   
4  MRI Prostate ERC  04-30-2006        SShDWI FAST  Philips Medical Systems   

  Modality    SOP Class Name              SOP Class UID  Number of Images  \
0       MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4                10   
1       MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4                18   
2       MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4                16   
3       MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4                20   
4       MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4               100   

  File Size                                      File Location  \
0   1.34 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0001/04-30-2006...   
1   9.49 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0001/04-30-2006...   
2   8.43 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0001/04-30-2006...   
3   1.30 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0001/04-30-2006...   
4   6.48 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0001/04-30-2006...   

        Download Timestamp  
0   2022-07-01T22:43:28.05  
1  2022-07-01T22:43:30.377  
2  2022-07-01T22:43:30.397  
3  2022-07-01T22:43:31.504  
4  2022-07-01T22:43:33.342  
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="4"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:19:18.822336Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:19:18.821976Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:19:18.841389Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:19:18.840147Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:19:18.822298Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                                            Series UID    Collection  \
0    1.3.6.1.4.1.14519.5.2.1.9823.1001.165695987073...  PROSTATE-MRI   
1    1.3.6.1.4.1.14519.5.2.1.9823.1001.124620957890...  PROSTATE-MRI   
2    1.3.6.1.4.1.14519.5.2.1.9823.1001.124348664925...  PROSTATE-MRI   
3    1.3.6.1.4.1.14519.5.2.1.9823.1001.249502735639...  PROSTATE-MRI   
4    1.3.6.1.4.1.14519.5.2.1.9823.1001.337753368395...  PROSTATE-MRI   
..                                                 ...           ...   
177  1.3.6.1.4.1.14519.5.2.1.9823.1001.533477093780...  PROSTATE-MRI   
178  1.3.6.1.4.1.14519.5.2.1.9823.1001.265206328399...  PROSTATE-MRI   
179  1.3.6.1.4.1.14519.5.2.1.9823.1001.289941266194...  PROSTATE-MRI   
180  1.3.6.1.4.1.14519.5.2.1.9823.1001.263616732878...  PROSTATE-MRI   
181  1.3.6.1.4.1.14519.5.2.1.9823.1001.255470204300...  PROSTATE-MRI   

     3rd Party Analysis                           Data Description URI  \
0                   NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
1                   NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
2                   NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
3                   NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
4                   NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
..                  ...                                            ...   
177                 NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
178                 NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
179                 NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
180                 NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   
181                 NaN  https://doi.org/10.7937/K9/TCIA.2016.6046GUDv   

               Subject ID                                          Study UID  \
0    MIP-PROSTATE-01-0001  1.3.6.1.4.1.14519.5.2.1.9823.1001.120983205477...   
1    MIP-PROSTATE-01-0001  1.3.6.1.4.1.14519.5.2.1.9823.1001.120983205477...   
2    MIP-PROSTATE-01-0001  1.3.6.1.4.1.14519.5.2.1.9823.1001.120983205477...   
3    MIP-PROSTATE-01-0001  1.3.6.1.4.1.14519.5.2.1.9823.1001.120983205477...   
4    MIP-PROSTATE-01-0001  1.3.6.1.4.1.14519.5.2.1.9823.1001.120983205477...   
..                    ...                                                ...   
177  MIP-PROSTATE-01-0024  1.3.6.1.4.1.14519.5.2.1.9823.1001.259289379450...   
178  MIP-PROSTATE-01-0026  1.3.6.1.4.1.14519.5.2.1.9823.1001.781423597935...   
179  MIP-PROSTATE-01-0026  1.3.6.1.4.1.14519.5.2.1.9823.1001.781423597935...   
180  MIP-PROSTATE-01-0025  1.3.6.1.4.1.14519.5.2.1.9823.1001.330054997044...   
181  MIP-PROSTATE-01-0026  1.3.6.1.4.1.14519.5.2.1.9823.1001.781423597935...   

    Study Description  Study Date Series Description             Manufacturer  \
0    MRI Prostate ERC  04-30-2006        DCE 262 pre  Philips Medical Systems   
1    MRI Prostate ERC  04-30-2006         T2 TSE sag  Philips Medical Systems   
2    MRI Prostate ERC  04-30-2006         T2 TSE cor  Philips Medical Systems   
3    MRI Prostate ERC  04-30-2006      dSShDWI SENSE  Philips Medical Systems   
4    MRI Prostate ERC  04-30-2006        SShDWI FAST  Philips Medical Systems   
..                ...         ...                ...                      ...   
177  MRI Prostate ERC  05-07-2006        DCE 262 3.1  Philips Medical Systems   
178  MRI Prostate ERC  07-09-2006        SShDWI FAST  Philips Medical Systems   
179  MRI Prostate ERC  07-09-2006       T2 TSE ax hi  Philips Medical Systems   
180  MRI Prostate ERC  01-21-2006        DCE 262 3.1  Philips Medical Systems   
181  MRI Prostate ERC  07-09-2006        DCE 262 3.1  Philips Medical Systems   

    Modality    SOP Class Name              SOP Class UID  Number of Images  \
0         MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4                10   
1         MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4                18   
2         MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4                16   
3         MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4                20   
4         MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4               100   
..       ...               ...                        ...               ...   
177       MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4              1000   
178       MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4               100   
179       MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4                26   
180       MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4              1000   
181       MR  MR Image Storage  1.2.840.10008.5.1.4.1.1.4              1000   

     File Size                                      File Location  \
0      1.34 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0001/04-30-2006...   
1      9.49 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0001/04-30-2006...   
2      8.43 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0001/04-30-2006...   
3      1.30 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0001/04-30-2006...   
4      6.48 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0001/04-30-2006...   
..         ...                                                ...   
177  133.95 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0024/05-07-2006...   
178    6.49 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0026/07-09-2006...   
179   13.71 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0026/07-09-2006...   
180  133.96 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0025/01-21-2006...   
181  134.01 MB  ./PROSTATE-MRI/MIP-PROSTATE-01-0026/07-09-2006...   

          Download Timestamp  
0     2022-07-01T22:43:28.05  
1    2022-07-01T22:43:30.377  
2    2022-07-01T22:43:30.397  
3    2022-07-01T22:43:31.504  
4    2022-07-01T22:43:33.342  
..                       ...  
177  2022-07-01T22:50:13.925  
178  2022-07-01T22:50:16.582  
179  2022-07-01T22:50:24.838  
180  2022-07-01T22:50:28.566  
181  2022-07-01T22:50:37.784  

[182 rows x 17 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="5"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:19:18.845662Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:19:18.845198Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:19:18.855989Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:19:18.854789Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:19:18.845621Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#average number of scans per patient </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#for that pick the number of columns </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#this sheet can be used for us to iterate the files as necessary</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#SubjectID identifies the patient</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Number of Rows:&quot;</span>,<span class="bu">len</span>(df[<span class="st">&quot;Number of Images&quot;</span>]))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#indicate the number of unique patients</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of Rows: 182
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="6"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:19:18.858050Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:19:18.857571Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:19:18.867948Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:19:18.866682Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:19:18.858000Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> rowdata <span class="kw">in</span> df[<span class="st">&#39;Number of Images&#39;</span>]:</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    total<span class="op">+=</span>rowdata</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Average number of MRI scans each patient underwent are:&quot;</span>,total<span class="op">/</span><span class="dv">182</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Average number of MRI scans each patient underwent are: 121.07692307692308
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="7"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:19:18.869967Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:19:18.869360Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:19:18.886469Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:19:18.885095Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:19:18.869903Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#methodologies used and ranking</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>methods_unique <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> method <span class="kw">in</span> df[<span class="st">&#39;Series Description&#39;</span>]:</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    methods_unique.add(method)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="8"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:19:18.888776Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:19:18.888309Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:19:18.905420Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:19:18.904183Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:19:18.888726Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Protocols used:&quot;</span>,methods_unique)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Protocols used: {&#39;T2 TSE cor&#39;, &#39;dSShDWI SENSE&#39;, &#39;DCE 5.6s 4xSOVS P5S1&#39;, &#39;T1 FA2 4xSOVS P5S1 inphase&#39;, &#39;DCE Pre 4xSOVS P5S2&#39;, &#39;SShDWI FAST&#39;, &#39;DCE 262 pre&#39;, &#39;DCE Pre 4xSOVS P4S2&#39;, &#39;T2 TSE ax hi&#39;, &#39;DCE 262 3.1&#39;, &#39;DCE 5.6s 4xSOVS P4S2&#39;, &#39;T2 TSE sag&#39;, &#39;DCE Pre 4xSOVS P5S1&#39;}
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="9"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:19:18.907446Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:19:18.906912Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:19:18.920283Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:19:18.918973Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:19:18.907392Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Number of unique protocols used:&quot;</span>,<span class="bu">len</span>(methods_unique))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of unique protocols used: 13
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="10"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:19:18.922262Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:19:18.921839Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:19:18.937002Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:19:18.935771Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:19:18.922223Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#find out the most used technique for mri</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>max_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>method_max <span class="op">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ele <span class="kw">in</span> methods_unique:</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> method <span class="kw">in</span> df[<span class="st">&#39;Series Description&#39;</span>]:</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(ele <span class="op">==</span> method):</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>            count<span class="op">+=</span><span class="dv">1</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> count<span class="op">&gt;=</span>max_count:</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        max_count <span class="op">=</span> count</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        method_max <span class="op">=</span> ele</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(method_max)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(max_count)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The most used method is:&quot;</span>,method_max)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>T2 TSE cor
26
dSShDWI SENSE
26
SShDWI FAST
47
T2 TSE sag
69
The most used method is: T2 TSE sag
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="11"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:19:18.938606Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:19:18.938247Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:02.142477Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:02.141520Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:19:18.938568Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Path to the combined directory containing DICOM files</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>combined_path <span class="op">=</span> os.path.join(path_data_1_combined, <span class="st">&quot;PROSTATE-MRI&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each directory in the combined path</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> direct <span class="kw">in</span> os.listdir(combined_path):</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    image_path <span class="op">=</span> os.path.join(combined_path, direct)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only process directories (you might want to add additional checks here)</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> os.path.isdir(image_path) <span class="kw">and</span> direct <span class="op">!=</span> <span class="st">&#39;LICENSE&#39;</span>:</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use os.walk to iterate through the files in the directory</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> dirpath, dirnames, filenames <span class="kw">in</span> os.walk(image_path):</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Only read one DICOM file</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> filename <span class="kw">in</span> filenames:</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Construct the full path to the DICOM file</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                file_path <span class="op">=</span> os.path.join(dirpath, filename)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Check if the file is a DICOM file</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> filename.lower().endswith(<span class="st">&#39;.dcm&#39;</span>) <span class="kw">and</span> counter <span class="op">&lt;</span> <span class="dv">1</span>:</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>                    ds <span class="op">=</span> pydicom.dcmread(file_path)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Access pixel data</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">&#39;PixelData&#39;</span> <span class="kw">in</span> ds:</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>                        pixel_array <span class="op">=</span> ds.pixel_array</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Display the image</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>                        plt.imshow(pixel_array, cmap<span class="op">=</span><span class="st">&#39;gray&#39;</span>)  <span class="co"># Use &#39;gray&#39; colormap for grayscale images</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>                        plt.title(<span class="st">&#39;DICOM Image&#39;</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>                        plt.axis(<span class="st">&#39;off&#39;</span>)  <span class="co"># Hide axes</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>                        plt.show()</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>                        counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(<span class="st">&quot;No pixel data found in this DICOM file.&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/912d694dd3d3b2c30f0c391dd17259011e94cd8b.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/e4f9d9c9e504cc5d6f24fd275f4510c3522ec938.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/97f61b400744077191d5109a10040b3d11c46e7f.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/f8bb7a04272514b101d8894e0adf400a3ba28af0.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/ad8cd14ee4b84f64a9a4bf1f88b235e0ac441e14.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/d8697f4806f0d0458d1fbf75a06e66c65593360d.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/eedeb75117d3c9f48f90d23b4ac895d6a68bdbaf.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/b394eecb2a6e300fae81b8309318e5d0cc09169f.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/31f456c472a6349208f02ea4132c43afc3f71908.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/f2c3022d2d9e9a3c03bd84f41e6c5bcf889e2168.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/dae2e691c399b6772bc7b60484d3346e400bb731.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/5ee2e217de40755a578edaa0b441becfbe258987.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/3fc10abae0e98ea7db24a06ef55c51f8e5730458.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/f94fc4c789ff989ce7ddea3b7282182d4bec34ba.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/d9773aedc033930ead5c58609abb016102a07782.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/48f8513e870459496b44e89f5b15d1b76699bba6.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/769b3923086d351ff9f474e214f4f27f2b75f127.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/fa10fbb7785902250c09e593be1ab80a50ea71cf.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/d3b04d386573a0cc0a7cafe5b861dfbe53ad9432.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/e2c7e7a2bed4106e1e6e89759635aa5e56118eae.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/1a72cf4d9c369807bfaff564591fc9a5921388c4.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/ff31e44a580630432b89ad712b099eefcdfa6fee.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/312389bb928a78e0931d3ce1770ec7aa56796f70.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/55e7c9ae72582a5cbdae1e9af379602fb0ea4aa0.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/4d076714f26b1575c4ffcdfda434ed76cffcd81d.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/f1f9983b574c198e5b02a57f4e62c49815bb4d8a.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="12"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:02.143943Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:02.143611Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:02.195068Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:02.194170Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:02.143912Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#eda on prostatemriusbiopsy</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>path_to_2_combined <span class="op">=</span> <span class="st">&quot;/kaggle/input/prostate-mri-us-biopsy&quot;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.read_csv(os.path.join(path_to_2_combined , <span class="st">&#39;metadata.csv&#39;</span>))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="13"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:02.197007Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:02.196454Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:02.208680Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:02.207564Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:02.196943Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df2.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                                          Series UID              Collection  \
0  1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...  Prostate-MRI-US-Biopsy   
1  1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...  Prostate-MRI-US-Biopsy   
2  1.3.6.1.4.1.14519.5.2.1.1202285930413120999892...  Prostate-MRI-US-Biopsy   
3  1.3.6.1.4.1.14519.5.2.1.1867491288236660505887...  Prostate-MRI-US-Biopsy   
4  1.3.6.1.4.1.14519.5.2.1.2007760325377179554571...  Prostate-MRI-US-Biopsy   

   3rd Party Analysis                        Data Description URI  \
0                 NaN  https://doi.org/10.7937/TCIA.2020.A61IOC1A   
1                 NaN  https://doi.org/10.7937/TCIA.2020.A61IOC1A   
2                 NaN  https://doi.org/10.7937/TCIA.2020.A61IOC1A   
3                 NaN  https://doi.org/10.7937/TCIA.2020.A61IOC1A   
4                 NaN  https://doi.org/10.7937/TCIA.2020.A61IOC1A   

                    Subject ID  \
0  Prostate-MRI-US-Biopsy-0001   
1  Prostate-MRI-US-Biopsy-0001   
2  Prostate-MRI-US-Biopsy-0001   
3  Prostate-MRI-US-Biopsy-0002   
4  Prostate-MRI-US-Biopsy-0002   

                                           Study UID  \
0  1.3.6.1.4.1.14519.5.2.1.1680539519414448949292...   
1  1.3.6.1.4.1.14519.5.2.1.8554830492196565836772...   
2  1.3.6.1.4.1.14519.5.2.1.3019932889266692284498...   
3  1.3.6.1.4.1.14519.5.2.1.1463632302552682075663...   
4  1.3.6.1.4.1.14519.5.2.1.6198721920224931467771...   

            Study Description  Study Date         Series Description  \
0                3D Rendering  07-17-2009                        NaN   
1  MRI PROSTATE W WO CONTRAST  06-28-2009  t2spcrstaxial oblProstate   
2                3D Rendering  11-28-2010                        NaN   
3  MRI PROSTATE W WO CONTRAST  03-26-2009  t2spcrstaxial oblProstate   
4                3D Rendering  07-25-2010                        NaN   

  Manufacturer Modality                        SOP Class Name  \
0        Eigen       US  Ultrasound Multi-frame Image Storage   
1      SIEMENS       MR                      MR Image Storage   
2        Eigen       US  Ultrasound Multi-frame Image Storage   
3      SIEMENS       MR                      MR Image Storage   
4        Eigen       US  Ultrasound Multi-frame Image Storage   

                 SOP Class UID  Number of Images File Size  \
0  1.2.840.10008.5.1.4.1.1.3.1                 1  29.42 MB   
1    1.2.840.10008.5.1.4.1.1.4                60   8.08 MB   
2  1.2.840.10008.5.1.4.1.1.3.1                 1  29.42 MB   
3    1.2.840.10008.5.1.4.1.1.4                60   8.10 MB   
4  1.2.840.10008.5.1.4.1.1.3.1                 1  29.88 MB   

                                       File Location       Download Timestamp  
0  ./Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biops...  2023-09-12T21:29:45.331  
1  ./Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biops...  2023-09-12T21:29:45.762  
2  ./Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biops...  2023-09-12T21:29:48.683  
3  ./Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biops...  2023-09-12T21:29:52.657  
4  ./Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biops...  2023-09-12T21:29:56.385  
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="14"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:02.213606Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:02.213227Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:09.646956Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:09.645926Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:02.213571Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>excel_for_dataset <span class="op">=</span> <span class="st">&#39;/kaggle/input/prostate-mri-us-biopsy/TCIA Biopsy Data_2020-07-14.xlsx&#39;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> pd.read_excel(excel_for_dataset)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="15"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:09.648623Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:09.648139Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:09.666265Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:09.664870Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:09.648587Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df3.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>   PSA (ng/mL)  Primary Gleason  Secondary Gleason  Cancer Length (mm)  \
0         10.9              NaN                NaN                 NaN   
1         10.9              3.0                4.0                 4.0   
2         10.9              3.0                3.0                 2.0   
3         10.9              NaN                NaN                 NaN   
4         10.9              NaN                NaN                 NaN   

   % Cancer in Core  Core Fragment #1 Tissue Length (mm)  \
0               NaN                                 10.0   
1              50.0                                 14.0   
2              10.0                                 10.0   
3               NaN                                 12.0   
4               NaN                                 14.0   

   Core Fragment #2 Tissue Length (mm)  Core Fragment #3 Tissue Length (mm)  \
0                                  3.0                                  NaN   
1                                  NaN                                  NaN   
2                                  2.0                                  1.0   
3                                  4.0                                  NaN   
4                                  NaN                                  NaN   

   Bx Tip X (MRI Coord)  Bx Tip Y (MRI Coord)  ...  Bx Tip Y (US Coord)  \
0                -8.915                34.791  ...               12.970   
1                -5.644                23.161  ...                6.628   
2                -9.642                22.070  ...               10.436   
3               -11.095                30.429  ...               -0.950   
4               -18.001                25.705  ...                8.100   

   Bx Tip Z (US Coord)  Bx Base X (US Coord)  Bx Base Y (US Coord)  \
0                9.888                14.970                30.545   
1                1.831                19.342                23.864   
2               -5.368                16.782                27.651   
3               17.006                10.307                15.876   
4               -2.421                11.157                26.813   

   Bx Base Z (US Coord)  Prostate Volume (CC)         Core Label  \
0                 8.399              49.14195  LEFT LATERAL BASE   
1                 2.066              49.14195   LEFT LATERAL MID   
2                -2.674              49.14195  LEFT LATERAL APEX   
3                15.351              49.14195          LEFT BASE   
4                -1.681              49.14195           LEFT MID   

                            Series Instance UID (US)  \
0  1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
1  1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
2  1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
3  1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
4  1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   

                           Series Instance UID (MRI)  \
0  1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   
1  1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   
2  1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   
3  1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   
4  1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   

                Patient Number  
0  Prostate-MRI-US-Biopsy-0001  
1  Prostate-MRI-US-Biopsy-0001  
2  Prostate-MRI-US-Biopsy-0001  
3  Prostate-MRI-US-Biopsy-0001  
4  Prostate-MRI-US-Biopsy-0001  

[5 rows x 25 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="16"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:09.668262Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:09.667909Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:09.710485Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:09.709316Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:09.668227Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df3)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>       PSA (ng/mL)  Primary Gleason  Secondary Gleason  Cancer Length (mm)  \
0             10.9              NaN                NaN                 NaN   
1             10.9              3.0                4.0                 4.0   
2             10.9              3.0                3.0                 2.0   
3             10.9              NaN                NaN                 NaN   
4             10.9              NaN                NaN                 NaN   
...            ...              ...                ...                 ...   
24778          7.1              NaN                NaN                 NaN   
24779          7.1              3.0                3.0                 0.5   
24780          7.1              3.0                4.0                 7.0   
24781          7.1              NaN                NaN                 NaN   
24782          7.1              NaN                NaN                 NaN   

       % Cancer in Core  Core Fragment #1 Tissue Length (mm)  \
0                   NaN                                 10.0   
1                  50.0                                 14.0   
2                  10.0                                 10.0   
3                   NaN                                 12.0   
4                   NaN                                 14.0   
...                 ...                                  ...   
24778               NaN                                 11.0   
24779               5.0                                 15.0   
24780              50.0                                 16.0   
24781               NaN                                 21.0   
24782               NaN                                 16.0   

       Core Fragment #2 Tissue Length (mm)  \
0                                      3.0   
1                                      NaN   
2                                      2.0   
3                                      4.0   
4                                      NaN   
...                                    ...   
24778                                  NaN   
24779                                  NaN   
24780                                  NaN   
24781                                  NaN   
24782                                  NaN   

       Core Fragment #3 Tissue Length (mm)  Bx Tip X (MRI Coord)  \
0                                      NaN                -8.915   
1                                      NaN                -5.644   
2                                      1.0                -9.642   
3                                      NaN               -11.095   
4                                      NaN               -18.001   
...                                    ...                   ...   
24778                                  NaN                -6.153   
24779                                  NaN                -2.746   
24780                                  NaN                -5.017   
24781                                  NaN                -2.178   
24782                                  NaN                -6.153   

       Bx Tip Y (MRI Coord)  ...  Bx Tip Y (US Coord)  Bx Tip Z (US Coord)  \
0                    34.791  ...               12.970                9.888   
1                    23.161  ...                6.628                1.831   
2                    22.070  ...               10.436               -5.368   
3                    30.429  ...               -0.950               17.006   
4                    25.705  ...                8.100               -2.421   
...                     ...  ...                  ...                  ...   
24778                34.577  ...               -7.937               -6.867   
24779                39.404  ...               -9.184                4.916   
24780                39.688  ...              -15.243                9.956   
24781                32.305  ...              -16.421                5.444   
24782                34.293  ...              -13.739                0.521   

       Bx Base X (US Coord)  Bx Base Y (US Coord)  Bx Base Z (US Coord)  \
0                    14.970                30.545                 8.399   
1                    19.342                23.864                 2.066   
2                    16.782                27.651                -2.674   
3                    10.307                15.876                15.351   
4                    11.157                26.813                -1.681   
...                     ...                   ...                   ...   
24778               -12.046                11.006                -5.483   
24779               -10.892                 9.795                 4.759   
24780               -11.523                 3.662                 8.061   
24781                -8.507                 2.287                 5.103   
24782               -11.916                 5.198                 0.344   

       Prostate Volume (CC)                Core Label  \
0                 49.141950         LEFT LATERAL BASE   
1                 49.141950          LEFT LATERAL MID   
2                 49.141950         LEFT LATERAL APEX   
3                 49.141950                 LEFT BASE   
4                 49.141950                  LEFT MID   
...                     ...                       ...   
24778             37.386039        RIGHT LATERAL APEX   
24779             37.386039  TARGET OR PRIOR POSITIVE   
24780             37.386039  TARGET OR PRIOR POSITIVE   
24781             37.386039  TARGET OR PRIOR POSITIVE   
24782             37.386039  TARGET OR PRIOR POSITIVE   

                                Series Instance UID (US)  \
0      1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
1      1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
2      1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
3      1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
4      1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
...                                                  ...   
24778  1.3.6.1.4.1.14519.5.2.1.3288852678732554921732...   
24779  1.3.6.1.4.1.14519.5.2.1.3288852678732554921732...   
24780  1.3.6.1.4.1.14519.5.2.1.3288852678732554921732...   
24781  1.3.6.1.4.1.14519.5.2.1.3288852678732554921732...   
24782  1.3.6.1.4.1.14519.5.2.1.3288852678732554921732...   

                               Series Instance UID (MRI)  \
0      1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   
1      1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   
2      1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   
3      1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   
4      1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   
...                                                  ...   
24778  1.3.6.1.4.1.14519.5.2.1.1607378456669152878862...   
24779  1.3.6.1.4.1.14519.5.2.1.1607378456669152878862...   
24780  1.3.6.1.4.1.14519.5.2.1.1607378456669152878862...   
24781  1.3.6.1.4.1.14519.5.2.1.1607378456669152878862...   
24782  1.3.6.1.4.1.14519.5.2.1.1607378456669152878862...   

                    Patient Number  
0      Prostate-MRI-US-Biopsy-0001  
1      Prostate-MRI-US-Biopsy-0001  
2      Prostate-MRI-US-Biopsy-0001  
3      Prostate-MRI-US-Biopsy-0001  
4      Prostate-MRI-US-Biopsy-0001  
...                            ...  
24778  Prostate-MRI-US-Biopsy-1151  
24779  Prostate-MRI-US-Biopsy-1151  
24780  Prostate-MRI-US-Biopsy-1151  
24781  Prostate-MRI-US-Biopsy-1151  
24782  Prostate-MRI-US-Biopsy-1151  

[24783 rows x 25 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="17"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:09.712563Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:09.712189Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:09.718081Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:09.717144Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:09.712528Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df3.columns)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Index([&#39;PSA (ng/mL)&#39;, &#39;Primary Gleason&#39;, &#39;Secondary Gleason&#39;,
       &#39;Cancer Length (mm)&#39;, &#39;% Cancer in Core&#39;,
       &#39;Core Fragment #1 Tissue Length (mm)&#39;,
       &#39;Core Fragment #2 Tissue Length (mm)&#39;,
       &#39;Core Fragment #3 Tissue Length (mm)&#39;, &#39;Bx Tip X (MRI Coord)&#39;,
       &#39;Bx Tip Y (MRI Coord)&#39;, &#39;Bx Tip Z (MRI Coord)&#39;, &#39;Bx Base X (MRI Coord)&#39;,
       &#39;Bx Base Y (MRI Coord)&#39;, &#39;Bx Base Z (MRI Coord)&#39;, &#39;Bx Tip X (US Coord)&#39;,
       &#39;Bx Tip Y (US Coord)&#39;, &#39;Bx Tip Z (US Coord)&#39;, &#39;Bx Base X (US Coord)&#39;,
       &#39;Bx Base Y (US Coord)&#39;, &#39;Bx Base Z (US Coord)&#39;, &#39;Prostate Volume (CC)&#39;,
       &#39;Core Label&#39;, &#39;Series Instance UID (US)&#39;, &#39;Series Instance UID (MRI)&#39;,
       &#39;Patient Number&#39;],
      dtype=&#39;object&#39;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="18"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:09.720655Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:09.719682Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:09.911835Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:09.910724Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:09.720603Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>excel_dataset_2 <span class="op">=</span> <span class="st">&quot;/kaggle/input/prostate-mri-us-biopsy/Target Data_2019-12-05.xlsx&quot;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> pd.read_excel(excel_dataset_2)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="19"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:09.913390Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:09.913059Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:09.921386Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:09.920334Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:09.913357Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df4.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>   UCLA Score (Similar to PIRADS v2)  ROI Volume (cc)  Target No.  \
0                                  3         0.834323           1   
1                                  3         0.834323           1   
2                                  1         0.364729           1   
3                                  3         0.364729           1   
4                                  3         0.884436           1   

                                seriesInstanceUID_US  \
0  1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
1  1.3.6.1.4.1.14519.5.2.1.1202285930413120999892...   
2  1.3.6.1.4.1.14519.5.2.1.9782151183163602689533...   
3  1.3.6.1.4.1.14519.5.2.1.2007760325377179554571...   
4  1.3.6.1.4.1.14519.5.2.1.9358385420720256123337...   

                                seriesInstanceUID_MR  \
0  1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   
1  1.3.6.1.4.1.14519.5.2.1.2667179699843439819630...   
2  1.3.6.1.4.1.14519.5.2.1.1867491288236660505887...   
3  1.3.6.1.4.1.14519.5.2.1.1867491288236660505887...   
4  1.3.6.1.4.1.14519.5.2.1.1345819869189093607538...   

                    Patient ID  
0  Prostate-MRI-US-Biopsy-0001  
1  Prostate-MRI-US-Biopsy-0001  
2  Prostate-MRI-US-Biopsy-0002  
3  Prostate-MRI-US-Biopsy-0002  
4  Prostate-MRI-US-Biopsy-0003  
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="20"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:09.923307Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:09.922952Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:09.940995Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:09.939890Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:09.923272Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Number of Rows:&quot;</span>,<span class="bu">len</span>(df2[<span class="st">&quot;Number of Images&quot;</span>]))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of Rows: 2779
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="21"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:09.942580Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:09.942258Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:09.956369Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:09.955206Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:09.942548Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> rowdata <span class="kw">in</span> df2[<span class="st">&#39;Number of Images&#39;</span>]:</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    total<span class="op">+=</span>rowdata</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Average number of MRI scans each patient underwent are:&quot;</span>,total<span class="op">/</span><span class="dv">2779</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Average number of MRI scans each patient underwent are: 21.99316300827636
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="22"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:09.958188Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:09.957775Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:09.975129Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:09.973930Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:09.958152Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#methodologies used and ranking</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>methods_unique2 <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> method <span class="kw">in</span> df2[<span class="st">&#39;Series Description&#39;</span>]:</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    methods_unique2.add(method)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="23"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:09.976894Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:09.976478Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:09.989529Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:09.988154Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:09.976855Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Protocols used:&quot;</span>,methods_unique2)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Protocols used: {&#39;T2 SPACE 3D AXIAL&#39;, &#39;T2 AX&#39;, &#39;AX OB T2WTSE&#39;, &#39;Ax Cube T2-100ETL2Rx&#39;, &#39;SCAx T2 FSE&#39;, &#39;AX T2tseSMFOV&#39;, &#39;t2tsetra obl 3mm&#39;, &#39;AX T2 NO ANGLE&#39;, nan, &#39;Ax T2 HR  FRFSE&#39;, &#39;T2 Ax SPACE Prostate PlaneTop of Bladder-Thru Prostate&#39;, &#39;t2tsecor&#39;, &#39;T2 AX TSE SMALL FOV&#39;, &#39;AX T2 PROPELLER&#39;, &#39;t2spcrstaxial oblProstate rpt&#39;, &#39;Axial T2&#39;, &#39;t2spctrap2rstaxial oblProstate&#39;, &#39;t2tsetra&#39;, &#39;t2tsetraprostate&#39;, &#39;t2spcrstaxial oblProstate&#39;, &#39;t2tsetra320p2&#39;, &#39;T2 Ax&#39;, &#39;Ax T2&#39;, &#39;t2spcrstax oblp2&#39;, &#39;AX FSE T2 SMALL&#39;, &#39;Ax T2 FRFSE PROP&#39;, &#39;AX T2 FSE&#39;, &#39;t2spcrstaxialProstate rpt&#39;, &#39;AX T2 FSE 3mm&#39;, &#39;AX OBL T2 BLADE SMFOV&#39;, &#39;t2spcrstaxial oblRPT&#39;, &#39;t2spcrstaxial oblp2&#39;, &#39;t2spcrstaxial Prostate&#39;, &#39;t2spcrstaxp2&#39;, &#39;AX T2&#39;, &#39;AXT2&#39;, &#39;T2WTSE AX HI&#39;, &#39;Ax T2 PROPELLER&#39;, &#39;reprat t2spcrstaxial oblProstate&#39;, &#39;t2spctrap2rstaxialProstate&#39;, &#39;t2spcrstaxialp2&#39;, &#39;t2spcrstaxialProstate&#39;, &#39;AX T2 TSE&#39;, &#39;AX T2 SM FOV&#39;}
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="24"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:09.991379Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:09.991009Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:10.003282Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:10.002004Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:09.991343Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Number of unique protocols used:&quot;</span>,<span class="bu">len</span>(methods_unique2))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of unique protocols used: 44
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="25"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:10.005012Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:10.004630Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:10.036347Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:10.035167Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:10.004975Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#find out the most used technique for mri</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>max_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>method_max <span class="op">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ele <span class="kw">in</span> methods_unique2:</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> method <span class="kw">in</span> df2[<span class="st">&#39;Series Description&#39;</span>]:</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(ele <span class="op">==</span> method):</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>            count<span class="op">+=</span><span class="dv">1</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> count<span class="op">&gt;=</span>max_count:</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        max_count <span class="op">=</span> count</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        method_max <span class="op">=</span> ele</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(method_max)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(max_count)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The most used method is:&quot;</span>,method_max)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>T2 SPACE 3D AXIAL
1
T2 AX
2
AX OB T2WTSE
2
SCAx T2 FSE
2
t2tsetra obl 3mm
2
Ax T2 HR  FRFSE
2
t2tsecor
2
AX T2 PROPELLER
2
Axial T2
2
t2spctrap2rstaxial oblProstate
5
t2spcrstaxial oblProstate
820
The most used method is: t2spcrstaxial oblProstate
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="26"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:10.038282Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:10.037932Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:10.250740Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:10.249521Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:10.038247Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>path_to_stl <span class="op">=</span> <span class="st">&quot;/kaggle/input/prostate-mri-us-biopsy/STLs/STLs/&quot;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>counter_stl <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> stlfile <span class="kw">in</span> os.listdir(path_to_stl):</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    counter_stl<span class="op">+=</span><span class="dv">1</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Number of stl ultrasound files are:&quot;</span>,counter_stl)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Number of stl ultrasound files are: 5717
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="27"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:10.253045Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:10.252554Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.192021Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.190866Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:10.252995Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Path to the MRI biopsy directory</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>path_to_mri_biopsy <span class="op">=</span> <span class="st">&#39;/kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/&#39;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>limit <span class="op">=</span> <span class="dv">25</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>counter_limit <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through each directory in the main directory</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> directory <span class="kw">in</span> os.listdir(path_to_mri_biopsy):</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    directory_path <span class="op">=</span> os.path.join(path_to_mri_biopsy, directory)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if it&#39;s a directory</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> os.path.isdir(directory_path) <span class="kw">and</span> counter_limit <span class="op">&lt;</span> limit:</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use os.walk to traverse subdirectories</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> dirpath, dirnames, filenames <span class="kw">in</span> os.walk(directory_path):</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Find the first DICOM file</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> filename <span class="kw">in</span> filenames:</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Construct the full path to the DICOM file</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> filename.lower().endswith(<span class="st">&#39;.dcm&#39;</span>):  <span class="co"># Check for DICOM files</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>                    file_path <span class="op">=</span> os.path.join(dirpath, filename)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;Reading DICOM file: </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>                    ds <span class="op">=</span> pydicom.dcmread(file_path)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Access pixel data</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">&#39;PixelData&#39;</span> <span class="kw">in</span> ds:</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>                        pixel_array <span class="op">=</span> ds.pixel_array</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Check the shape of the pixel array</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> pixel_array.ndim <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># If it&#39;s 3D, display the middle slice</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>                            mid_slice <span class="op">=</span> pixel_array[pixel_array.shape[<span class="dv">0</span>] <span class="op">//</span> <span class="dv">2</span>, :, :]</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>                            plt.imshow(mid_slice, cmap<span class="op">=</span><span class="st">&#39;gray&#39;</span>)</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">elif</span> pixel_array.ndim <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># If it&#39;s 2D, display it directly</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>                            plt.imshow(pixel_array, cmap<span class="op">=</span><span class="st">&#39;gray&#39;</span>)</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">else</span>:</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>                            <span class="bu">print</span>(<span class="st">&quot;Unexpected number of dimensions in pixel data.&quot;</span>)</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>                        plt.title(<span class="ss">f&#39;DICOM Image from </span><span class="sc">{</span>directory<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>                        plt.axis(<span class="st">&#39;off&#39;</span>)  <span class="co"># Hide axes</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>                        plt.show()</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>                        counter_limit <span class="op">+=</span> <span class="dv">1</span>  <span class="co"># Increment the counter</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span>  <span class="co"># Break after showing the first DICOM image for this directory</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> counter_limit <span class="op">&gt;=</span> limit:  <span class="co"># Check if limit is reached</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span>  <span class="co"># Exit the loop if limit is reached</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> counter_limit <span class="op">&gt;=</span> limit:  <span class="co"># Check if limit is reached</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span>  <span class="co"># Exit the outer loop if limit is reached</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0666/10-28-2006-NA-3D Rendering-30633/96.000000-NA-55449/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/f27d20d864f7494ee1cf6b454a7c12caddab890b.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0666/08-21-2006-NA-MRI PROSTATE W ENDORECTAL COIL-20604/10.000000-t2spcrstaxial oblProstate-72151/1-26.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/de36d1e5a408db96c86bafe5cf2ffe0c9a0714d3.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0581/11-14-2005-NA-MRI PROSTATE W WO CONTRAST-12625/7.000000-t2spcrstaxial oblProstate-82455/1-26.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/cbeab7d0f6dab89e49c8c9236e19377376ba7e85.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0581/02-20-2006-NA-3D Rendering-08958/2.000000-NA-35188/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/faf1c6781a8c6977d00b685f578ddfc2009ad7fb.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0625/12-11-2005-NA-MRI PROSTATE W WO CONTRAST-38442/5.000000-t2spcrstaxial oblProstate-25421/1-26.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/095b181bf604ffab4d30220e2c4150b3055982f3.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0625/02-26-2006-NA-3D Rendering-44640/73.000000-NA-18237/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/9f0010528a5a4aa2b7a3e730ccfc9f8d924655ce.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0406/05-03-2009-NA-MRI PROSTATE W WO CONTRAST-76439/13.000000-t2spcrstaxial oblProstate-40290/1-26.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/2a2bbce4b312ef6df55868a5695e8dbbbf11db98.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0406/05-09-2009-NA-NA-35978/377.000000-NA-96241/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/31491ce42e4fce97bb6e1a7d7287a3ea640b9e46.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0644/03-04-2006-NA-3D Rendering-35069/76.000000-NA-02249/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/783e1640bf4d72ab7ff9eba9e5379b7facad6680.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0495/01-09-2010-NA-3D Rendering-35643/99.000000-NA-05432/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/1ae28c41ac849f354ac572abbf00036786e1b9f2.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0495/01-07-2010-NA-MRI PROSTATE W WO CONTRAST-96894/13001.000000-t2spcrstaxial oblProstate-19466/1-26.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/8a4723d6eec23afa7da29ae3d5d67541ea79824f.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-1072/03-15-2010-NA-MR PELVIS OUTSIDE IMAGING-89950/6.000000-AX OBL T2 BLADE SMFOV-55121/1-26.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/b975735f5cdfc2f991b2e71808a6ea1d1300f255.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-1072/05-07-2010-NA-NA-14427/53.000000-NA-59118/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/4f1f2d60ababde54fb4a065daec1bce36c210d17.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0650/02-19-2006-NA-3D Rendering-97076/4.000000-NA-01021/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/1b2c2eece2f3f1669f414dc7dece62b34d46a8be.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0650/02-17-2006-NA-MRI PROSTATE W WO CONTRAST-91235/2.000000-t2spcrstaxialp2-33355/1-26.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/1c0c2d2fa21dac3f417aa3a1ab49201c973a757a.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0313/11-13-2009-NA-3D Rendering-47425/36.000000-NA-06941/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/beb2aff4cb232b4565a694f0d91a03918ffc7c78.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0107/03-12-2006-NA-3D Rendering-37591/78.000000-NA-31670/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/bfcebec38fd9fef1b9c51ee16bebf75276c9ec8a.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0497/05-23-2008-NA-3D Rendering-70196/256.000000-NA-16940/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/4720c818f3c31a1f461065022d594f87a265af8c.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0497/05-18-2009-NA-3D Rendering-10434/152.000000-NA-29515/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/9dcce847efb41b44a17875693b4c1a30306603f3.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0467/06-06-2008-NA-3D Rendering-86772/225.000000-NA-45851/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/7b3c0d2f48d7bd72e9097f824f9434fe24d34381.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0467/05-14-2008-NA-MRI PROSTATE W WO CONTRAST-68503/9.000000-t2spcrstaxial oblProstate-78083/1-26.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/c007bf6c96ca1af854a623f6d461d074d17ea23f.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0188/02-16-2010-NA-MRI PROSTATE W WO CONTRAST-80612/8.000000-t2spcrstaxial oblProstate-58161/1-26.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/0a5fc3b8a398abe5f0b89650d11acabdb469954b.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0188/02-27-2010-NA-3D Rendering-93127/195.000000-NA-88971/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/36ff08b4e457354b00fdbf3d072dbd6ec492fb56.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0858/08-09-2008-NA-3D Rendering-09179/3.000000-NA-45519/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/888d1efb2691f573ddfdee5c3e2d6d19e5873435.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Reading DICOM file: /kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy/Prostate-MRI-US-Biopsy-0858/07-26-2009-NA-3D Rendering-61772/107.000000-NA-64364/1-1.dcm
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/3ce59bd1428163d5a5b5306465988a28b7ca37e3.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="90"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:08:12.377949Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:08:12.377500Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:08:12.424354Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:08:12.423083Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:08:12.377907Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge DataFrames on different column names</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>combined_df <span class="op">=</span> pd.merge(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    df3, df4,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    left_on<span class="op">=</span>[<span class="st">&#39;Patient Number&#39;</span>, <span class="st">&#39;Series Instance UID (US)&#39;</span>, <span class="st">&#39;Series Instance UID (MRI)&#39;</span>],</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    right_on<span class="op">=</span>[<span class="st">&#39;Patient ID&#39;</span>, <span class="st">&#39;seriesInstanceUID_US&#39;</span>, <span class="st">&#39;seriesInstanceUID_MR&#39;</span>],</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">&#39;inner&#39;</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop unnecessary columns after merging</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>combined_df.drop([<span class="st">&#39;Patient Number&#39;</span> ,</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;Series Instance UID (US)&#39;</span>, <span class="st">&#39;seriesInstanceUID_US&#39;</span>, </span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&#39;Series Instance UID (MRI)&#39;</span>, <span class="st">&#39;seriesInstanceUID_MR&#39;</span>], </span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                 axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>, errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined DataFrame</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_df)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>       PSA (ng/mL)  Primary Gleason  Secondary Gleason  Cancer Length (mm)  \
0             10.9              NaN                NaN                 NaN   
1             10.9              3.0                4.0                 4.0   
2             10.9              3.0                3.0                 2.0   
3             10.9              NaN                NaN                 NaN   
4             10.9              NaN                NaN                 NaN   
...            ...              ...                ...                 ...   
23492          7.1              3.0                4.0                 7.0   
23493          7.1              NaN                NaN                 NaN   
23494          7.1              NaN                NaN                 NaN   
23495          7.1              NaN                NaN                 NaN   
23496          7.1              NaN                NaN                 NaN   

       % Cancer in Core  Core Fragment #1 Tissue Length (mm)  \
0                   NaN                                 10.0   
1                  50.0                                 14.0   
2                  10.0                                 10.0   
3                   NaN                                 12.0   
4                   NaN                                 14.0   
...                 ...                                  ...   
23492              50.0                                 16.0   
23493               NaN                                 21.0   
23494               NaN                                 21.0   
23495               NaN                                 16.0   
23496               NaN                                 16.0   

       Core Fragment #2 Tissue Length (mm)  \
0                                      3.0   
1                                      NaN   
2                                      2.0   
3                                      4.0   
4                                      NaN   
...                                    ...   
23492                                  NaN   
23493                                  NaN   
23494                                  NaN   
23495                                  NaN   
23496                                  NaN   

       Core Fragment #3 Tissue Length (mm)  Bx Tip X (MRI Coord)  \
0                                      NaN                -8.915   
1                                      NaN                -5.644   
2                                      1.0                -9.642   
3                                      NaN               -11.095   
4                                      NaN               -18.001   
...                                    ...                   ...   
23492                                  NaN                -5.017   
23493                                  NaN                -2.178   
23494                                  NaN                -2.178   
23495                                  NaN                -6.153   
23496                                  NaN                -6.153   

       Bx Tip Y (MRI Coord)  ...  Bx Tip Z (US Coord)  Bx Base X (US Coord)  \
0                    34.791  ...                9.888                14.970   
1                    23.161  ...                1.831                19.342   
2                    22.070  ...               -5.368                16.782   
3                    30.429  ...               17.006                10.307   
4                    25.705  ...               -2.421                11.157   
...                     ...  ...                  ...                   ...   
23492                39.688  ...                9.956               -11.523   
23493                32.305  ...                5.444                -8.507   
23494                32.305  ...                5.444                -8.507   
23495                34.293  ...                0.521               -11.916   
23496                34.293  ...                0.521               -11.916   

       Bx Base Y (US Coord)  Bx Base Z (US Coord)  Prostate Volume (CC)  \
0                    30.545                 8.399             49.141950   
1                    23.864                 2.066             49.141950   
2                    27.651                -2.674             49.141950   
3                    15.876                15.351             49.141950   
4                    26.813                -1.681             49.141950   
...                     ...                   ...                   ...   
23492                 3.662                 8.061             37.386039   
23493                 2.287                 5.103             37.386039   
23494                 2.287                 5.103             37.386039   
23495                 5.198                 0.344             37.386039   
23496                 5.198                 0.344             37.386039   

                     Core Label  UCLA Score (Similar to PIRADS v2)  \
0             LEFT LATERAL BASE                                  3   
1              LEFT LATERAL MID                                  3   
2             LEFT LATERAL APEX                                  3   
3                     LEFT BASE                                  3   
4                      LEFT MID                                  3   
...                         ...                                ...   
23492  TARGET OR PRIOR POSITIVE                                  4   
23493  TARGET OR PRIOR POSITIVE                                  0   
23494  TARGET OR PRIOR POSITIVE                                  4   
23495  TARGET OR PRIOR POSITIVE                                  0   
23496  TARGET OR PRIOR POSITIVE                                  4   

       ROI Volume (cc)  Target No.                   Patient ID  
0             0.834323           1  Prostate-MRI-US-Biopsy-0001  
1             0.834323           1  Prostate-MRI-US-Biopsy-0001  
2             0.834323           1  Prostate-MRI-US-Biopsy-0001  
3             0.834323           1  Prostate-MRI-US-Biopsy-0001  
4             0.834323           1  Prostate-MRI-US-Biopsy-0001  
...                ...         ...                          ...  
23492         0.118855           2  Prostate-MRI-US-Biopsy-1151  
23493         0.000101           1  Prostate-MRI-US-Biopsy-1151  
23494         0.118855           2  Prostate-MRI-US-Biopsy-1151  
23495         0.000101           1  Prostate-MRI-US-Biopsy-1151  
23496         0.118855           2  Prostate-MRI-US-Biopsy-1151  

[23497 rows x 26 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="29"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.246182Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.245785Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.251987Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.250745Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.246147Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_df.columns)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Index([&#39;PSA (ng/mL)&#39;, &#39;Primary Gleason&#39;, &#39;Secondary Gleason&#39;,
       &#39;Cancer Length (mm)&#39;, &#39;% Cancer in Core&#39;,
       &#39;Core Fragment #1 Tissue Length (mm)&#39;,
       &#39;Core Fragment #2 Tissue Length (mm)&#39;,
       &#39;Core Fragment #3 Tissue Length (mm)&#39;, &#39;Bx Tip X (MRI Coord)&#39;,
       &#39;Bx Tip Y (MRI Coord)&#39;, &#39;Bx Tip Z (MRI Coord)&#39;, &#39;Bx Base X (MRI Coord)&#39;,
       &#39;Bx Base Y (MRI Coord)&#39;, &#39;Bx Base Z (MRI Coord)&#39;, &#39;Bx Tip X (US Coord)&#39;,
       &#39;Bx Tip Y (US Coord)&#39;, &#39;Bx Tip Z (US Coord)&#39;, &#39;Bx Base X (US Coord)&#39;,
       &#39;Bx Base Y (US Coord)&#39;, &#39;Bx Base Z (US Coord)&#39;, &#39;Prostate Volume (CC)&#39;,
       &#39;Core Label&#39;, &#39;UCLA Score (Similar to PIRADS v2)&#39;, &#39;ROI Volume (cc)&#39;,
       &#39;Target No.&#39;],
      dtype=&#39;object&#39;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="30"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.254101Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.253498Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.280992Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.279584Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.254032Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_df.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>   PSA (ng/mL)  Primary Gleason  Secondary Gleason  Cancer Length (mm)  \
0         10.9              NaN                NaN                 NaN   
1         10.9              3.0                4.0                 4.0   
2         10.9              3.0                3.0                 2.0   
3         10.9              NaN                NaN                 NaN   
4         10.9              NaN                NaN                 NaN   

   % Cancer in Core  Core Fragment #1 Tissue Length (mm)  \
0               NaN                                 10.0   
1              50.0                                 14.0   
2              10.0                                 10.0   
3               NaN                                 12.0   
4               NaN                                 14.0   

   Core Fragment #2 Tissue Length (mm)  Core Fragment #3 Tissue Length (mm)  \
0                                  3.0                                  NaN   
1                                  NaN                                  NaN   
2                                  2.0                                  1.0   
3                                  4.0                                  NaN   
4                                  NaN                                  NaN   

   Bx Tip X (MRI Coord)  Bx Tip Y (MRI Coord)  ...  Bx Tip Y (US Coord)  \
0                -8.915                34.791  ...               12.970   
1                -5.644                23.161  ...                6.628   
2                -9.642                22.070  ...               10.436   
3               -11.095                30.429  ...               -0.950   
4               -18.001                25.705  ...                8.100   

   Bx Tip Z (US Coord)  Bx Base X (US Coord)  Bx Base Y (US Coord)  \
0                9.888                14.970                30.545   
1                1.831                19.342                23.864   
2               -5.368                16.782                27.651   
3               17.006                10.307                15.876   
4               -2.421                11.157                26.813   

   Bx Base Z (US Coord)  Prostate Volume (CC)         Core Label  \
0                 8.399              49.14195  LEFT LATERAL BASE   
1                 2.066              49.14195   LEFT LATERAL MID   
2                -2.674              49.14195  LEFT LATERAL APEX   
3                15.351              49.14195          LEFT BASE   
4                -1.681              49.14195           LEFT MID   

   UCLA Score (Similar to PIRADS v2)  ROI Volume (cc)  Target No.  
0                                  3         0.834323           1  
1                                  3         0.834323           1  
2                                  3         0.834323           1  
3                                  3         0.834323           1  
4                                  3         0.834323           1  

[5 rows x 25 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="31"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.283187Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.282553Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.289452Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.288320Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.283132Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df3.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(24783, 25)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="32"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.291409Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.290953Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.308975Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.307475Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.291358Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df4.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(1621, 6)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="33"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.310840Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.310378Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.320457Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.319271Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.310788Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_df.columns.tolist())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;PSA (ng/mL)&#39;, &#39;Primary Gleason&#39;, &#39;Secondary Gleason&#39;, &#39;Cancer Length (mm)&#39;, &#39;% Cancer in Core&#39;, &#39;Core Fragment #1 Tissue Length (mm)&#39;, &#39;Core Fragment #2 Tissue Length (mm)&#39;, &#39;Core Fragment #3 Tissue Length (mm)&#39;, &#39;Bx Tip X (MRI Coord)&#39;, &#39;Bx Tip Y (MRI Coord)&#39;, &#39;Bx Tip Z (MRI Coord)&#39;, &#39;Bx Base X (MRI Coord)&#39;, &#39;Bx Base Y (MRI Coord)&#39;, &#39;Bx Base Z (MRI Coord)&#39;, &#39;Bx Tip X (US Coord)&#39;, &#39;Bx Tip Y (US Coord)&#39;, &#39;Bx Tip Z (US Coord)&#39;, &#39;Bx Base X (US Coord)&#39;, &#39;Bx Base Y (US Coord)&#39;, &#39;Bx Base Z (US Coord)&#39;, &#39;Prostate Volume (CC)&#39;, &#39;Core Label&#39;, &#39;UCLA Score (Similar to PIRADS v2)&#39;, &#39;ROI Volume (cc)&#39;, &#39;Target No.&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="34"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.322233Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.321893Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.336053Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.334793Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.322199Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb83"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>combined_df.columns <span class="op">=</span> combined_df.columns.<span class="bu">str</span>.strip()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="35"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.337628Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.337319Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.353582Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.352325Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.337597Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb84"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_df.columns.tolist())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;PSA (ng/mL)&#39;, &#39;Primary Gleason&#39;, &#39;Secondary Gleason&#39;, &#39;Cancer Length (mm)&#39;, &#39;% Cancer in Core&#39;, &#39;Core Fragment #1 Tissue Length (mm)&#39;, &#39;Core Fragment #2 Tissue Length (mm)&#39;, &#39;Core Fragment #3 Tissue Length (mm)&#39;, &#39;Bx Tip X (MRI Coord)&#39;, &#39;Bx Tip Y (MRI Coord)&#39;, &#39;Bx Tip Z (MRI Coord)&#39;, &#39;Bx Base X (MRI Coord)&#39;, &#39;Bx Base Y (MRI Coord)&#39;, &#39;Bx Base Z (MRI Coord)&#39;, &#39;Bx Tip X (US Coord)&#39;, &#39;Bx Tip Y (US Coord)&#39;, &#39;Bx Tip Z (US Coord)&#39;, &#39;Bx Base X (US Coord)&#39;, &#39;Bx Base Y (US Coord)&#39;, &#39;Bx Base Z (US Coord)&#39;, &#39;Prostate Volume (CC)&#39;, &#39;Core Label&#39;, &#39;UCLA Score (Similar to PIRADS v2)&#39;, &#39;ROI Volume (cc)&#39;, &#39;Target No.&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="36"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.355300Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.354956Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.392204Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.391105Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.355265Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb86"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#label encode the columns that are categorical </span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>encoder <span class="op">=</span> LabelEncoder()</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>combined_df[<span class="st">&#39;Core Label Encoded&#39;</span>] <span class="op">=</span> encoder.fit_transform(combined_df[<span class="st">&#39;Core Label&#39;</span>])</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>combined_df.drop(<span class="st">&#39;Core Label&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_df)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>       PSA (ng/mL)  Primary Gleason  Secondary Gleason  Cancer Length (mm)  \
0             10.9              NaN                NaN                 NaN   
1             10.9              3.0                4.0                 4.0   
2             10.9              3.0                3.0                 2.0   
3             10.9              NaN                NaN                 NaN   
4             10.9              NaN                NaN                 NaN   
...            ...              ...                ...                 ...   
23492          7.1              3.0                4.0                 7.0   
23493          7.1              NaN                NaN                 NaN   
23494          7.1              NaN                NaN                 NaN   
23495          7.1              NaN                NaN                 NaN   
23496          7.1              NaN                NaN                 NaN   

       % Cancer in Core  Core Fragment #1 Tissue Length (mm)  \
0                   NaN                                 10.0   
1                  50.0                                 14.0   
2                  10.0                                 10.0   
3                   NaN                                 12.0   
4                   NaN                                 14.0   
...                 ...                                  ...   
23492              50.0                                 16.0   
23493               NaN                                 21.0   
23494               NaN                                 21.0   
23495               NaN                                 16.0   
23496               NaN                                 16.0   

       Core Fragment #2 Tissue Length (mm)  \
0                                      3.0   
1                                      NaN   
2                                      2.0   
3                                      4.0   
4                                      NaN   
...                                    ...   
23492                                  NaN   
23493                                  NaN   
23494                                  NaN   
23495                                  NaN   
23496                                  NaN   

       Core Fragment #3 Tissue Length (mm)  Bx Tip X (MRI Coord)  \
0                                      NaN                -8.915   
1                                      NaN                -5.644   
2                                      1.0                -9.642   
3                                      NaN               -11.095   
4                                      NaN               -18.001   
...                                    ...                   ...   
23492                                  NaN                -5.017   
23493                                  NaN                -2.178   
23494                                  NaN                -2.178   
23495                                  NaN                -6.153   
23496                                  NaN                -6.153   

       Bx Tip Y (MRI Coord)  ...  Bx Tip Y (US Coord)  Bx Tip Z (US Coord)  \
0                    34.791  ...               12.970                9.888   
1                    23.161  ...                6.628                1.831   
2                    22.070  ...               10.436               -5.368   
3                    30.429  ...               -0.950               17.006   
4                    25.705  ...                8.100               -2.421   
...                     ...  ...                  ...                  ...   
23492                39.688  ...              -15.243                9.956   
23493                32.305  ...              -16.421                5.444   
23494                32.305  ...              -16.421                5.444   
23495                34.293  ...              -13.739                0.521   
23496                34.293  ...              -13.739                0.521   

       Bx Base X (US Coord)  Bx Base Y (US Coord)  Bx Base Z (US Coord)  \
0                    14.970                30.545                 8.399   
1                    19.342                23.864                 2.066   
2                    16.782                27.651                -2.674   
3                    10.307                15.876                15.351   
4                    11.157                26.813                -1.681   
...                     ...                   ...                   ...   
23492               -11.523                 3.662                 8.061   
23493                -8.507                 2.287                 5.103   
23494                -8.507                 2.287                 5.103   
23495               -11.916                 5.198                 0.344   
23496               -11.916                 5.198                 0.344   

       Prostate Volume (CC)  UCLA Score (Similar to PIRADS v2)  \
0                 49.141950                                  3   
1                 49.141950                                  3   
2                 49.141950                                  3   
3                 49.141950                                  3   
4                 49.141950                                  3   
...                     ...                                ...   
23492             37.386039                                  4   
23493             37.386039                                  0   
23494             37.386039                                  4   
23495             37.386039                                  0   
23496             37.386039                                  4   

       ROI Volume (cc)  Target No.  Core Label Encoded  
0             0.834323           1                   4  
1             0.834323           1                   5  
2             0.834323           1                   3  
3             0.834323           1                   2  
4             0.834323           1                   6  
...                ...         ...                 ...  
23492         0.118855           2                  13  
23493         0.000101           1                  13  
23494         0.118855           2                  13  
23495         0.000101           1                  13  
23496         0.118855           2                  13  

[23497 rows x 25 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="37"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.393827Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.393477Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.404343Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.403193Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.393791Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb88"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>columns_to_fill <span class="op">=</span> [<span class="st">&#39;Secondary Gleason&#39;</span>,<span class="st">&#39;Cancer Length (mm)&#39;</span>,<span class="st">&#39;% Cancer in Core&#39;</span>, <span class="st">&#39;Core Fragment #1 Tissue Length (mm)&#39;</span>, <span class="st">&#39;Core Fragment #2 Tissue Length (mm)&#39;</span> , <span class="st">&#39;Core Fragment #3 Tissue Length (mm)&#39;</span>]</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> columns_to_fill:</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    combined_df[column] <span class="op">=</span> combined_df[column].fillna(<span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="38"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.406229Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.405772Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.440249Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.438811Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.406177Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb89"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>combined_df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="38">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PSA (ng/mL)</th>
      <th>Primary Gleason</th>
      <th>Secondary Gleason</th>
      <th>Cancer Length (mm)</th>
      <th>% Cancer in Core</th>
      <th>Core Fragment #1 Tissue Length (mm)</th>
      <th>Core Fragment #2 Tissue Length (mm)</th>
      <th>Core Fragment #3 Tissue Length (mm)</th>
      <th>Bx Tip X (MRI Coord)</th>
      <th>Bx Tip Y (MRI Coord)</th>
      <th>...</th>
      <th>Bx Tip Y (US Coord)</th>
      <th>Bx Tip Z (US Coord)</th>
      <th>Bx Base X (US Coord)</th>
      <th>Bx Base Y (US Coord)</th>
      <th>Bx Base Z (US Coord)</th>
      <th>Prostate Volume (CC)</th>
      <th>UCLA Score (Similar to PIRADS v2)</th>
      <th>ROI Volume (cc)</th>
      <th>Target No.</th>
      <th>Core Label Encoded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10.9</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>-8.915</td>
      <td>34.791</td>
      <td>...</td>
      <td>12.970</td>
      <td>9.888</td>
      <td>14.970</td>
      <td>30.545</td>
      <td>8.399</td>
      <td>49.14195</td>
      <td>3</td>
      <td>0.834323</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.9</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>50.0</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-5.644</td>
      <td>23.161</td>
      <td>...</td>
      <td>6.628</td>
      <td>1.831</td>
      <td>19.342</td>
      <td>23.864</td>
      <td>2.066</td>
      <td>49.14195</td>
      <td>3</td>
      <td>0.834323</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10.9</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>-9.642</td>
      <td>22.070</td>
      <td>...</td>
      <td>10.436</td>
      <td>-5.368</td>
      <td>16.782</td>
      <td>27.651</td>
      <td>-2.674</td>
      <td>49.14195</td>
      <td>3</td>
      <td>0.834323</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.9</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>-11.095</td>
      <td>30.429</td>
      <td>...</td>
      <td>-0.950</td>
      <td>17.006</td>
      <td>10.307</td>
      <td>15.876</td>
      <td>15.351</td>
      <td>49.14195</td>
      <td>3</td>
      <td>0.834323</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10.9</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-18.001</td>
      <td>25.705</td>
      <td>...</td>
      <td>8.100</td>
      <td>-2.421</td>
      <td>11.157</td>
      <td>26.813</td>
      <td>-1.681</td>
      <td>49.14195</td>
      <td>3</td>
      <td>0.834323</td>
      <td>1</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="39"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.441862Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.441493Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.450800Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.449628Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.441823Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb90"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>combined_df[<span class="st">&#39;Primary Gleason&#39;</span>].fillna(combined_df[<span class="st">&#39;Primary Gleason&#39;</span>].mode()[<span class="dv">0</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipykernel_30/3130674572.py:1: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  combined_df[&#39;Primary Gleason&#39;].fillna(combined_df[&#39;Primary Gleason&#39;].mode()[0], inplace=True)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="40"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.452569Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.452220Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:21.483586Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:21.482384Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.452535Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb92"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_df)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>       PSA (ng/mL)  Primary Gleason  Secondary Gleason  Cancer Length (mm)  \
0             10.9              3.0                0.0                 0.0   
1             10.9              3.0                4.0                 4.0   
2             10.9              3.0                3.0                 2.0   
3             10.9              3.0                0.0                 0.0   
4             10.9              3.0                0.0                 0.0   
...            ...              ...                ...                 ...   
23492          7.1              3.0                4.0                 7.0   
23493          7.1              3.0                0.0                 0.0   
23494          7.1              3.0                0.0                 0.0   
23495          7.1              3.0                0.0                 0.0   
23496          7.1              3.0                0.0                 0.0   

       % Cancer in Core  Core Fragment #1 Tissue Length (mm)  \
0                   0.0                                 10.0   
1                  50.0                                 14.0   
2                  10.0                                 10.0   
3                   0.0                                 12.0   
4                   0.0                                 14.0   
...                 ...                                  ...   
23492              50.0                                 16.0   
23493               0.0                                 21.0   
23494               0.0                                 21.0   
23495               0.0                                 16.0   
23496               0.0                                 16.0   

       Core Fragment #2 Tissue Length (mm)  \
0                                      3.0   
1                                      0.0   
2                                      2.0   
3                                      4.0   
4                                      0.0   
...                                    ...   
23492                                  0.0   
23493                                  0.0   
23494                                  0.0   
23495                                  0.0   
23496                                  0.0   

       Core Fragment #3 Tissue Length (mm)  Bx Tip X (MRI Coord)  \
0                                      0.0                -8.915   
1                                      0.0                -5.644   
2                                      1.0                -9.642   
3                                      0.0               -11.095   
4                                      0.0               -18.001   
...                                    ...                   ...   
23492                                  0.0                -5.017   
23493                                  0.0                -2.178   
23494                                  0.0                -2.178   
23495                                  0.0                -6.153   
23496                                  0.0                -6.153   

       Bx Tip Y (MRI Coord)  ...  Bx Tip Y (US Coord)  Bx Tip Z (US Coord)  \
0                    34.791  ...               12.970                9.888   
1                    23.161  ...                6.628                1.831   
2                    22.070  ...               10.436               -5.368   
3                    30.429  ...               -0.950               17.006   
4                    25.705  ...                8.100               -2.421   
...                     ...  ...                  ...                  ...   
23492                39.688  ...              -15.243                9.956   
23493                32.305  ...              -16.421                5.444   
23494                32.305  ...              -16.421                5.444   
23495                34.293  ...              -13.739                0.521   
23496                34.293  ...              -13.739                0.521   

       Bx Base X (US Coord)  Bx Base Y (US Coord)  Bx Base Z (US Coord)  \
0                    14.970                30.545                 8.399   
1                    19.342                23.864                 2.066   
2                    16.782                27.651                -2.674   
3                    10.307                15.876                15.351   
4                    11.157                26.813                -1.681   
...                     ...                   ...                   ...   
23492               -11.523                 3.662                 8.061   
23493                -8.507                 2.287                 5.103   
23494                -8.507                 2.287                 5.103   
23495               -11.916                 5.198                 0.344   
23496               -11.916                 5.198                 0.344   

       Prostate Volume (CC)  UCLA Score (Similar to PIRADS v2)  \
0                 49.141950                                  3   
1                 49.141950                                  3   
2                 49.141950                                  3   
3                 49.141950                                  3   
4                 49.141950                                  3   
...                     ...                                ...   
23492             37.386039                                  4   
23493             37.386039                                  0   
23494             37.386039                                  4   
23495             37.386039                                  0   
23496             37.386039                                  4   

       ROI Volume (cc)  Target No.  Core Label Encoded  
0             0.834323           1                   4  
1             0.834323           1                   5  
2             0.834323           1                   3  
3             0.834323           1                   2  
4             0.834323           1                   6  
...                ...         ...                 ...  
23492         0.118855           2                  13  
23493         0.000101           1                  13  
23494         0.118855           2                  13  
23495         0.000101           1                  13  
23496         0.118855           2                  13  

[23497 rows x 25 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="41"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:21.490866Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:21.490466Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:22.393890Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:22.392848Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:21.490827Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb94"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the correlation matrix</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> combined_df.corr()</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select correlations with UCLA Score</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>ucla_corr <span class="op">=</span> corr[[<span class="st">&#39;UCLA Score (Similar to PIRADS v2)&#39;</span>]]</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the heatmap</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))  <span class="co"># Adjust the figure size as needed</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>sns.heatmap(ucla_corr, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the plot</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">&#39;ucla_score_corr_map.jpg&#39;</span>, dpi<span class="op">=</span><span class="dv">300</span>)  <span class="co"># Save the heatmap as a JPEG file</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>plt.show()  <span class="co"># Display the heatmap</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/1f5a25734374daa0dba7969ecc05b4353ba255d4.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="42"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:22.395667Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:22.395312Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:22.400874Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:22.399694Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:22.395632Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Config Create Images</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>images_to_use <span class="op">=</span> <span class="dv">25</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>x_crop <span class="op">=</span> <span class="dv">56</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>y_crop <span class="op">=</span> <span class="dv">56</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>folder_path <span class="op">=</span> <span class="st">&quot;/kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy&quot;</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>output_folder_path <span class="op">=</span> <span class="st">&quot;/kaggle/working&quot;</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="43"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:22.402840Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:22.402473Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:22.418786Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:22.417786Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:22.402803Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb96"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_folder(folder_path):</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co">    process_folder processes DCOM images in the folder</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="co">    :param folder_path: folder to process</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co">    :return: jpg_list,dcm_values</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span> </span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    jpg_list <span class="op">=</span> []</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    dcm_values <span class="op">=</span> []</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>    images_path <span class="op">=</span> os.listdir(folder_path)</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> image <span class="kw">in</span> images_path:</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>        full_path <span class="op">=</span> os.path.join(folder_path, image)</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> image.endswith(<span class="st">&quot;.dcm&quot;</span>):</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>            ds <span class="op">=</span> dicom.dcmread(full_path)</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>            jpg_image_name <span class="op">=</span> output_folder_path<span class="op">+</span>full_path<span class="op">+</span><span class="st">&quot;.jpg&quot;</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>            jpg_list.append(jpg_image_name)</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> os.path.exists(output_folder_path<span class="op">+</span>folder_path):</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>                os.makedirs(output_folder_path<span class="op">+</span>folder_path)</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>            cv2.imwrite(jpg_image_name, ds.pixel_array)</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>                               </span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>            patient_name<span class="op">=</span><span class="st">&#39;&#39;</span></span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>            patient_age<span class="op">=</span><span class="st">&#39;&#39;</span></span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>            patient_size<span class="op">=</span><span class="st">&#39;&#39;</span></span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>            patient_weight<span class="op">=</span><span class="st">&#39;&#39;</span></span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>            patient_eth<span class="op">=</span><span class="st">&#39;&#39;</span></span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>            patient_occ<span class="op">=</span><span class="st">&#39;&#39;</span></span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>            patient_smoke<span class="op">=</span><span class="st">&#39;&#39;</span></span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a>                patient_name <span class="op">=</span> ds[<span class="bn">0x0010</span>,<span class="bn">0x0010</span>].value</span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a>                patient_age <span class="op">=</span> ds[<span class="bn">0x0010</span>,<span class="bn">0x1010</span>].value</span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb96-45"><a href="#cb96-45" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb96-46"><a href="#cb96-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb96-47"><a href="#cb96-47" aria-hidden="true" tabindex="-1"></a>                patient_size <span class="op">=</span> ds[<span class="bn">0x0010</span>,<span class="bn">0x1020</span>].value</span>
<span id="cb96-48"><a href="#cb96-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb96-49"><a href="#cb96-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb96-50"><a href="#cb96-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-51"><a href="#cb96-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb96-52"><a href="#cb96-52" aria-hidden="true" tabindex="-1"></a>                patient_weight <span class="op">=</span> ds[<span class="bn">0x0010</span>,<span class="bn">0x1030</span>].value</span>
<span id="cb96-53"><a href="#cb96-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb96-54"><a href="#cb96-54" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb96-55"><a href="#cb96-55" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb96-56"><a href="#cb96-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb96-57"><a href="#cb96-57" aria-hidden="true" tabindex="-1"></a>                patient_eth <span class="op">=</span> ds[<span class="bn">0x0010</span>,<span class="bn">0x2160</span>].value</span>
<span id="cb96-58"><a href="#cb96-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb96-59"><a href="#cb96-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span>            </span>
<span id="cb96-60"><a href="#cb96-60" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb96-61"><a href="#cb96-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb96-62"><a href="#cb96-62" aria-hidden="true" tabindex="-1"></a>                patient_occ <span class="op">=</span> ds[<span class="bn">0x0010</span>,<span class="bn">0x2180</span>].value</span>
<span id="cb96-63"><a href="#cb96-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb96-64"><a href="#cb96-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span>            </span>
<span id="cb96-65"><a href="#cb96-65" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb96-66"><a href="#cb96-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb96-67"><a href="#cb96-67" aria-hidden="true" tabindex="-1"></a>                patient_smoke <span class="op">=</span> ds[<span class="bn">0x0010</span>,<span class="bn">0x21a0</span>].value</span>
<span id="cb96-68"><a href="#cb96-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb96-69"><a href="#cb96-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span>  </span>
<span id="cb96-70"><a href="#cb96-70" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb96-71"><a href="#cb96-71" aria-hidden="true" tabindex="-1"></a>            dcm_values.append([patient_name,patient_age,patient_size,patient_weight,patient_eth,patient_occ,patient_smoke])</span>
<span id="cb96-72"><a href="#cb96-72" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb96-73"><a href="#cb96-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> jpg_list,dcm_values,(output_folder_path<span class="op">+</span>folder_path)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="44"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:22.420306Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:22.419979Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:22.436565Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:22.435264Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:22.420268Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb97"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> crop_image(folder_path,x_crop,y_crop):</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co">    crop_image crops the image</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co">    :param folder_path: folder to process</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co">    :param x_crop: pixel crop x</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co">    :param y_crop: pixel crop y</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span> </span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>    fileList <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;*jpg*&#39;</span>)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate over images</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> filePath <span class="kw">in</span> fileList:</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>        img <span class="op">=</span> cv2.imread(filePath)</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>        image_shape_x <span class="op">=</span> img.shape[<span class="dv">0</span>]</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>        image_shape_y <span class="op">=</span> img.shape[<span class="dv">1</span>]</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>        crop_img <span class="op">=</span> img[(<span class="dv">0</span><span class="op">+</span>y_crop):(image_shape_y<span class="op">-</span>y_crop), (<span class="dv">0</span><span class="op">+</span>x_crop):(image_shape_x<span class="op">-</span>x_crop)]</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>        cv2.imwrite(filePath, crop_img)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="45"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:22.438339Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:22.437983Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:22.459114Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:22.457955Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:22.438304Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb98"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_jpg(folder_path):</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co">    remove_jpg removes jpg from folder</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co">    :param folder_path: folder to process</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span> </span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ==========================================================================================</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove old Final Files</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ==========================================================================================</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>    fileList1  <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;**/*AX_T2*/*jpg*&#39;</span> , recursive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>    fileList2 <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;**/*PROPELLER*/*jpg*&#39;</span> , recursive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>    fileList3 <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;**/*axial*/*jpg*&#39;</span> , recursive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>    fileList4 <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;**/*T2 Ax*/*jpg*&#39;</span> , recursive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>    fileList5 <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;**/*AX T2*/*jpg*&#39;</span> , recursive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>    fileList6 <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;**/*AX */*jpg*&#39;</span> , recursive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>    fileList7 <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;**/*T2 AX*/*jpg*&#39;</span> , recursive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>    fileList8 <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;**/*T2 SPACE*/*jpg*&#39;</span> , recursive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>    fileList <span class="op">=</span> fileList1 <span class="op">+</span> fileList2 <span class="op">+</span> fileList3 <span class="op">+</span> fileList4 <span class="op">+</span> fileList5 <span class="op">+</span> fileList6 <span class="op">+</span> fileList7 <span class="op">+</span> fileList8  </span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate over the list of filepaths &amp; remove each file.</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> filePath <span class="kw">in</span> fileList:    </span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:            </span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>            os.remove(filePath)</span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="46"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:22.461647Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:22.461183Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:20:22.476674Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:20:22.475555Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:22.461596Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb99"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_patient_image(folder_path,images_to_use):</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co">    make_patient_image creates images</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co">    :param folder_path: folder to process</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co">    :param images_to_use: images to use</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span> </span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ==========================================================================================</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># List all Images</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ==========================================================================================</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>    images_path <span class="op">=</span> os.listdir(folder_path)</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>    image_list <span class="op">=</span> []</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> image <span class="kw">in</span> images_path:</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>        full_path <span class="op">=</span> os.path.join(folder_path, image)</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> image.endswith(<span class="st">&quot;.jpg&quot;</span>):</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>            image_list.append(full_path)            </span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#sort images</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>    image_list.sort()</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>    image_cnt <span class="op">=</span> <span class="bu">len</span>(image_list)</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>    image_ignore <span class="op">=</span> math.floor((image_cnt<span class="op">-</span> images_to_use)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">#remove first x images</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>    image_list <span class="op">=</span> image_list[image_ignore:]</span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">#remove last x images</span></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>    image_list <span class="op">=</span> image_list[:<span class="bu">len</span>(image_list)<span class="op">-</span>image_ignore]</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>    image_list <span class="op">=</span> image_list[:images_to_use]</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>    image_cnt <span class="op">=</span> <span class="bu">len</span>(image_list)</span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> image_cnt <span class="op">==</span> <span class="dv">25</span>:</span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>        dims <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> image_cnt <span class="op">==</span> <span class="dv">16</span>:</span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>        dims <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> image_cnt <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>        dims <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> image_cnt <span class="op">&lt;</span> <span class="dv">4</span>:</span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a>        dims <span class="op">=</span> <span class="dv">1</span>        </span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a>        dims <span class="op">=</span> math.ceil((math.sqrt(image_cnt)))   </span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ==========================================================================================</span></span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Looping Over Images to Concatenate and create Vertical</span></span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ==========================================================================================</span></span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> coll_cnt <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,dims):</span>
<span id="cb99-53"><a href="#cb99-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-54"><a href="#cb99-54" aria-hidden="true" tabindex="-1"></a>        final_image <span class="op">=</span> os.path.join(folder_path, <span class="st">&quot;finalV&quot;</span> <span class="op">+</span> <span class="bu">str</span>(coll_cnt)<span class="op">+</span><span class="st">&quot;.jpg&quot;</span>)</span>
<span id="cb99-55"><a href="#cb99-55" aria-hidden="true" tabindex="-1"></a>        zero_flag <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb99-56"><a href="#cb99-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-57"><a href="#cb99-57" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(&quot;======================================&quot;)</span></span>
<span id="cb99-58"><a href="#cb99-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-59"><a href="#cb99-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,(dims)):        </span>
<span id="cb99-60"><a href="#cb99-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-61"><a href="#cb99-61" aria-hidden="true" tabindex="-1"></a>            image_number <span class="op">=</span> (x <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> (coll_cnt <span class="op">*</span> dims)</span>
<span id="cb99-62"><a href="#cb99-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-63"><a href="#cb99-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> image_number <span class="op">&gt;=</span> (image_cnt<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb99-64"><a href="#cb99-64" aria-hidden="true" tabindex="-1"></a>                <span class="co"># set image file names</span></span>
<span id="cb99-65"><a href="#cb99-65" aria-hidden="true" tabindex="-1"></a>                img1 <span class="op">=</span> final_image</span>
<span id="cb99-66"><a href="#cb99-66" aria-hidden="true" tabindex="-1"></a>                img2 <span class="op">=</span> image_list[(<span class="dv">0</span>)]</span>
<span id="cb99-67"><a href="#cb99-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-68"><a href="#cb99-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> zero_flag <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb99-69"><a href="#cb99-69" aria-hidden="true" tabindex="-1"></a>                <span class="co"># set image file names</span></span>
<span id="cb99-70"><a href="#cb99-70" aria-hidden="true" tabindex="-1"></a>                img1 <span class="op">=</span> image_list[image_number]</span>
<span id="cb99-71"><a href="#cb99-71" aria-hidden="true" tabindex="-1"></a>                img2 <span class="op">=</span> image_list[(image_number<span class="op">+</span><span class="dv">1</span>)]            </span>
<span id="cb99-72"><a href="#cb99-72" aria-hidden="true" tabindex="-1"></a>                zero_flag <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb99-73"><a href="#cb99-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb99-74"><a href="#cb99-74" aria-hidden="true" tabindex="-1"></a>                <span class="co"># set image file names</span></span>
<span id="cb99-75"><a href="#cb99-75" aria-hidden="true" tabindex="-1"></a>                img1 <span class="op">=</span> final_image</span>
<span id="cb99-76"><a href="#cb99-76" aria-hidden="true" tabindex="-1"></a>                img2 <span class="op">=</span> image_list[(image_number<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb99-77"><a href="#cb99-77" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb99-78"><a href="#cb99-78" aria-hidden="true" tabindex="-1"></a>            <span class="co"># read the images           </span></span>
<span id="cb99-79"><a href="#cb99-79" aria-hidden="true" tabindex="-1"></a>            img1 <span class="op">=</span> cv2.imread(img1)</span>
<span id="cb99-80"><a href="#cb99-80" aria-hidden="true" tabindex="-1"></a>            img2 <span class="op">=</span> cv2.imread(img2)</span>
<span id="cb99-81"><a href="#cb99-81" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb99-82"><a href="#cb99-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb99-83"><a href="#cb99-83" aria-hidden="true" tabindex="-1"></a>                im_v <span class="op">=</span> cv2.vconcat([img1, img2])   </span>
<span id="cb99-84"><a href="#cb99-84" aria-hidden="true" tabindex="-1"></a>                cv2.imwrite(final_image, im_v)        </span>
<span id="cb99-85"><a href="#cb99-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb99-86"><a href="#cb99-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb99-87"><a href="#cb99-87" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb99-88"><a href="#cb99-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ==========================================================================================</span></span>
<span id="cb99-89"><a href="#cb99-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Looping Over finalV images to concatenate into final image</span></span>
<span id="cb99-90"><a href="#cb99-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ==========================================================================================    </span></span>
<span id="cb99-91"><a href="#cb99-91" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-92"><a href="#cb99-92" aria-hidden="true" tabindex="-1"></a>    final_image <span class="op">=</span> os.path.join(folder_path, <span class="st">&quot;final.jpg&quot;</span>)</span>
<span id="cb99-93"><a href="#cb99-93" aria-hidden="true" tabindex="-1"></a>    image_list <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;*final*&#39;</span>)</span>
<span id="cb99-94"><a href="#cb99-94" aria-hidden="true" tabindex="-1"></a>    image_cnt <span class="op">=</span> <span class="bu">len</span>(image_list) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb99-95"><a href="#cb99-95" aria-hidden="true" tabindex="-1"></a>    zero_flag <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb99-96"><a href="#cb99-96" aria-hidden="true" tabindex="-1"></a>    image_list.sort()</span>
<span id="cb99-97"><a href="#cb99-97" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb99-98"><a href="#cb99-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,image_cnt):</span>
<span id="cb99-99"><a href="#cb99-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-100"><a href="#cb99-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> zero_flag <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb99-101"><a href="#cb99-101" aria-hidden="true" tabindex="-1"></a>            <span class="co"># set image file names</span></span>
<span id="cb99-102"><a href="#cb99-102" aria-hidden="true" tabindex="-1"></a>            img1 <span class="op">=</span> image_list[x]</span>
<span id="cb99-103"><a href="#cb99-103" aria-hidden="true" tabindex="-1"></a>            img2 <span class="op">=</span> image_list[(x<span class="op">+</span><span class="dv">1</span>)]            </span>
<span id="cb99-104"><a href="#cb99-104" aria-hidden="true" tabindex="-1"></a>            zero_flag <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb99-105"><a href="#cb99-105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb99-106"><a href="#cb99-106" aria-hidden="true" tabindex="-1"></a>            <span class="co"># set image file names</span></span>
<span id="cb99-107"><a href="#cb99-107" aria-hidden="true" tabindex="-1"></a>            img1 <span class="op">=</span> final_image</span>
<span id="cb99-108"><a href="#cb99-108" aria-hidden="true" tabindex="-1"></a>            img2 <span class="op">=</span> image_list[(x<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb99-109"><a href="#cb99-109" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb99-110"><a href="#cb99-110" aria-hidden="true" tabindex="-1"></a>        <span class="co"># read the images</span></span>
<span id="cb99-111"><a href="#cb99-111" aria-hidden="true" tabindex="-1"></a>        img1 <span class="op">=</span> cv2.imread(img1)</span>
<span id="cb99-112"><a href="#cb99-112" aria-hidden="true" tabindex="-1"></a>        img2 <span class="op">=</span> cv2.imread(img2)</span>
<span id="cb99-113"><a href="#cb99-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-114"><a href="#cb99-114" aria-hidden="true" tabindex="-1"></a>        im_v <span class="op">=</span> cv2.hconcat([img1, img2])   </span>
<span id="cb99-115"><a href="#cb99-115" aria-hidden="true" tabindex="-1"></a>        cv2.imwrite(final_image, im_v)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="47"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:20:22.478395Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:20:22.478051Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:29:23.703561Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:29:23.702323Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:20:22.478360Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb100"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fileList = glob.glob(folder_path + &#39;*/*0001*/*/*obl*&#39; , recursive=True)</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>fileList <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;*/*/*/*obl*&#39;</span> , recursive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>dcm_metadata <span class="op">=</span> []</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(fileList))</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove all JPG</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>remove_jpg(output_folder_path)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort List</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>fileList.sort()</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> folder <span class="kw">in</span> tqdm(fileList,desc <span class="op">=</span> <span class="st">&#39;Progress Bar: Processing&#39;</span>  ):</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert dicom to JPEG</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>    jpg_list, dcm_values, output_folder <span class="op">=</span> process_folder(folder<span class="op">+</span><span class="st">&quot;/&quot;</span>)</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Append Metadata to FinalList</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>    dcm_metadata.append(dcm_values)</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Crop Image</span></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>    crop_image(output_folder<span class="op">+</span><span class="st">&quot;/&quot;</span>,x_crop,y_crop)</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make collage</span></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>    make_patient_image(output_folder<span class="op">+</span><span class="st">&quot;/&quot;</span>,images_to_use)</span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>    counter <span class="op">=</span> counter <span class="op">+</span> <span class="dv">1</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>832
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>Progress Bar: Processing: 100%|██████████| 832/832 [08:47&lt;00:00,  1.58it/s]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="48"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:29:23.706311Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:29:23.705902Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:29:24.707514Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:29:24.706498Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:29:23.706276Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb103"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Empty DataFrame</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">&#39;name&#39;</span>,<span class="st">&#39;age&#39;</span>,<span class="st">&#39;size&#39;</span>,<span class="st">&#39;weight&#39;</span>,<span class="st">&#39;ethnic_grp&#39;</span>,<span class="st">&#39;occupation&#39;</span>,<span class="st">&#39;smoking_status&#39;</span>])</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Patient List</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> entry <span class="kw">in</span> dcm_metadata:</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    df.loc[counter] <span class="op">=</span> [entry[<span class="dv">0</span>][<span class="dv">0</span>]] <span class="op">+</span> [entry[<span class="dv">0</span>][<span class="dv">1</span>]] <span class="op">+</span> [entry[<span class="dv">0</span>][<span class="dv">2</span>]] <span class="op">+</span> [entry[<span class="dv">0</span>][<span class="dv">3</span>]] <span class="op">+</span> [entry[<span class="dv">0</span>][<span class="dv">4</span>]] <span class="op">+</span> [entry[<span class="dv">0</span>][<span class="dv">5</span>]] <span class="op">+</span> [entry[<span class="dv">0</span>][<span class="dv">6</span>]]</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    counter <span class="op">=</span> counter <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">&quot;patients.csv&quot;</span>, sep<span class="op">=</span><span class="st">&#39;,&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="49"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:29:24.709029Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:29:24.708653Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:29:24.720932Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:29:24.719782Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:29:24.708994Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb104"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                                                name   age   size  weight  \
0  (P, r, o, s, t, a, t, e, -, M, R, I, -, U, S, ...  064Y  1.676  94.802   
1  (P, r, o, s, t, a, t, e, -, M, R, I, -, U, S, ...  078Y  1.854  98.884   
2  (P, r, o, s, t, a, t, e, -, M, R, I, -, U, S, ...  074Y  1.778  80.740   
3  (P, r, o, s, t, a, t, e, -, M, R, I, -, U, S, ...  070Y  1.727  88.996   
4  (P, r, o, s, t, a, t, e, -, M, R, I, -, U, S, ...  070Y  1.854  83.280   

        ethnic_grp      occupation smoking_status  
0      Unknown [3]  Business Owner        UNKNOWN  
1  Not Hispanic or         RETIRED        UNKNOWN  
2  Not Hispanic or                        UNKNOWN  
3  Not Hispanic or         RETIRED        UNKNOWN  
4      Unknown [3]                        UNKNOWN  
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="50" data-collapsed="true"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:29:24.723383Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:29:24.722466Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:29:31.764965Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:29:31.763674Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:29:24.723345Z&quot;}"
data-jupyter="{&quot;outputs_hidden&quot;:true}" data-trusted="true">
<div class="sourceCode" id="cb106"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Target Flags</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>labels_file <span class="op">=</span> <span class="st">&quot;/kaggle/input/prostate-mri-us-biopsy/TCIA Biopsy Data_2020-07-14.xlsx&quot;</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="st">&quot;final.jpg&quot;</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>folder_path <span class="op">=</span> <span class="st">&quot;/kaggle/working/kaggle/input/prostate-mri-us-biopsy/prostate_mri_us_biopsy/Prostate-MRI-US-Biopsy&quot;</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>labels_df <span class="op">=</span> pd.read_excel (labels_file)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>fileList <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> <span class="st">&#39;**/*/*/*/&#39;</span><span class="op">+</span>file_name   , recursive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co">#print(fileList[0:2])</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> image <span class="kw">in</span> fileList:</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print the patient ID&#39;s</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(image[<span class="dv">121</span>:<span class="dv">125</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0014
0386
0419
0711
0711
0793
0546
0395
0855
0718
0159
0159
0955
0267
1019
0706
0706
0164
0258
0713
1067
0934
0423
0946
0707
0659
1135
0802
0892
1115
0902
0565
0565
0565
0071
0807
1132
0019
1148
0229
0229
0812
0094
0596
0670
0482
0756
0756
0109
0857
0370
0985
0820
0697
0306
0318
0470
0051
0959
0817
0628
0202
0448
0436
0130
0531
0092
0629
0961
0616
0775
0775
0775
0635
0635
0312
0832
0609
0349
0355
1069
0932
0645
1065
0495
0850
0685
0685
0478
0843
0118
0491
0250
0805
0256
0012
0059
0679
0475
0475
0475
0049
0532
0261
0261
0261
0665
0698
1102
0826
0210
0210
0782
0220
0181
0038
0321
0144
0551
0021
0766
0225
0886
0886
0980
0414
0414
1131
0915
0643
0621
1064
0472
0908
0298
1087
0248
0382
0731
1126
0081
0102
0024
0024
0024
0726
0690
0848
0152
0615
0443
0760
0760
0823
0823
0208
0208
0834
0869
0400
0400
0333
0242
0881
0211
0352
0897
0624
0581
0359
0607
0405
0929
0493
0574
0574
1024
0052
0143
0105
0184
0058
1120
0323
1127
0696
0677
0573
0067
0336
0336
0429
0776
0440
0716
0434
0084
0161
1097
0180
0883
0938
0035
0640
0640
1028
0244
0467
0188
0510
1151
0824
0824
0944
0806
1090
0394
0836
1117
0409
0487
0585
0599
0223
0223
0632
0642
0095
0744
0445
0327
0504
0033
0416
1121
0592
0471
0608
0608
0396
0673
0950
0126
0496
0569
0155
0319
0774
0183
1099
0734
0791
0314
0314
0868
0664
0973
0050
0108
0300
0780
0993
0921
0921
0001
0485
0667
0667
0139
0693
1000
0992
0135
0135
0075
0845
0907
0431
0678
0801
1030
1037
0911
0911
0684
1143
0746
0975
0499
0042
0189
0623
0468
0534
0974
0545
0545
1020
0036
0036
1086
0372
0904
0284
0284
0137
0821
0821
0847
0432
0432
0671
0755
0916
1068
0288
0895
0238
0446
0736
0701
0334
0639
0789
0522
0124
0053
0326
0326
0340
0951
0898
0539
0539
0245
0167
0462
0757
0362
0564
0653
0703
0783
0783
0255
1130
0377
0341
0205
0833
0173
1045
1029
0260
0500
0819
0209
0209
0226
0630
0686
0686
0686
1021
0060
0020
0020
0020
0020
0837
0104
0945
0427
0797
0676
0437
0905
0346
0356
0792
0138
0310
0090
0739
0424
1070
0528
0928
0509
0566
0498
0169
0264
0728
0492
0285
0494
0376
0368
0963
0293
0662
0999
0251
0727
0727
0455
0103
0262
0925
0925
0374
0622
0917
0772
0772
0145
0237
1116
0597
1081
1009
0338
0358
0654
0077
1010
1022
0958
0675
0675
0119
0878
0878
0452
0452
0687
0344
0663
0561
0399
0371
0896
1018
0243
1013
0286
0212
0593
0593
0348
0983
0761
0864
1088
0045
0942
0866
0302
0162
0162
0575
0568
0568
0305
0605
0997
0943
1136
0353
0600
0552
0978
0835
0354
0354
0873
0480
0722
0549
0342
0342
0178
0178
0702
0702
1048
1048
0406
0729
0331
0098
0168
0083
0479
0949
0709
0604
0604
0217
0842
0655
0328
0672
0725
0207
0808
1078
1078
0720
0720
0231
0231
0133
0786
0816
0066
0563
0874
0080
0469
0469
0972
1004
0032
0316
0192
0186
1002
0846
0741
1058
0003
0957
0076
0029
1111
0557
0557
0536
0769
0769
0587
1098
1092
0235
1006
0507
0507
0507
0507
0280
0781
0689
0556
0927
0852
0524
0198
0889
0695
0044
0044
0439
0364
0554
0660
0086
0027
0379
0345
0880
0525
0525
0055
0271
0015
0269
0411
0411
0179
0502
0998
0998
0612
0877
0877
0005
0117
0117
0721
0721
0013
0613
0613
0900
0981
0688
0278
0273
0247
0879
0879
0219
0307
1114
0486
0451
0383
0383
0956
0390
0282
0291
0751
1008
1053
0275
0357
0357
0361
0962
0922
0381
0381
0266
0594
0594
0594
0239
0366
0174
0457
0457
0240
0141
0009
0009
1123
0065
0964
0172
0730
0122
0501
0218
0194
0031
0523
0523
0939
0473
0214
0796
0854
0584
0979
0131
0360
1129
0078
0737
0061
0061
0061
0061
0061
0061
0953
0140
0308
0203
0203
0668
0800
0651
0228
0296
0274
0987
0627
0657
0771
0683
0986
0986
0112
1043
0297
0638
0461
0582
1046
0692
0906
0007
0007
0072
0867
0301
0646
0512
0839
1062
0625
1055
0128
0876
0876
0442
0442
0442
0747
0748
0849
0849
0712
0853
0666
0550
0200
0114
0577
1060
0367
1122
0489
0290
0290
0865
0752
0023
1141
0335
0332
0825
0526
0890
0221
0339
0412
0277
0277
0924
0856
0304
0453
0177
0682
0195
0185
0773
0773
0421
0110
0110
0742
0047
0006
0201
0723
0517
1005
0089
0089
0057
0610
0610
0129
0350
0447
0595
0555
0579
0996
0851
0402
0281
0732
0704
0960
0798
0187
1027
0037
1026
0513
0535
0641
0136
0454
0529
0529
0309
0309
0717
0976
0976
0311
0224
0224
0224
0224
0234
0127
0520
0488
0488
0714
0652
0028
0028
0365
0936
0022
0324
0829
1080
0460
1096
0784
0930
0213
0213
0213
0745
0413
0002
0966
0931
0931
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="51"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:29:31.766698Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:29:31.766326Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:29:33.208009Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:29:33.206865Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:29:31.766662Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb108"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#display a few final jpg images</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Limit to 10 images</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>max_images <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>selected_images <span class="op">=</span> fileList[:max_images]</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the images</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="bu">len</span>(selected_images), figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, image_path <span class="kw">in</span> <span class="bu">enumerate</span>(selected_images):</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> cv2.imread(image_path)  <span class="co"># Read image</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> cv2.cvtColor(img, cv2.COLOR_BGR2RGB)  <span class="co"># Convert to RGB for displaying</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Display the image</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>    axes[i].imshow(img)</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>    axes[i].axis(<span class="st">&#39;off&#39;</span>)  <span class="co"># Hide axes</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>    axes[i].set_title(<span class="ss">f&quot;Patient: </span><span class="sc">{</span>image_path[<span class="dv">121</span>:<span class="dv">125</span>]<span class="sc">}</span><span class="ss">&quot;</span>)  <span class="co"># Display Patient ID</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/13529ac910d7e768ffe03bf10aee3bf262973f3c.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="52"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:29:33.209912Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:29:33.209535Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:29:33.215894Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:29:33.214723Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:29:33.209869Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb109"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#we can now convert the jpg data into a pixel df with the label using percent cancer in core</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getLabel(patient_id):</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#here check the XL sheet for the patient percent cancer if greater than 0 return 1 else 0</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    patient_df <span class="op">=</span>  labels_df[labels_df[<span class="st">&#39;Patient Number&#39;</span>].<span class="bu">str</span>.contains(patient_id)]</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx,row <span class="kw">in</span> patient_df.iterrows():</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(row[<span class="st">&#39;% Cancer in Core&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>):</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="53"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:29:33.218097Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:29:33.217632Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:35:26.670106Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:35:26.668800Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:29:33.218040Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb110"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">300</span>  <span class="co"># Adjust based on memory</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>new_size <span class="op">=</span> (<span class="dv">128</span>, <span class="dv">128</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to process a single batch</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_batch(file_list, start_idx, batch_size):</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    end_idx <span class="op">=</span> <span class="bu">min</span>(start_idx <span class="op">+</span> batch_size, <span class="bu">len</span>(file_list))</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    batch_pixel_data <span class="op">=</span> []</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    batch_labels <span class="op">=</span> []</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> image_path <span class="kw">in</span> file_list[start_idx:end_idx]:</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ensure the file exists</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(image_path):</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;File not found: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Read image</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>        im <span class="op">=</span> cv2.imread(image_path)</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> im <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Error reading image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Resize and flatten image</span></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>        im_resized <span class="op">=</span> cv2.resize(im, new_size)</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>        pixel_data <span class="op">=</span> im_resized.flatten()</span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract label</span></span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>        label_segment <span class="op">=</span> image_path[<span class="dv">121</span>:<span class="dv">125</span>]  <span class="co"># Adjust indices as needed</span></span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> getLabel(label_segment)</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append to batch data</span></span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>        batch_pixel_data.append(pixel_data)</span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>        batch_labels.append(label)</span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> batch_pixel_data, batch_labels</span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Main processing loop</span></span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_images_in_batches(file_list, batch_size, output_file<span class="op">=</span><span class="st">&quot;/kaggle/working/processed_images_with_labels.csv&quot;</span>):</span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize storage for the DataFrame</span></span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a>    columns <span class="op">=</span> [<span class="ss">f&#39;pixel_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(new_size[<span class="dv">0</span>] <span class="op">*</span> new_size[<span class="dv">1</span>] <span class="op">*</span> <span class="dv">3</span>)] <span class="op">+</span> [<span class="st">&#39;output_label&#39;</span>]</span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Write the header for the output file</span></span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a>    pd.DataFrame(columns<span class="op">=</span>columns).to_csv(output_file, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process in batches</span></span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> start_idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(file_list), batch_size):</span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Process current batch</span></span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a>        batch_pixel_data, batch_labels <span class="op">=</span> process_batch(file_list, start_idx, batch_size)</span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create a DataFrame for the batch</span></span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a>        batch_df <span class="op">=</span> pd.DataFrame(batch_pixel_data, columns<span class="op">=</span>columns[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a>        batch_df[<span class="st">&#39;output_label&#39;</span>] <span class="op">=</span> batch_labels</span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append to CSV</span></span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a>        batch_df.to_csv(output_file, mode<span class="op">=</span><span class="st">&#39;a&#39;</span>, header<span class="op">=</span><span class="va">False</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-56"><a href="#cb110-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print progress</span></span>
<span id="cb110-57"><a href="#cb110-57" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Processed batch </span><span class="sc">{</span>start_idx <span class="op">//</span> batch_size <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss"> / </span><span class="sc">{</span><span class="bu">len</span>(file_list) <span class="op">//</span> batch_size <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb110-58"><a href="#cb110-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-59"><a href="#cb110-59" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Processing complete.&quot;</span>)</span>
<span id="cb110-60"><a href="#cb110-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-61"><a href="#cb110-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the function</span></span>
<span id="cb110-62"><a href="#cb110-62" aria-hidden="true" tabindex="-1"></a>process_images_in_batches(fileList, batch_size)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Processed batch 1 / 3
Processed batch 2 / 3
Processed batch 3 / 3
Processing complete.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="54"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:35:26.672483Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:35:26.671836Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:35:46.662055Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:35:46.661018Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:35:26.672431Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb112"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>path_to_df <span class="op">=</span> <span class="st">&quot;/kaggle/working/processed_images_with_labels.csv&quot;</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>df_final <span class="op">=</span> pd.read_csv(path_to_df)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="55"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:35:46.663754Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:35:46.663378Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:35:46.684548Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:35:46.683297Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:35:46.663688Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb113"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_final.head)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;bound method NDFrame.head of      pixel_0  pixel_1  pixel_2  pixel_3  pixel_4  pixel_5  pixel_6  pixel_7  \
0         11       11       11       12       12       12       44       44   
1          2        2        2       41       41       41        5        5   
2        122      122      122      102      102      102       62       62   
3         14       14       14       17       17       17       23       23   
4         15       15       15        7        7        7       10       10   
..       ...      ...      ...      ...      ...      ...      ...      ...   
826      129      129      129      147      147      147       85       85   
827       15       15       15        7        7        7        8        8   
828        8        8        8       11       11       11       51       51   
829       22       22       22       30       30       30       42       42   
830       22       22       22       12       12       12       18       18   

     pixel_8  pixel_9  ...  pixel_49143  pixel_49144  pixel_49145  \
0         44       14  ...          194          194          194   
1          5       13  ...           32           32           32   
2         62        8  ...          143          143          143   
3         23       31  ...          253          253          253   
4         10        5  ...          184          184          184   
..       ...      ...  ...          ...          ...          ...   
826       85       14  ...           95           95           95   
827        8        7  ...           35           35           35   
828       51       49  ...           78           78           78   
829       42       30  ...          242          242          242   
830       18       49  ...          213          213          213   

     pixel_49146  pixel_49147  pixel_49148  pixel_49149  pixel_49150  \
0              3            3            3            7            7   
1            206          206          206          131          131   
2            133          133          133           25           25   
3            155          155          155           11           11   
4            178          178          178           10           10   
..           ...          ...          ...          ...          ...   
826          101          101          101            8            8   
827           93           93           93           87           87   
828           43           43           43            8            8   
829          172          172          172          252          252   
830          176          176          176          222          222   

     pixel_49151  output_label  
0              7             0  
1            131             0  
2             25             1  
3             11             1  
4             10             1  
..           ...           ...  
826            8             0  
827           87             1  
828            8             1  
829          252             1  
830          222             1  

[831 rows x 49153 columns]&gt;
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="56"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:35:46.686740Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:35:46.686234Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:35:47.168598Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:35:47.161527Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:35:46.686671Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb115"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scale the pixels</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>first_image_pixels <span class="op">=</span> df_final.iloc[<span class="dv">0</span>, :<span class="op">-</span><span class="dv">1</span>].values  <span class="co"># Exclude the label column</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape to the original dimensions (128, 128, 3)</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>first_image <span class="op">=</span> first_image_pixels.reshape(<span class="dv">128</span>, <span class="dv">128</span>, <span class="dv">3</span>).astype(np.uint8)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the image</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>plt.imshow(first_image)</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)  <span class="co"># Hide axes</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;First Image from DataFrame&quot;</span>)</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_8feeae451f8348ce924f6947cd96f085/534167fe84bd732d56b7e9ab511c72a6aa167ef6.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="57"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:35:47.180150Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:35:47.178582Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:35:51.161392Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:35:51.159558Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:35:47.180007Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb116"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate features and labels</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> df_final.iloc[:, :<span class="op">-</span><span class="dv">1</span>]  <span class="co"># All columns except &#39;output_label&#39;</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> df_final[<span class="st">&#39;output_label&#39;</span>]  <span class="co"># &#39;output_label&#39; column</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the scaler (Min-Max Scaling to [0, 1])</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale the features</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>scaled_features <span class="op">=</span> scaler.fit_transform(features)</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine scaled features and labels back into a DataFrame</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>scaled_df_final <span class="op">=</span> pd.DataFrame(scaled_features, columns<span class="op">=</span>features.columns)</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>scaled_df_final[<span class="st">&#39;output_label&#39;</span>] <span class="op">=</span> labels.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of the scaled DataFrame</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(scaled_df_final.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>    pixel_0   pixel_1   pixel_2   pixel_3   pixel_4   pixel_5   pixel_6  \
0  0.043307  0.043307  0.043307  0.054299  0.054299  0.054299  0.192982   
1  0.007874  0.007874  0.007874  0.185520  0.185520  0.185520  0.021930   
2  0.480315  0.480315  0.480315  0.461538  0.461538  0.461538  0.271930   
3  0.055118  0.055118  0.055118  0.076923  0.076923  0.076923  0.100877   
4  0.059055  0.059055  0.059055  0.031674  0.031674  0.031674  0.043860   

    pixel_7   pixel_8   pixel_9  ...  pixel_49143  pixel_49144  pixel_49145  \
0  0.192982  0.192982  0.051587  ...     0.759843     0.759843     0.759843   
1  0.021930  0.021930  0.047619  ...     0.122047     0.122047     0.122047   
2  0.271930  0.271930  0.027778  ...     0.559055     0.559055     0.559055   
3  0.100877  0.100877  0.119048  ...     0.992126     0.992126     0.992126   
4  0.043860  0.043860  0.015873  ...     0.720472     0.720472     0.720472   

   pixel_49146  pixel_49147  pixel_49148  pixel_49149  pixel_49150  \
0     0.011765     0.011765     0.011765     0.023622     0.023622   
1     0.807843     0.807843     0.807843     0.511811     0.511811   
2     0.521569     0.521569     0.521569     0.094488     0.094488   
3     0.607843     0.607843     0.607843     0.039370     0.039370   
4     0.698039     0.698039     0.698039     0.035433     0.035433   

   pixel_49151  output_label  
0     0.023622             0  
1     0.511811             0  
2     0.094488             1  
3     0.039370             1  
4     0.035433             1  

[5 rows x 49153 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="58"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:35:51.164323Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:35:51.163823Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:36:09.860657Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:36:09.859298Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:35:51.164274Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb118"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skimage.feature <span class="im">import</span> local_binary_pattern</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature extraction functions</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_mri_collage_features(image):</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to grayscale</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>    gray_image <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Histogram of Intensities (Grayscale)</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>    hist <span class="op">=</span> cv2.calcHist([gray_image], [<span class="dv">0</span>], <span class="va">None</span>, [<span class="dv">16</span>], [<span class="dv">0</span>, <span class="dv">256</span>]).flatten()  <span class="co"># 16 bins</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Edge Features (using Canny edge detector)</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>    edges <span class="op">=</span> cv2.Canny(gray_image, <span class="dv">50</span>, <span class="dv">150</span>)</span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>    edge_density <span class="op">=</span> np.<span class="bu">sum</span>(edges) <span class="op">/</span> (edges.shape[<span class="dv">0</span>] <span class="op">*</span> edges.shape[<span class="dv">1</span>])  <span class="co"># Edge density</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3. Local Binary Pattern (LBP) for Texture</span></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>    lbp <span class="op">=</span> local_binary_pattern(gray_image, P<span class="op">=</span><span class="dv">8</span>, R<span class="op">=</span><span class="dv">1</span>, method<span class="op">=</span><span class="st">&#39;uniform&#39;</span>)</span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>    lbp_hist <span class="op">=</span> np.histogram(lbp.ravel(), bins<span class="op">=</span>np.arange(<span class="dv">0</span>, <span class="dv">11</span>), <span class="bu">range</span><span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>))[<span class="dv">0</span>]  <span class="co"># LBP histogram</span></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4. Entropy as a measure of texture complexity</span></span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>    hist_normalized <span class="op">=</span> hist <span class="op">/</span> hist.<span class="bu">sum</span>()</span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>    entropy <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(hist_normalized <span class="op">*</span> np.log2(hist_normalized <span class="op">+</span> <span class="fl">1e-5</span>))  <span class="co"># Entropy</span></span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine features</span></span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>    features <span class="op">=</span> np.hstack([hist, edge_density, lbp_hist, entropy])</span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> features</span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to process a single batch of MRI collages</span></span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_batch_with_mri_features(file_list, start_idx, batch_size, new_size):</span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a>    end_idx <span class="op">=</span> <span class="bu">min</span>(start_idx <span class="op">+</span> batch_size, <span class="bu">len</span>(file_list))</span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a>    batch_feature_data <span class="op">=</span> []</span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a>    batch_labels <span class="op">=</span> []</span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> image_path <span class="kw">in</span> file_list[start_idx:end_idx]:</span>
<span id="cb118-38"><a href="#cb118-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ensure the file exists</span></span>
<span id="cb118-39"><a href="#cb118-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(image_path):</span>
<span id="cb118-40"><a href="#cb118-40" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;File not found: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb118-41"><a href="#cb118-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb118-42"><a href="#cb118-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb118-43"><a href="#cb118-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Read image</span></span>
<span id="cb118-44"><a href="#cb118-44" aria-hidden="true" tabindex="-1"></a>        im <span class="op">=</span> cv2.imread(image_path)</span>
<span id="cb118-45"><a href="#cb118-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> im <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb118-46"><a href="#cb118-46" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Error reading image: </span><span class="sc">{</span>image_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb118-47"><a href="#cb118-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb118-48"><a href="#cb118-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb118-49"><a href="#cb118-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Resize image</span></span>
<span id="cb118-50"><a href="#cb118-50" aria-hidden="true" tabindex="-1"></a>        im_resized <span class="op">=</span> cv2.resize(im, new_size)</span>
<span id="cb118-51"><a href="#cb118-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb118-52"><a href="#cb118-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract features</span></span>
<span id="cb118-53"><a href="#cb118-53" aria-hidden="true" tabindex="-1"></a>        features <span class="op">=</span> extract_mri_collage_features(im_resized)</span>
<span id="cb118-54"><a href="#cb118-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb118-55"><a href="#cb118-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract label (adjust based on your file naming convention)</span></span>
<span id="cb118-56"><a href="#cb118-56" aria-hidden="true" tabindex="-1"></a>        label_segment <span class="op">=</span> image_path[<span class="dv">121</span>:<span class="dv">125</span>]  <span class="co"># Adjust indices as needed</span></span>
<span id="cb118-57"><a href="#cb118-57" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> getLabel(label_segment)</span>
<span id="cb118-58"><a href="#cb118-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb118-59"><a href="#cb118-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append to batch data</span></span>
<span id="cb118-60"><a href="#cb118-60" aria-hidden="true" tabindex="-1"></a>        batch_feature_data.append(features)</span>
<span id="cb118-61"><a href="#cb118-61" aria-hidden="true" tabindex="-1"></a>        batch_labels.append(label)</span>
<span id="cb118-62"><a href="#cb118-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-63"><a href="#cb118-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> batch_feature_data, batch_labels</span>
<span id="cb118-64"><a href="#cb118-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-65"><a href="#cb118-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Main processing loop</span></span>
<span id="cb118-66"><a href="#cb118-66" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_mri_collages_with_features(file_list, batch_size, output_file<span class="op">=</span><span class="st">&quot;/kaggle/working/mri_collage_features.csv&quot;</span>, new_size<span class="op">=</span>(<span class="dv">128</span>, <span class="dv">128</span>)):</span>
<span id="cb118-67"><a href="#cb118-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize columns for the features</span></span>
<span id="cb118-68"><a href="#cb118-68" aria-hidden="true" tabindex="-1"></a>    feature_names <span class="op">=</span> [<span class="ss">f&#39;gray_hist_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">16</span>)] <span class="op">+</span> [<span class="st">&#39;edge_density&#39;</span>] <span class="op">+</span> [<span class="ss">f&#39;lbp_hist_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)] <span class="op">+</span> [<span class="st">&#39;entropy&#39;</span>]</span>
<span id="cb118-69"><a href="#cb118-69" aria-hidden="true" tabindex="-1"></a>    columns <span class="op">=</span> feature_names <span class="op">+</span> [<span class="st">&#39;output_label&#39;</span>]</span>
<span id="cb118-70"><a href="#cb118-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-71"><a href="#cb118-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Write the header for the output file</span></span>
<span id="cb118-72"><a href="#cb118-72" aria-hidden="true" tabindex="-1"></a>    pd.DataFrame(columns<span class="op">=</span>columns).to_csv(output_file, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb118-73"><a href="#cb118-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-74"><a href="#cb118-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process in batches</span></span>
<span id="cb118-75"><a href="#cb118-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> start_idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(file_list), batch_size):</span>
<span id="cb118-76"><a href="#cb118-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Process current batch</span></span>
<span id="cb118-77"><a href="#cb118-77" aria-hidden="true" tabindex="-1"></a>        batch_feature_data, batch_labels <span class="op">=</span> process_batch_with_mri_features(file_list, start_idx, batch_size, new_size)</span>
<span id="cb118-78"><a href="#cb118-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb118-79"><a href="#cb118-79" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create a DataFrame for the batch</span></span>
<span id="cb118-80"><a href="#cb118-80" aria-hidden="true" tabindex="-1"></a>        batch_df <span class="op">=</span> pd.DataFrame(batch_feature_data, columns<span class="op">=</span>feature_names)</span>
<span id="cb118-81"><a href="#cb118-81" aria-hidden="true" tabindex="-1"></a>        batch_df[<span class="st">&#39;output_label&#39;</span>] <span class="op">=</span> batch_labels</span>
<span id="cb118-82"><a href="#cb118-82" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb118-83"><a href="#cb118-83" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append to CSV</span></span>
<span id="cb118-84"><a href="#cb118-84" aria-hidden="true" tabindex="-1"></a>        batch_df.to_csv(output_file, mode<span class="op">=</span><span class="st">&#39;a&#39;</span>, header<span class="op">=</span><span class="va">False</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb118-85"><a href="#cb118-85" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb118-86"><a href="#cb118-86" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print progress</span></span>
<span id="cb118-87"><a href="#cb118-87" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Processed batch </span><span class="sc">{</span>start_idx <span class="op">//</span> batch_size <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss"> / </span><span class="sc">{</span><span class="bu">len</span>(file_list) <span class="op">//</span> batch_size <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb118-88"><a href="#cb118-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb118-89"><a href="#cb118-89" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Processing complete.&quot;</span>)</span>
<span id="cb118-90"><a href="#cb118-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-91"><a href="#cb118-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the function</span></span>
<span id="cb118-92"><a href="#cb118-92" aria-hidden="true" tabindex="-1"></a>process_mri_collages_with_features(fileList, batch_size)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Processed batch 1 / 3
Processed batch 2 / 3
Processed batch 3 / 3
Processing complete.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="59"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:36:09.862799Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:36:09.862300Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:36:09.875450Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:36:09.874068Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:36:09.862751Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb120"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>path_to_df_f <span class="op">=</span> <span class="st">&quot;/kaggle/working/mri_collage_features.csv&quot;</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>df_final_features <span class="op">=</span> pd.read_csv(path_to_df_f)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="60"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:36:09.877736Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:36:09.877176Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:36:09.904433Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:36:09.903275Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:36:09.877666Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb121"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_final_features.head)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;bound method NDFrame.head of      gray_hist_0  gray_hist_1  gray_hist_2  gray_hist_3  gray_hist_4  \
0         2983.0       1933.0       1503.0       1413.0       1577.0   
1         3313.0       1615.0       1026.0        924.0        916.0   
2         4420.0       2320.0       1590.0       1386.0       1292.0   
3         2569.0       3161.0       1450.0        806.0        695.0   
4         3482.0       2427.0       1395.0       1193.0       1114.0   
..           ...          ...          ...          ...          ...   
826       4267.0       2331.0       1463.0       1511.0       1464.0   
827       5991.0       2510.0       2452.0       1973.0       1803.0   
828       3948.0       2817.0       2643.0       2267.0       2444.0   
829       2612.0       2697.0       1536.0       1103.0        855.0   
830       3179.0       2588.0       1060.0        857.0        790.0   

     gray_hist_5  gray_hist_6  gray_hist_7  gray_hist_8  gray_hist_9  ...  \
0         1534.0       1370.0       1076.0        798.0        644.0  ...   
1         1028.0       1058.0       1005.0       1027.0       1015.0  ...   
2         1110.0        946.0        811.0        998.0        837.0  ...   
3          678.0        635.0        595.0        540.0        467.0  ...   
4          968.0        845.0        633.0        580.0        621.0  ...   
..           ...          ...          ...          ...          ...  ...   
826       1350.0       1147.0        958.0        746.0        491.0  ...   
827       1333.0        257.0         41.0         17.0          6.0  ...   
828       1635.0        457.0        130.0         26.0         12.0  ...   
829        802.0        702.0        669.0        619.0        613.0  ...   
830        789.0        813.0        741.0        735.0        643.0  ...   

     lbp_hist_2  lbp_hist_3  lbp_hist_4  lbp_hist_5  lbp_hist_6  lbp_hist_7  \
0         994.0      1126.0      1214.0       995.0       848.0      1662.0   
1         950.0      1141.0      1174.0      1035.0       802.0      1668.0   
2        1017.0      1053.0      1169.0      1097.0       936.0      1633.0   
3         799.0      1420.0      1092.0      1631.0       901.0      1730.0   
4        1042.0      1157.0      1196.0      1095.0       873.0      1690.0   
..          ...         ...         ...         ...         ...         ...   
826       927.0      1099.0      1303.0      1268.0       972.0      1663.0   
827       832.0      1032.0      1017.0      1003.0       856.0      1672.0   
828      1015.0      1269.0      1325.0      1283.0       924.0      1662.0   
829       923.0       979.0      1024.0      1043.0       846.0      1731.0   
830       865.0      1045.0      1072.0      1041.0       865.0      1645.0   

     lbp_hist_8  lbp_hist_9   entropy  output_label  
0        2423.0      3478.0  3.586480             0  
1        2402.0      3443.0  3.752176             0  
2        2419.0      3460.0  3.262044             1  
3        2294.0      3258.0  3.541489             1  
4        2333.0      3396.0  3.583481             1  
..          ...         ...       ...           ...  
826      2285.0      3300.0  3.289457             0  
827      2622.0      3524.0  2.498885             1  
828      2160.0      3226.0  2.717328             1  
829      2442.0      3539.0  3.766767             1  
830      2424.0      3573.0  3.736588             1  

[831 rows x 29 columns]&gt;
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="61"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:36:09.906613Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:36:09.906149Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:36:09.932147Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:36:09.930781Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:36:09.906560Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb123"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate features and labels</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> df_final_features.iloc[:, :<span class="op">-</span><span class="dv">1</span>]  <span class="co"># All columns except &#39;output_label&#39;</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> df_final_features[<span class="st">&#39;output_label&#39;</span>]  <span class="co"># &#39;output_label&#39; column</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the scaler (Min-Max Scaling to [0, 1])</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale the features</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>scaled_features <span class="op">=</span> scaler.fit_transform(features)</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine scaled features and labels back into a DataFrame</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>scaled_df_final_features <span class="op">=</span> pd.DataFrame(scaled_features, columns<span class="op">=</span>features.columns)</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>scaled_df_final_features[<span class="st">&#39;output_label&#39;</span>] <span class="op">=</span> labels.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of the scaled DataFrame</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(scaled_df_final_features.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>   gray_hist_0  gray_hist_1  gray_hist_2  gray_hist_3  gray_hist_4  \
0     0.157975     0.360042     0.346189     0.463583     0.563214   
1     0.179064     0.293165     0.236028     0.303150     0.327143   
2     0.249808     0.441430     0.366282     0.454724     0.461429   
3     0.131518     0.618297     0.333949     0.264436     0.248214   
4     0.189865     0.463933     0.321247     0.391404     0.397857   

   gray_hist_5  gray_hist_6  gray_hist_7  gray_hist_8  gray_hist_9  ...  \
0     0.631796     0.564948     0.462199     0.309903     0.364460  ...   
1     0.423394     0.436289     0.431701     0.398835     0.574420  ...   
2     0.457166     0.390103     0.348368     0.387573     0.473684  ...   
3     0.279242     0.261856     0.255584     0.209709     0.264290  ...   
4     0.398682     0.348454     0.271907     0.225243     0.351443  ...   

   lbp_hist_2  lbp_hist_3  lbp_hist_4  lbp_hist_5  lbp_hist_6  lbp_hist_7  \
0    0.728460    0.228355    0.417344    0.039269    0.372493    0.628231   
1    0.613577    0.244589    0.363144    0.075799    0.240688    0.640159   
2    0.788512    0.149351    0.356369    0.132420    0.624642    0.570577   
3    0.219321    0.546537    0.252033    0.620091    0.524355    0.763419   
4    0.853786    0.261905    0.392954    0.130594    0.444126    0.683897   

   lbp_hist_8  lbp_hist_9   entropy  output_label  
0    0.345392    0.719084  0.898699             0  
1    0.331058    0.665649  0.941488             0  
2    0.342662    0.691603  0.814918             1  
3    0.257338    0.383206  0.887081             1  
4    0.283959    0.593893  0.897925             1  

[5 rows x 29 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="62"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:36:09.934986Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:36:09.934521Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:36:10.376255Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:36:10.374930Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:36:09.934947Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb125"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming `scaled_df_final` is your DataFrame</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate features and labels</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> scaled_df_final.iloc[:, :<span class="op">-</span><span class="dv">1</span>]  <span class="co"># All columns except &#39;output_label&#39;</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> scaled_df_final[<span class="st">&#39;output_label&#39;</span>]  <span class="co"># &#39;output_label&#39; column</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform train-test split</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the shapes of the resulting splits</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Training features shape:&quot;</span>, X_train.shape)</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Testing features shape:&quot;</span>, X_test.shape)</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Training labels shape:&quot;</span>, y_train.shape)</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Testing labels shape:&quot;</span>, y_test.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Training features shape: (664, 49152)
Testing features shape: (167, 49152)
Training labels shape: (664,)
Testing labels shape: (167,)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="63"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:36:10.378217Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:36:10.377811Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:36:10.392286Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:36:10.390801Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:36:10.378178Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb127"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming `scaled_df_final` is your DataFrame</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate features and labels</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>X_features <span class="op">=</span> scaled_df_final_features.iloc[:, :<span class="op">-</span><span class="dv">1</span>]  <span class="co"># All columns except &#39;output_label&#39;</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>y_features <span class="op">=</span> scaled_df_final_features[<span class="st">&#39;output_label&#39;</span>]  <span class="co"># &#39;output_label&#39; column</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform train-test split</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>X_train_features, X_test_features, y_train_features, y_test_features <span class="op">=</span> train_test_split(X_features, y_features, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the shapes of the resulting splits</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Training features shape:&quot;</span>, X_train_features.shape)</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Testing features shape:&quot;</span>, X_test_features.shape)</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Training labels shape:&quot;</span>, y_train_features.shape)</span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Testing labels shape:&quot;</span>, y_test_features.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Training features shape: (664, 28)
Testing features shape: (167, 28)
Training labels shape: (664,)
Testing labels shape: (167,)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="64"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:36:10.394386Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:36:10.393998Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:36:44.780002Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:36:44.776769Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:36:10.394346Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb129"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, confusion_matrix</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Logistic Regression model</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>log_reg <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>)  <span class="co"># You can adjust the max_iter if needed</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model to the training data</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>log_reg.fit(X_train, y_train)</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> log_reg.predict(X_test)</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="op">=</span> confusion_matrix(y_test, y_pred)</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy)</span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:</span><span class="ch">\n</span><span class="st">&quot;</span>, conf_matrix)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.8502994011976048
Confusion Matrix:
 [[  5  20]
 [  5 137]]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="65"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:36:44.782214Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:36:44.781671Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:36:44.837387Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:36:44.836099Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:36:44.782159Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb131"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, confusion_matrix</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Logistic Regression model</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>log_reg_f <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>)  <span class="co"># You can adjust the max_iter if needed</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model to the training data</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>log_reg_f.fit(X_train_features, y_train_features)</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>y_pred_f <span class="op">=</span> log_reg_f.predict(X_test_features)</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>accuracy_f <span class="op">=</span> accuracy_score(y_test_features, y_pred_f)</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>conf_matrix_f <span class="op">=</span> confusion_matrix(y_test_features, y_pred_f)</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy_f)</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:</span><span class="ch">\n</span><span class="st">&quot;</span>, conf_matrix_f)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.8502994011976048
Confusion Matrix:
 [[  0  25]
 [  0 142]]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="66"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:36:44.843912Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:36:44.842561Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:36:45.467067Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:36:45.465118Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:36:44.843834Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb133"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>y_pred_log_train <span class="op">=</span> log_reg.predict(X_train)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>accuracy_log_train <span class="op">=</span> accuracy_score(y_train, y_pred_log_train)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_log_train)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 1.0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="67"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:36:45.469146Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:36:45.468621Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:36:58.155773Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:36:58.154554Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:36:45.469088Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb135"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>rf_model.fit(X_train, y_train)</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test set</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>y_pred_rf <span class="op">=</span> rf_model.predict(X_test)</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>accuracy_rf <span class="op">=</span> accuracy_score(y_test, y_pred_rf)</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_rf)</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Random Forest Classifier Performance:&quot;</span>)</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_rf))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.844311377245509
Random Forest Classifier Performance:
              precision    recall  f1-score   support

           0       0.33      0.04      0.07        25
           1       0.85      0.99      0.92       142

    accuracy                           0.84       167
   macro avg       0.59      0.51      0.49       167
weighted avg       0.78      0.84      0.79       167

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="68"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:36:58.157678Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:36:58.157226Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:36:58.562436Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:36:58.561275Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:36:58.157628Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb137"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>rf_model_f <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>rf_model_f.fit(X_train_features, y_train_features)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test set</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>y_pred_rf_f <span class="op">=</span> rf_model_f.predict(X_test_features)</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>accuracy_rf_f <span class="op">=</span> accuracy_score(y_test_features, y_pred_rf_f)</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_rf_f)</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Random Forest Classifier Performance:&quot;</span>)</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test_features, y_pred_rf_f))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.8203592814371258
Random Forest Classifier Performance:
              precision    recall  f1-score   support

           0       0.22      0.08      0.12        25
           1       0.85      0.95      0.90       142

    accuracy                           0.82       167
   macro avg       0.54      0.52      0.51       167
weighted avg       0.76      0.82      0.78       167

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="69"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:36:58.564188Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:36:58.563816Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:37:11.207021Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:37:11.205731Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:36:58.564154Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb139"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>rf_model.fit(X_train, y_train)</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test set</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>y_pred_rf <span class="op">=</span> rf_model.predict(X_test)</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>accuracy_rf <span class="op">=</span> accuracy_score(y_test, y_pred_rf)</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_rf)</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Random Forest Classifier Performance:&quot;</span>)</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_rf))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.844311377245509
Random Forest Classifier Performance:
              precision    recall  f1-score   support

           0       0.33      0.04      0.07        25
           1       0.85      0.99      0.92       142

    accuracy                           0.84       167
   macro avg       0.59      0.51      0.49       167
weighted avg       0.78      0.84      0.79       167

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="70"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:37:11.208694Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:37:11.208350Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:37:11.842406Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:37:11.841144Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:37:11.208659Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb141"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>y_pred_rf_train <span class="op">=</span> rf_model.predict(X_train)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>accuracy_rf_train <span class="op">=</span> accuracy_score(y_train, y_pred_rf_train)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_rf_train)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 1.0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="71"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:37:11.844395Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:37:11.843993Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:37:41.046102Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:37:41.044673Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:37:11.844356Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb143"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Decision Tree classifier</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>dt_clf <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>dt_clf.fit(X_train, y_train)</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>y_pred_dt <span class="op">=</span> dt_clf.predict(X_test)</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>accuracy_dt <span class="op">=</span> accuracy_score(y_test, y_pred_dt)</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_dt)</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Decision Tree Classification Report:&quot;</span>)</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_dt))</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred_dt))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.6586826347305389
Decision Tree Classification Report:
              precision    recall  f1-score   support

           0       0.15      0.28      0.20        25
           1       0.85      0.73      0.78       142

    accuracy                           0.66       167
   macro avg       0.50      0.50      0.49       167
weighted avg       0.75      0.66      0.70       167

Confusion Matrix:
[[  7  18]
 [ 39 103]]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="72"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:37:41.048301Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:37:41.047815Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:37:41.092303Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:37:41.091000Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:37:41.048248Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb145"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Decision Tree classifier</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>dt_clf_f <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>dt_clf_f.fit(X_train_features, y_train_features)</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>y_pred_dt_f <span class="op">=</span> dt_clf_f.predict(X_test_features)</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>accuracy_dt_f <span class="op">=</span> accuracy_score(y_test_features, y_pred_dt_f)</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_dt_f)</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Decision Tree Classification Report:&quot;</span>)</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test_features, y_pred_dt_f))</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test_features, y_pred_dt_f))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.718562874251497
Decision Tree Classification Report:
              precision    recall  f1-score   support

           0       0.18      0.24      0.20        25
           1       0.86      0.80      0.83       142

    accuracy                           0.72       167
   macro avg       0.52      0.52      0.52       167
weighted avg       0.76      0.72      0.74       167

Confusion Matrix:
[[  6  19]
 [ 28 114]]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="73"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:37:41.094383Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:37:41.093844Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:37:41.722834Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:37:41.721460Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:37:41.094331Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb147"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>y_pred_dt_train <span class="op">=</span> dt_clf.predict(X_train)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>accuracy_dt_train <span class="op">=</span> accuracy_score(y_train, y_pred_dt_train)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_dt_train)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 1.0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="74"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:37:41.724830Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:37:41.724390Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:37:44.011602Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:37:44.010233Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:37:41.724791Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb149"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Gaussian Naive Bayes classifier</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>nb_clf <span class="op">=</span> GaussianNB()</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>nb_clf.fit(X_train, y_train)</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>y_pred_nb <span class="op">=</span> nb_clf.predict(X_test)</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>accuracy_nb <span class="op">=</span> accuracy_score(y_test, y_pred_nb)</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_nb)</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Naive Bayes Classification Report:&quot;</span>)</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_nb))</span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred_nb))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.6586826347305389
Naive Bayes Classification Report:
              precision    recall  f1-score   support

           0       0.21      0.48      0.30        25
           1       0.88      0.69      0.77       142

    accuracy                           0.66       167
   macro avg       0.55      0.59      0.54       167
weighted avg       0.78      0.66      0.70       167

Confusion Matrix:
[[12 13]
 [44 98]]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="75"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:37:44.013296Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:37:44.012944Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:37:44.036561Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:37:44.035157Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:37:44.013264Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb151"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Gaussian Naive Bayes classifier</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>nb_clf_f <span class="op">=</span> GaussianNB()</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>nb_clf_f.fit(X_train_features, y_train_features)</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>y_pred_nb_f <span class="op">=</span> nb_clf_f.predict(X_test_features)</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>accuracy_nb_f <span class="op">=</span> accuracy_score(y_test_features, y_pred_nb_f)</span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_nb_f)</span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Naive Bayes Classification Report:&quot;</span>)</span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test_features, y_pred_nb_f))</span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test_features, y_pred_nb_f))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.7544910179640718
Naive Bayes Classification Report:
              precision    recall  f1-score   support

           0       0.10      0.08      0.09        25
           1       0.84      0.87      0.86       142

    accuracy                           0.75       167
   macro avg       0.47      0.48      0.47       167
weighted avg       0.73      0.75      0.74       167

Confusion Matrix:
[[  2  23]
 [ 18 124]]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="76"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:37:44.038417Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:37:44.038031Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:37:46.089686Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:37:46.088474Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:37:44.038381Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb153"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> BernoulliNB</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Bernoulli Naive Bayes classifier</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>nb_clf <span class="op">=</span> BernoulliNB()</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>nb_clf.fit(X_train, y_train)</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>y_pred_nb <span class="op">=</span> nb_clf.predict(X_test)</span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>accuracy_nb <span class="op">=</span> accuracy_score(y_test, y_pred_nb)</span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_nb)</span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-17"><a href="#cb153-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb153-18"><a href="#cb153-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Naive Bayes Classification Report:&quot;</span>)</span>
<span id="cb153-19"><a href="#cb153-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_nb))</span>
<span id="cb153-20"><a href="#cb153-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-21"><a href="#cb153-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb153-22"><a href="#cb153-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred_nb))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.7904191616766467
Naive Bayes Classification Report:
              precision    recall  f1-score   support

           0       0.14      0.08      0.10        25
           1       0.85      0.92      0.88       142

    accuracy                           0.79       167
   macro avg       0.50      0.50      0.49       167
weighted avg       0.74      0.79      0.76       167

Confusion Matrix:
[[  2  23]
 [ 12 130]]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="77"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:37:46.091666Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:37:46.091205Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:37:46.130107Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:37:46.128595Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:37:46.091618Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb155"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> BernoulliNB</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Bernoulli Naive Bayes classifier</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>nb_clf_f <span class="op">=</span> BernoulliNB()</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the model</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>nb_clf_f.fit(X_train_features, y_train_features)</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>y_pred_nb_f <span class="op">=</span> nb_clf_f.predict(X_test_features)</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>accuracy_nb_f <span class="op">=</span> accuracy_score(y_test_features, y_pred_nb_f)</span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_nb_f)</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Naive Bayes Classification Report:&quot;</span>)</span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test_features, y_pred_nb_f))</span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test_features, y_pred_nb_f))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.844311377245509
Naive Bayes Classification Report:
              precision    recall  f1-score   support

           0       0.00      0.00      0.00        25
           1       0.85      0.99      0.92       142

    accuracy                           0.84       167
   macro avg       0.42      0.50      0.46       167
weighted avg       0.72      0.84      0.78       167

Confusion Matrix:
[[  0  25]
 [  1 141]]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="78"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:37:46.133158Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:37:46.132374Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:37:47.464502Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:37:47.462086Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:37:46.133097Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb157"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>y_pred_nb_train <span class="op">=</span> nb_clf.predict(X_train)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>accuracy_nb_train <span class="op">=</span> accuracy_score(y_train, y_pred_nb_train)</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>,accuracy_nb_train)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy: 0.8343373493975904
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="79"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T10:37:47.470035Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T10:37:47.469461Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T10:44:27.834479Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T10:44:27.830654Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T10:37:47.469980Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb159"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neural_network <span class="im">import</span> MLPClassifier</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Assume you already have X_train, X_test, y_train, y_test</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="co"># List of activation functions to test</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>activation_functions <span class="op">=</span> [<span class="st">&#39;relu&#39;</span>, <span class="st">&#39;tanh&#39;</span>, <span class="st">&#39;logistic&#39;</span>]</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Store results in a list</span></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> []</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each activation function</span></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> activation <span class="kw">in</span> activation_functions:</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Testing MLP with </span><span class="sc">{</span>activation<span class="sc">}</span><span class="ss"> activation function...&quot;</span>)</span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the MLPClassifier with the current activation function</span></span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>    mlp_clf <span class="op">=</span> MLPClassifier(hidden_layer_sizes<span class="op">=</span>(<span class="dv">128</span>, <span class="dv">64</span>, <span class="dv">32</span>),  <span class="co"># Example architecture</span></span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>                            activation<span class="op">=</span>activation,          <span class="co"># Current activation function</span></span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>                            solver<span class="op">=</span><span class="st">&#39;adam&#39;</span>,                  <span class="co"># Optimizer</span></span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>                            max_iter<span class="op">=</span><span class="dv">200</span>,                   <span class="co"># Max iterations</span></span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a>                            random_state<span class="op">=</span><span class="dv">42</span>,                <span class="co"># Reproducibility</span></span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a>                            batch_size<span class="op">=</span><span class="dv">128</span>,                 <span class="co"># Batch size</span></span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a>                            learning_rate_init<span class="op">=</span><span class="fl">0.001</span>)       <span class="co"># Learning rate</span></span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train the model</span></span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a>    mlp_clf.fit(X_train, y_train)</span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make predictions on the test set</span></span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> mlp_clf.predict(X_test)</span>
<span id="cb159-33"><a href="#cb159-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-34"><a href="#cb159-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate accuracy</span></span>
<span id="cb159-35"><a href="#cb159-35" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb159-36"><a href="#cb159-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-37"><a href="#cb159-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get classification report</span></span>
<span id="cb159-38"><a href="#cb159-38" aria-hidden="true" tabindex="-1"></a>    class_report <span class="op">=</span> classification_report(y_test, y_pred)</span>
<span id="cb159-39"><a href="#cb159-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-40"><a href="#cb159-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Append results to the list</span></span>
<span id="cb159-41"><a href="#cb159-41" aria-hidden="true" tabindex="-1"></a>    results.append({</span>
<span id="cb159-42"><a href="#cb159-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Activation Function&#39;</span>: activation,</span>
<span id="cb159-43"><a href="#cb159-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Accuracy&#39;</span>: accuracy,</span>
<span id="cb159-44"><a href="#cb159-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Classification Report&#39;</span>: class_report</span>
<span id="cb159-45"><a href="#cb159-45" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb159-46"><a href="#cb159-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-47"><a href="#cb159-47" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Accuracy for </span><span class="sc">{</span>activation<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>accuracy<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb159-48"><a href="#cb159-48" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Classification Report for </span><span class="sc">{</span>activation<span class="sc">}</span><span class="ss">:</span><span class="ch">\n</span><span class="sc">{</span>class_report<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb159-49"><a href="#cb159-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-50"><a href="#cb159-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert results into a DataFrame for better readability</span></span>
<span id="cb159-51"><a href="#cb159-51" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb159-52"><a href="#cb159-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-53"><a href="#cb159-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the final results (Accuracy and Classification Reports)</span></span>
<span id="cb159-54"><a href="#cb159-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Final Results (Activation Function vs Accuracy and Classification Report):&quot;</span>)</span>
<span id="cb159-55"><a href="#cb159-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results_df)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Testing MLP with relu activation function...
Accuracy for relu: 0.8503
Classification Report for relu:
              precision    recall  f1-score   support

           0       0.50      0.20      0.29        25
           1       0.87      0.96      0.92       142

    accuracy                           0.85       167
   macro avg       0.69      0.58      0.60       167
weighted avg       0.82      0.85      0.82       167


Testing MLP with tanh activation function...
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Accuracy for tanh: 0.8503
Classification Report for tanh:
              precision    recall  f1-score   support

           0       0.00      0.00      0.00        25
           1       0.85      1.00      0.92       142

    accuracy                           0.85       167
   macro avg       0.43      0.50      0.46       167
weighted avg       0.72      0.85      0.78       167


Testing MLP with logistic activation function...
Accuracy for logistic: 0.8503
Classification Report for logistic:
              precision    recall  f1-score   support

           0       0.00      0.00      0.00        25
           1       0.85      1.00      0.92       142

    accuracy                           0.85       167
   macro avg       0.43      0.50      0.46       167
weighted avg       0.72      0.85      0.78       167


Final Results (Activation Function vs Accuracy and Classification Report):
  Activation Function  Accuracy  \
0                relu  0.850299   
1                tanh  0.850299   
2            logistic  0.850299   

                               Classification Report  
0                precision    recall  f1-score   ...  
1                precision    recall  f1-score   ...  
2                precision    recall  f1-score   ...  
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="123"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:57:14.672726Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:57:14.672180Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:57:24.689828Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:57:24.687894Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:57:14.672670Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb164"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from sklearn.model_selection import GridSearchCV</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co"># from sklearn.neural_network import MLPClassifier</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Define your model</span></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="co"># model = MLPClassifier(random_state=42)</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # Define the parameter grid to search over</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a><span class="co"># param_grid = {</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     &#39;hidden_layer_sizes&#39;: [(128, 64, 32)], </span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     &#39;activation&#39;: [&#39;tanh&#39;],        </span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     &#39;solver&#39;: [&#39;adam&#39;, &#39;sgd&#39;],                                     # Optimizer options</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     &#39;max_iter&#39;: [100, 200 ,300],                                         # Maximum iterations</span></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     &#39;learning_rate_init&#39;: [0.001, 0.01 , 2e-5 , 2e-3]                            # Learning rate</span></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a><span class="co"># # Initialize GridSearchCV with the model and parameter grid</span></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_search = GridSearchCV(estimator=model, </span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                            param_grid=param_grid, </span></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                            cv=5,                # Cross-validation folds</span></span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                            n_jobs=-1,           # Use all available CPU cores</span></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                            scoring=&#39;accuracy&#39;,  # Scoring metric (accuracy in this case)</span></span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                            verbose=2)           # Verbosity level to see progress</span></span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # Fit the grid search</span></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_search.fit(X_train, y_train)</span></span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a><span class="co"># # Get the best parameters and best score</span></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f&quot;Best Parameters: {grid_search.best_params_}&quot;)</span></span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f&quot;Best Accuracy: {grid_search.best_score_}&quot;)</span></span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a><span class="co"># # Get the best model</span></span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a><span class="co"># best_model = grid_search.best_estimator_</span></span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a><span class="co"># # Make predictions with the best model</span></span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a><span class="co"># y_pred = best_model.predict(X_test)</span></span>
<span id="cb164-36"><a href="#cb164-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-37"><a href="#cb164-37" aria-hidden="true" tabindex="-1"></a><span class="co"># # Evaluate the performance on test set</span></span>
<span id="cb164-38"><a href="#cb164-38" aria-hidden="true" tabindex="-1"></a><span class="co"># from sklearn.metrics import accuracy_score, classification_report</span></span>
<span id="cb164-39"><a href="#cb164-39" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f&quot;Test Accuracy: {accuracy_score(y_test, y_pred):.4f}&quot;)</span></span>
<span id="cb164-40"><a href="#cb164-40" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f&quot;Classification Report:\n{classification_report(y_test, y_pred)}&quot;)</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Fitting 5 folds for each of 24 candidates, totalling 120 fits
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/model_selection/_split.py:700: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:693: UserWarning: Training interrupted by user.
  warnings.warn(&quot;Training interrupted by user.&quot;)
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:693: UserWarning: Training interrupted by user.
  warnings.warn(&quot;Training interrupted by user.&quot;)
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:693: UserWarning: Training interrupted by user.
  warnings.warn(&quot;Training interrupted by user.&quot;)
/opt/conda/lib/python3.10/site-packages/sklearn/neural_network/_multilayer_perceptron.py:693: UserWarning: Training interrupted by user.
  warnings.warn(&quot;Training interrupted by user.&quot;)
</code></pre>
</div>
<div class="output error" data-ename="KeyboardInterrupt" data-evalue="">
<pre><code>---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
Cell In[123], line 25
     17 grid_search = GridSearchCV(estimator=model, 
     18                            param_grid=param_grid, 
     19                            cv=5,                # Cross-validation folds
     20                            n_jobs=-1,           # Use all available CPU cores
     21                            scoring=&#39;accuracy&#39;,  # Scoring metric (accuracy in this case)
     22                            verbose=2)           # Verbosity level to see progress
     24 # Fit the grid search
---&gt; 25 grid_search.fit(X_train, y_train)
     27 # Get the best parameters and best score
     28 print(f&quot;Best Parameters: {grid_search.best_params_}&quot;)

File /opt/conda/lib/python3.10/site-packages/sklearn/model_selection/_search.py:874, in BaseSearchCV.fit(self, X, y, groups, **fit_params)
    868     results = self._format_results(
    869         all_candidate_params, n_splits, all_out, all_more_results
    870     )
    872     return results
--&gt; 874 self._run_search(evaluate_candidates)
    876 # multimetric is determined here because in the case of a callable
    877 # self.scoring the return type is only known after calling
    878 first_test_score = all_out[0][&quot;test_scores&quot;]

File /opt/conda/lib/python3.10/site-packages/sklearn/model_selection/_search.py:1388, in GridSearchCV._run_search(self, evaluate_candidates)
   1386 def _run_search(self, evaluate_candidates):
   1387     &quot;&quot;&quot;Search all candidates in param_grid&quot;&quot;&quot;
-&gt; 1388     evaluate_candidates(ParameterGrid(self.param_grid))

File /opt/conda/lib/python3.10/site-packages/sklearn/model_selection/_search.py:821, in BaseSearchCV.fit.&lt;locals&gt;.evaluate_candidates(candidate_params, cv, more_results)
    813 if self.verbose &gt; 0:
    814     print(
    815         &quot;Fitting {0} folds for each of {1} candidates,&quot;
    816         &quot; totalling {2} fits&quot;.format(
    817             n_splits, n_candidates, n_candidates * n_splits
    818         )
    819     )
--&gt; 821 out = parallel(
    822     delayed(_fit_and_score)(
    823         clone(base_estimator),
    824         X,
    825         y,
    826         train=train,
    827         test=test,
    828         parameters=parameters,
    829         split_progress=(split_idx, n_splits),
    830         candidate_progress=(cand_idx, n_candidates),
    831         **fit_and_score_kwargs,
    832     )
    833     for (cand_idx, parameters), (split_idx, (train, test)) in product(
    834         enumerate(candidate_params), enumerate(cv.split(X, y, groups))
    835     )
    836 )
    838 if len(out) &lt; 1:
    839     raise ValueError(
    840         &quot;No fits were performed. &quot;
    841         &quot;Was the CV iterator empty? &quot;
    842         &quot;Were there no candidates?&quot;
    843     )

File /opt/conda/lib/python3.10/site-packages/sklearn/utils/parallel.py:63, in Parallel.__call__(self, iterable)
     58 config = get_config()
     59 iterable_with_config = (
     60     (_with_config(delayed_func, config), args, kwargs)
     61     for delayed_func, args, kwargs in iterable
     62 )
---&gt; 63 return super().__call__(iterable_with_config)

File /opt/conda/lib/python3.10/site-packages/joblib/parallel.py:2007, in Parallel.__call__(self, iterable)
   2001 # The first item from the output is blank, but it makes the interpreter
   2002 # progress until it enters the Try/Except block of the generator and
   2003 # reaches the first `yield` statement. This starts the asynchronous
   2004 # dispatch of the tasks to the workers.
   2005 next(output)
-&gt; 2007 return output if self.return_generator else list(output)

File /opt/conda/lib/python3.10/site-packages/joblib/parallel.py:1650, in Parallel._get_outputs(self, iterator, pre_dispatch)
   1647     yield
   1649     with self._backend.retrieval_context():
-&gt; 1650         yield from self._retrieve()
   1652 except GeneratorExit:
   1653     # The generator has been garbage collected before being fully
   1654     # consumed. This aborts the remaining tasks if possible and warn
   1655     # the user if necessary.
   1656     self._exception = True

File /opt/conda/lib/python3.10/site-packages/joblib/parallel.py:1762, in Parallel._retrieve(self)
   1757 # If the next job is not ready for retrieval yet, we just wait for
   1758 # async callbacks to progress.
   1759 if ((len(self._jobs) == 0) or
   1760     (self._jobs[0].get_status(
   1761         timeout=self.timeout) == TASK_PENDING)):
-&gt; 1762     time.sleep(0.01)
   1763     continue
   1765 # We need to be careful: the job list can be filling up as
   1766 # we empty it and Python list are not thread-safe by
   1767 # default hence the use of the lock

KeyboardInterrupt: 
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="87"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:07:01.320398Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:07:01.319973Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:07:01.347368Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:07:01.346029Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:07:01.320358Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb168"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_df)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>       PSA (ng/mL)  Primary Gleason  Secondary Gleason  Cancer Length (mm)  \
0             10.9              NaN                NaN                 NaN   
1             10.9              3.0                4.0                 4.0   
2             10.9              3.0                3.0                 2.0   
3             10.9              NaN                NaN                 NaN   
4             10.9              NaN                NaN                 NaN   
...            ...              ...                ...                 ...   
23492          7.1              3.0                4.0                 7.0   
23493          7.1              NaN                NaN                 NaN   
23494          7.1              NaN                NaN                 NaN   
23495          7.1              NaN                NaN                 NaN   
23496          7.1              NaN                NaN                 NaN   

       % Cancer in Core  Core Fragment #1 Tissue Length (mm)  \
0                   NaN                                 10.0   
1                  50.0                                 14.0   
2                  10.0                                 10.0   
3                   NaN                                 12.0   
4                   NaN                                 14.0   
...                 ...                                  ...   
23492              50.0                                 16.0   
23493               NaN                                 21.0   
23494               NaN                                 21.0   
23495               NaN                                 16.0   
23496               NaN                                 16.0   

       Core Fragment #2 Tissue Length (mm)  \
0                                      3.0   
1                                      NaN   
2                                      2.0   
3                                      4.0   
4                                      NaN   
...                                    ...   
23492                                  NaN   
23493                                  NaN   
23494                                  NaN   
23495                                  NaN   
23496                                  NaN   

       Core Fragment #3 Tissue Length (mm)  Bx Tip X (MRI Coord)  \
0                                      NaN                -8.915   
1                                      NaN                -5.644   
2                                      1.0                -9.642   
3                                      NaN               -11.095   
4                                      NaN               -18.001   
...                                    ...                   ...   
23492                                  NaN                -5.017   
23493                                  NaN                -2.178   
23494                                  NaN                -2.178   
23495                                  NaN                -6.153   
23496                                  NaN                -6.153   

       Bx Tip Y (MRI Coord)  ...  Bx Base Y (US Coord)  Bx Base Z (US Coord)  \
0                    34.791  ...                30.545                 8.399   
1                    23.161  ...                23.864                 2.066   
2                    22.070  ...                27.651                -2.674   
3                    30.429  ...                15.876                15.351   
4                    25.705  ...                26.813                -1.681   
...                     ...  ...                   ...                   ...   
23492                39.688  ...                 3.662                 8.061   
23493                32.305  ...                 2.287                 5.103   
23494                32.305  ...                 2.287                 5.103   
23495                34.293  ...                 5.198                 0.344   
23496                34.293  ...                 5.198                 0.344   

       Prostate Volume (CC)                Core Label  \
0                 49.141950         LEFT LATERAL BASE   
1                 49.141950          LEFT LATERAL MID   
2                 49.141950         LEFT LATERAL APEX   
3                 49.141950                 LEFT BASE   
4                 49.141950                  LEFT MID   
...                     ...                       ...   
23492             37.386039  TARGET OR PRIOR POSITIVE   
23493             37.386039  TARGET OR PRIOR POSITIVE   
23494             37.386039  TARGET OR PRIOR POSITIVE   
23495             37.386039  TARGET OR PRIOR POSITIVE   
23496             37.386039  TARGET OR PRIOR POSITIVE   

                                Series Instance UID (US)  \
0      1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
1      1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
2      1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
3      1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
4      1.3.6.1.4.1.14519.5.2.1.1403678967890026014493...   
...                                                  ...   
23492  1.3.6.1.4.1.14519.5.2.1.3288852678732554921732...   
23493  1.3.6.1.4.1.14519.5.2.1.3288852678732554921732...   
23494  1.3.6.1.4.1.14519.5.2.1.3288852678732554921732...   
23495  1.3.6.1.4.1.14519.5.2.1.3288852678732554921732...   
23496  1.3.6.1.4.1.14519.5.2.1.3288852678732554921732...   

                    Patient Number  UCLA Score (Similar to PIRADS v2)  \
0      Prostate-MRI-US-Biopsy-0001                                  3   
1      Prostate-MRI-US-Biopsy-0001                                  3   
2      Prostate-MRI-US-Biopsy-0001                                  3   
3      Prostate-MRI-US-Biopsy-0001                                  3   
4      Prostate-MRI-US-Biopsy-0001                                  3   
...                            ...                                ...   
23492  Prostate-MRI-US-Biopsy-1151                                  4   
23493  Prostate-MRI-US-Biopsy-1151                                  0   
23494  Prostate-MRI-US-Biopsy-1151                                  4   
23495  Prostate-MRI-US-Biopsy-1151                                  0   
23496  Prostate-MRI-US-Biopsy-1151                                  4   

       ROI Volume (cc)  Target No.                   Patient ID  
0             0.834323           1  Prostate-MRI-US-Biopsy-0001  
1             0.834323           1  Prostate-MRI-US-Biopsy-0001  
2             0.834323           1  Prostate-MRI-US-Biopsy-0001  
3             0.834323           1  Prostate-MRI-US-Biopsy-0001  
4             0.834323           1  Prostate-MRI-US-Biopsy-0001  
...                ...         ...                          ...  
23492         0.118855           2  Prostate-MRI-US-Biopsy-1151  
23493         0.000101           1  Prostate-MRI-US-Biopsy-1151  
23494         0.118855           2  Prostate-MRI-US-Biopsy-1151  
23495         0.000101           1  Prostate-MRI-US-Biopsy-1151  
23496         0.118855           2  Prostate-MRI-US-Biopsy-1151  

[23497 rows x 28 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="91"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:09:54.814813Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:09:54.814287Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:09:54.941273Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:09:54.940013Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:09:54.814761Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb170"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the aggregation functions</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>aggregation_functions <span class="op">=</span> {</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;PSA (ng/mL)&#39;</span>: <span class="st">&#39;mean&#39;</span>,  <span class="co"># Average PSA value per patient</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Primary Gleason&#39;</span>: <span class="st">&#39;max&#39;</span>,  <span class="co"># Highest Primary Gleason score</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Secondary Gleason&#39;</span>: <span class="st">&#39;max&#39;</span>,  <span class="co"># Highest Secondary Gleason score</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Cancer Length (mm)&#39;</span>: <span class="st">&#39;sum&#39;</span>,  <span class="co"># Total cancer length</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;% Cancer in Core&#39;</span>: <span class="st">&#39;mean&#39;</span>,  <span class="co"># Average % cancer in core</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Core Fragment #1 Tissue Length (mm)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Core Fragment #2 Tissue Length (mm)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Core Fragment #3 Tissue Length (mm)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Tip X (MRI Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Tip Y (MRI Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Tip Z (MRI Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Base X (MRI Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Base Y (MRI Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Base Z (MRI Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Tip X (US Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Tip Y (US Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Tip Z (US Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Base X (US Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Base Y (US Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bx Base Z (US Coord)&#39;</span>: <span class="st">&#39;mean&#39;</span>,</span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Prostate Volume (CC)&#39;</span>: <span class="st">&#39;mean&#39;</span>,  <span class="co"># Average prostate volume</span></span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Core Label&#39;</span>: <span class="kw">lambda</span> x: <span class="st">&#39;, &#39;</span>.join(<span class="bu">sorted</span>(<span class="bu">set</span>(x.dropna()))),  <span class="co"># Unique, sorted core labels</span></span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;UCLA Score (Similar to PIRADS v2)&#39;</span>: <span class="st">&#39;max&#39;</span>,  <span class="co"># Highest UCLA Score</span></span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;ROI Volume (cc)&#39;</span>: <span class="st">&#39;mean&#39;</span>,  <span class="co"># Average ROI volume</span></span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Target No.&#39;</span>: <span class="st">&#39;max&#39;</span>,  <span class="co"># Highest Target Number</span></span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Patient ID&#39;</span>: <span class="st">&#39;first&#39;</span>  <span class="co"># Retain first Patient ID (indexing clarity)</span></span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-31"><a href="#cb170-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply grouping and aggregation</span></span>
<span id="cb170-32"><a href="#cb170-32" aria-hidden="true" tabindex="-1"></a>combined_df_final <span class="op">=</span> (</span>
<span id="cb170-33"><a href="#cb170-33" aria-hidden="true" tabindex="-1"></a>    combined_df</span>
<span id="cb170-34"><a href="#cb170-34" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;Patient ID&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)  <span class="co"># Group by &#39;Patient ID&#39;</span></span>
<span id="cb170-35"><a href="#cb170-35" aria-hidden="true" tabindex="-1"></a>    .agg(aggregation_functions)  <span class="co"># Apply aggregation</span></span>
<span id="cb170-36"><a href="#cb170-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-37"><a href="#cb170-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-38"><a href="#cb170-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the final DataFrame</span></span>
<span id="cb170-39"><a href="#cb170-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_df_final)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>     PSA (ng/mL)  Primary Gleason  Secondary Gleason  Cancer Length (mm)  \
0      10.089474              3.0                4.0                 6.0   
1      11.884615              3.0                3.0                 1.0   
2      11.200000              NaN                NaN                 0.0   
3       5.100000              NaN                NaN                 0.0   
4      33.600000              3.0                4.0                20.0   
..           ...              ...                ...                 ...   
835     9.300000              5.0                4.0                74.0   
836     3.800000              3.0                3.0                 6.0   
837     5.100000              3.0                3.0                 2.0   
838     7.000000              4.0                4.0                36.0   
839     7.100000              3.0                4.0                15.0   

     % Cancer in Core  Core Fragment #1 Tissue Length (mm)  \
0           30.000000                            13.894737   
1            5.000000                            15.692308   
2                 NaN                            12.666667   
3                 NaN                                  NaN   
4           34.000000                            14.062500   
..                ...                                  ...   
835         45.000000                            16.142857   
836         20.000000                            11.375000   
837          5.000000                            14.000000   
838         21.428571                            14.176471   
839         27.500000                            12.533333   

     Core Fragment #2 Tissue Length (mm)  Core Fragment #3 Tissue Length (mm)  \
0                               3.555556                                  1.5   
1                               3.857143                                  NaN   
2                               3.571429                                  2.0   
3                                    NaN                                  NaN   
4                               2.200000                                  1.0   
..                                   ...                                  ...   
835                             2.000000                                  NaN   
836                             3.666667                                  NaN   
837                             5.400000                                  NaN   
838                                  NaN                                  NaN   
839                             2.750000                                  NaN   

     Bx Tip X (MRI Coord)  Bx Tip Y (MRI Coord)  ...  Bx Tip Z (US Coord)  \
0              -24.025842             22.338263  ...            -3.107316   
1              -30.982538              4.731077  ...            -3.421000   
2              -12.410611             16.445556  ...             1.294833   
3               11.921576             26.330700  ...            -3.163089   
4               10.773687             21.007812  ...           -10.511750   
..                    ...                   ...  ...                  ...   
835             20.821714              9.144571  ...            -3.195429   
836            -33.787250             27.149750  ...             3.206813   
837              8.391063              5.936250  ...            -0.920125   
838              5.829412             39.603176  ...             3.900059   
839              8.649467             33.857667  ...             3.832133   

     Bx Base X (US Coord)  Bx Base Y (US Coord)  Bx Base Z (US Coord)  \
0                1.679000             21.145895             -2.296105   
1               -3.091538             11.144923             -3.512846   
2                4.692778              8.809000              0.623611   
3                6.914499             17.142017             -2.972558   
4               10.540563             22.438063             -7.177688   
..                    ...                   ...                   ...   
835              2.889071             15.201000             -3.353286   
836             -1.321500             13.704000              0.406562   
837              4.430187             13.923000             -0.481063   
838              3.570412             19.445647              2.474118   
839              0.892933             13.028067              2.747667   

     Prostate Volume (CC)                                         Core Label  \
0               49.141950  LEFT APEX, LEFT BASE, LEFT LATERAL APEX, LEFT ...   
1               34.775604  LEFT BASE, LEFT LATERAL BASE, LEFT LATERAL MID...   
2               95.207426  LEFT APEX, LEFT BASE, LEFT LATERAL APEX, LEFT ...   
3               28.279691  LEFT BASE, LEFT LATERAL APEX, LEFT LATERAL BAS...   
4               34.019048  LEFT APEX, LEFT BASE, LEFT LATERAL APEX, LEFT ...   
..                    ...                                                ...   
835             34.079822  RIGHT LATERAL BASE, RIGHT LATERAL MID, RIGHT M...   
836             28.597822  LEFT APEX, LEFT BASE, LEFT LATERAL APEX, LEFT ...   
837             75.857524  LEFT APEX, LEFT BASE, LEFT LATERAL APEX, LEFT ...   
838             51.879430  LEFT APEX, LEFT LATERAL APEX, LEFT LATERAL MID...   
839             37.386039  LEFT APEX, LEFT BASE, LEFT LATERAL APEX, LEFT ...   

     UCLA Score (Similar to PIRADS v2)  ROI Volume (cc)  Target No.  \
0                                    3         0.834323           1   
1                                    3         0.364729           1   
2                                    3         0.884436           1   
3                                    3         1.895011           1   
4                                    5         0.665917           1   
..                                 ...              ...         ...   
835                                  5         1.918892           2   
836                                  4         0.313711           1   
837                                  3         0.422378           1   
838                                  4         0.446894           2   
839                                  4         0.059478           2   

                      Patient ID  
0    Prostate-MRI-US-Biopsy-0001  
1    Prostate-MRI-US-Biopsy-0002  
2    Prostate-MRI-US-Biopsy-0003  
3    Prostate-MRI-US-Biopsy-0005  
4    Prostate-MRI-US-Biopsy-0006  
..                           ...  
835  Prostate-MRI-US-Biopsy-1146  
836  Prostate-MRI-US-Biopsy-1148  
837  Prostate-MRI-US-Biopsy-1149  
838  Prostate-MRI-US-Biopsy-1150  
839  Prostate-MRI-US-Biopsy-1151  

[840 rows x 26 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="92"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:16:49.987766Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:16:49.987228Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:16:50.006287Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:16:50.004894Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:16:49.987724Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb172"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MultiLabelBinarizer</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Split &#39;Core Label&#39; into lists of labels</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>core_label_lists <span class="op">=</span> combined_df_final[<span class="st">&#39;Core Label&#39;</span>].<span class="bu">str</span>.split(<span class="st">&#39;, &#39;</span>)</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply MultiLabelBinarizer</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>mlb <span class="op">=</span> MultiLabelBinarizer()</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>core_label_encoded <span class="op">=</span> pd.DataFrame(mlb.fit_transform(core_label_lists), columns<span class="op">=</span>mlb.classes_)</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate the binarized labels with the original DataFrame</span></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>combined_df_final <span class="op">=</span> pd.concat([combined_df_final.reset_index(drop<span class="op">=</span><span class="va">True</span>), core_label_encoded], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the original &#39;Core Label&#39; column</span></span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>combined_df_final.drop(columns<span class="op">=</span>[<span class="st">&#39;Core Label&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;MultiLabelBinarized &#39;Core Label&#39; and removed the original column.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>MultiLabelBinarized &#39;Core Label&#39; and removed the original column.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="93"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:17:04.036615Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:17:04.036196Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:17:04.052434Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:17:04.051204Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:17:04.036578Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb174"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_df_final)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>     PSA (ng/mL)  Primary Gleason  Secondary Gleason  Cancer Length (mm)  \
0      10.089474              3.0                4.0                 6.0   
1      11.884615              3.0                3.0                 1.0   
2      11.200000              NaN                NaN                 0.0   
3       5.100000              NaN                NaN                 0.0   
4      33.600000              3.0                4.0                20.0   
..           ...              ...                ...                 ...   
835     9.300000              5.0                4.0                74.0   
836     3.800000              3.0                3.0                 6.0   
837     5.100000              3.0                3.0                 2.0   
838     7.000000              4.0                4.0                36.0   
839     7.100000              3.0                4.0                15.0   

     % Cancer in Core  Core Fragment #1 Tissue Length (mm)  \
0           30.000000                            13.894737   
1            5.000000                            15.692308   
2                 NaN                            12.666667   
3                 NaN                                  NaN   
4           34.000000                            14.062500   
..                ...                                  ...   
835         45.000000                            16.142857   
836         20.000000                            11.375000   
837          5.000000                            14.000000   
838         21.428571                            14.176471   
839         27.500000                            12.533333   

     Core Fragment #2 Tissue Length (mm)  Core Fragment #3 Tissue Length (mm)  \
0                               3.555556                                  1.5   
1                               3.857143                                  NaN   
2                               3.571429                                  2.0   
3                                    NaN                                  NaN   
4                               2.200000                                  1.0   
..                                   ...                                  ...   
835                             2.000000                                  NaN   
836                             3.666667                                  NaN   
837                             5.400000                                  NaN   
838                                  NaN                                  NaN   
839                             2.750000                                  NaN   

     Bx Tip X (MRI Coord)  Bx Tip Y (MRI Coord)  ...  LEFT LATERAL BASE  \
0              -24.025842             22.338263  ...                  1   
1              -30.982538              4.731077  ...                  1   
2              -12.410611             16.445556  ...                  1   
3               11.921576             26.330700  ...                  1   
4               10.773687             21.007812  ...                  1   
..                    ...                   ...  ...                ...   
835             20.821714              9.144571  ...                  0   
836            -33.787250             27.149750  ...                  1   
837              8.391063              5.936250  ...                  0   
838              5.829412             39.603176  ...                  0   
839              8.649467             33.857667  ...                  1   

     LEFT LATERAL MID  LEFT MID  RIGHT APEX  RIGHT BASE  RIGHT LATERAL APEX  \
0                   1         1           1           1                   1   
1                   1         0           0           0                   0   
2                   1         1           1           1                   1   
3                   1         1           1           1                   1   
4                   1         1           1           0                   1   
..                ...       ...         ...         ...                 ...   
835                 0         0           0           0                   0   
836                 1         1           1           1                   0   
837                 1         1           1           1                   1   
838                 1         1           1           1                   0   
839                 1         1           1           1                   1   

     RIGHT LATERAL BASE  RIGHT LATERAL MID  RIGHT MID  \
0                     1                  1          1   
1                     0                  0          0   
2                     1                  1          1   
3                     1                  1          1   
4                     0                  1          1   
..                  ...                ...        ...   
835                   1                  1          1   
836                   1                  1          1   
837                   1                  1          1   
838                   0                  0          0   
839                   1                  0          1   

     TARGET OR PRIOR POSITIVE  
0                           1  
1                           1  
2                           1  
3                           1  
4                           1  
..                        ...  
835                         1  
836                         1  
837                         1  
838                         1  
839                         1  

[840 rows x 39 columns]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="96"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:18:16.411600Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:18:16.411191Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:18:16.418958Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:18:16.417772Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:18:16.411563Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb176"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the &#39;Patient ID&#39; column</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>combined_df_final.drop(columns<span class="op">=</span>[<span class="st">&#39;Patient ID&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Dropped &#39;Patient ID&#39; column.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Dropped &#39;Patient ID&#39; column.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="97"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:18:44.055068Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:18:44.054153Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:18:44.061122Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:18:44.059674Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:18:44.055019Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb178"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(combined_df_final.columns)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Index([&#39;PSA (ng/mL)&#39;, &#39;Primary Gleason&#39;, &#39;Secondary Gleason&#39;,
       &#39;Cancer Length (mm)&#39;, &#39;% Cancer in Core&#39;,
       &#39;Core Fragment #1 Tissue Length (mm)&#39;,
       &#39;Core Fragment #2 Tissue Length (mm)&#39;,
       &#39;Core Fragment #3 Tissue Length (mm)&#39;, &#39;Bx Tip X (MRI Coord)&#39;,
       &#39;Bx Tip Y (MRI Coord)&#39;, &#39;Bx Tip Z (MRI Coord)&#39;, &#39;Bx Base X (MRI Coord)&#39;,
       &#39;Bx Base Y (MRI Coord)&#39;, &#39;Bx Base Z (MRI Coord)&#39;, &#39;Bx Tip X (US Coord)&#39;,
       &#39;Bx Tip Y (US Coord)&#39;, &#39;Bx Tip Z (US Coord)&#39;, &#39;Bx Base X (US Coord)&#39;,
       &#39;Bx Base Y (US Coord)&#39;, &#39;Bx Base Z (US Coord)&#39;, &#39;Prostate Volume (CC)&#39;,
       &#39;UCLA Score (Similar to PIRADS v2)&#39;, &#39;ROI Volume (cc)&#39;, &#39;Target No.&#39;,
       &#39;EXTRA&#39;, &#39;LEFT APEX&#39;, &#39;LEFT BASE&#39;, &#39;LEFT LATERAL APEX&#39;,
       &#39;LEFT LATERAL BASE&#39;, &#39;LEFT LATERAL MID&#39;, &#39;LEFT MID&#39;, &#39;RIGHT APEX&#39;,
       &#39;RIGHT BASE&#39;, &#39;RIGHT LATERAL APEX&#39;, &#39;RIGHT LATERAL BASE&#39;,
       &#39;RIGHT LATERAL MID&#39;, &#39;RIGHT MID&#39;, &#39;TARGET OR PRIOR POSITIVE&#39;],
      dtype=&#39;object&#39;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="98"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:19:07.938844Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:19:07.937684Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:19:07.945274Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:19:07.944041Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:19:07.938793Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb180"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute missing values with 0</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>combined_df_final.fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Replaced all NaN values with 0.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Replaced all NaN values with 0.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="99"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:19:20.303115Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:19:20.302632Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:19:20.325691Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:19:20.324541Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:19:20.303068Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb182"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>combined_df_final.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="99">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PSA (ng/mL)</th>
      <th>Primary Gleason</th>
      <th>Secondary Gleason</th>
      <th>Cancer Length (mm)</th>
      <th>% Cancer in Core</th>
      <th>Core Fragment #1 Tissue Length (mm)</th>
      <th>Core Fragment #2 Tissue Length (mm)</th>
      <th>Core Fragment #3 Tissue Length (mm)</th>
      <th>Bx Tip X (MRI Coord)</th>
      <th>Bx Tip Y (MRI Coord)</th>
      <th>...</th>
      <th>LEFT LATERAL BASE</th>
      <th>LEFT LATERAL MID</th>
      <th>LEFT MID</th>
      <th>RIGHT APEX</th>
      <th>RIGHT BASE</th>
      <th>RIGHT LATERAL APEX</th>
      <th>RIGHT LATERAL BASE</th>
      <th>RIGHT LATERAL MID</th>
      <th>RIGHT MID</th>
      <th>TARGET OR PRIOR POSITIVE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10.089474</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>30.0</td>
      <td>13.894737</td>
      <td>3.555556</td>
      <td>1.5</td>
      <td>-24.025842</td>
      <td>22.338263</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.884615</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>15.692308</td>
      <td>3.857143</td>
      <td>0.0</td>
      <td>-30.982538</td>
      <td>4.731077</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11.200000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.666667</td>
      <td>3.571429</td>
      <td>2.0</td>
      <td>-12.410611</td>
      <td>16.445556</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.100000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>11.921576</td>
      <td>26.330700</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>33.600000</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>20.0</td>
      <td>34.0</td>
      <td>14.062500</td>
      <td>2.200000</td>
      <td>1.0</td>
      <td>10.773687</td>
      <td>21.007812</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 38 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="100"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:20:06.311573Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:20:06.310601Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:20:06.328927Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:20:06.327455Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:20:06.311528Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb183"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate features and target (assuming &#39;Target&#39; is your target column)</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> combined_df_final.drop(columns<span class="op">=</span>[<span class="st">&#39;UCLA Score (Similar to PIRADS v2)&#39;</span>])  <span class="co"># Adjust target column name if different</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> combined_df_final[<span class="st">&#39;UCLA Score (Similar to PIRADS v2)&#39;</span>]</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale the feature data</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Scaled the feature data.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Scaled the feature data.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="101"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:20:17.517525Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:20:17.517088Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:20:17.527088Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:20:17.525965Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:20:17.517486Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb185"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the train-test split</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Train and test data shapes:&quot;</span>)</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;X_train: </span><span class="sc">{</span>X_train<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, X_test: </span><span class="sc">{</span>X_test<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;y_train: </span><span class="sc">{</span>y_train<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, y_test: </span><span class="sc">{</span>y_test<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Train and test data shapes:
X_train: (672, 37), X_test: (168, 37)
y_train: (672,), y_test: (168,)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="103"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:24:01.759557Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:24:01.759086Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:24:01.888685Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:24:01.886514Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:24:01.759519Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb187"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co">#start training models</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Logistic Regression model (multiclass)</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>log_reg <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>, multi_class<span class="op">=</span><span class="st">&#39;ovr&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>log_reg.fit(X_train, y_train)</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions and evaluation</span></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>y_pred_log_reg <span class="op">=</span> log_reg.predict(X_test)</span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>accuracy_log_reg <span class="op">=</span> accuracy_score(y_test, y_pred_log_reg)</span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Logistic Regression:&quot;</span>)</span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Accuracy: </span><span class="sc">{</span>accuracy_log_reg<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Classification Report:</span><span class="ch">\n</span><span class="sc">{</span>classification_report(y_test, y_pred_log_reg)<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Logistic Regression:
Accuracy: 0.5416666666666666
Classification Report:
              precision    recall  f1-score   support

           0       0.00      0.00      0.00         1
           1       0.00      0.00      0.00         0
           3       0.46      0.69      0.55        51
           4       0.56      0.34      0.42        70
           5       0.67      0.70      0.68        46

    accuracy                           0.54       168
   macro avg       0.34      0.34      0.33       168
weighted avg       0.55      0.54      0.53       168

</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="105"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:24:40.364669Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:24:40.364247Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:24:40.399750Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:24:40.398746Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:24:40.364632Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb190"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Decision Tree Classifier model (multiclass)</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>dt.fit(X_train, y_train)</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions and evaluation</span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>y_pred_dt <span class="op">=</span> dt.predict(X_test)</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>accuracy_dt <span class="op">=</span> accuracy_score(y_test, y_pred_dt)</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Decision Tree Classifier:&quot;</span>)</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Accuracy: </span><span class="sc">{</span>accuracy_dt<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Classification Report:</span><span class="ch">\n</span><span class="sc">{</span>classification_report(y_test, y_pred_dt)<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Decision Tree Classifier:
Accuracy: 0.4880952380952381
Classification Report:
              precision    recall  f1-score   support

           0       0.00      0.00      0.00         1
           1       0.00      0.00      0.00         0
           3       0.47      0.45      0.46        51
           4       0.49      0.47      0.48        70
           5       0.53      0.57      0.55        46

    accuracy                           0.49       168
   macro avg       0.30      0.30      0.30       168
weighted avg       0.49      0.49      0.49       168

</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Recall and F-score are ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="106"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:24:56.459204Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:24:56.457756Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:24:56.793420Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:24:56.792232Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:24:56.459155Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb193"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest Classifier model (multiclass)</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>rf <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>, n_estimators<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>rf.fit(X_train, y_train)</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions and evaluation</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>y_pred_rf <span class="op">=</span> rf.predict(X_test)</span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>accuracy_rf <span class="op">=</span> accuracy_score(y_test, y_pred_rf)</span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Random Forest Classifier:&quot;</span>)</span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Accuracy: </span><span class="sc">{</span>accuracy_rf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Classification Report:</span><span class="ch">\n</span><span class="sc">{</span>classification_report(y_test, y_pred_rf)<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Random Forest Classifier:
Accuracy: 0.5595238095238095
Classification Report:
              precision    recall  f1-score   support

           0       0.00      0.00      0.00         1
           3       0.49      0.69      0.57        51
           4       0.54      0.39      0.45        70
           5       0.68      0.70      0.69        46

    accuracy                           0.56       168
   macro avg       0.43      0.44      0.43       168
weighted avg       0.56      0.56      0.55       168

</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="119"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:46:25.422298Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:46:25.421896Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:46:28.996722Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:46:28.995360Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:46:25.422266Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb196"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier, GradientBoostingClassifier</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define models (including additional classifiers)</span></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {</span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Logistic Regression&#39;</span>: LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>),</span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Decision Tree&#39;</span>: DecisionTreeClassifier(),</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Random Forest&#39;</span>: RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Support Vector Classifier&#39;</span>: SVC(),</span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;K-Nearest Neighbors&#39;</span>: KNeighborsClassifier(),</span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Gradient Boosting Classifier&#39;</span>: GradientBoostingClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Naive Bayes&#39;</span>: GaussianNB()</span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to train and evaluate models without PCA</span></span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_analysis(X_train, X_test, y_train, y_test):</span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> {}</span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train and evaluate each model</span></span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> model_name, model <span class="kw">in</span> models.items():</span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Train the model</span></span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a>        model.fit(X_train, y_train)</span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Make predictions</span></span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Evaluate accuracy</span></span>
<span id="cb196-36"><a href="#cb196-36" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb196-37"><a href="#cb196-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true" tabindex="-1"></a>        results[model_name] <span class="op">=</span> accuracy</span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb196-40"><a href="#cb196-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb196-41"><a href="#cb196-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-42"><a href="#cb196-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform model analysis without PCA</span></span>
<span id="cb196-43"><a href="#cb196-43" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model_analysis(X_train, X_test, y_train, y_test)</span>
<span id="cb196-44"><a href="#cb196-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-45"><a href="#cb196-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb196-46"><a href="#cb196-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> model_name, accuracy <span class="kw">in</span> results.items():</span>
<span id="cb196-47"><a href="#cb196-47" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>accuracy<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Logistic Regression: 0.5417
Decision Tree: 0.5060
Random Forest: 0.6012
Support Vector Classifier: 0.4881
K-Nearest Neighbors: 0.5000
Gradient Boosting Classifier: 0.5476
Naive Bayes: 0.3036
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="118"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:45:34.252550Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:45:34.252093Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:46:03.172846Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:46:03.171619Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:45:34.252510Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb198"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier, GradientBoostingClassifier</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Define models (including additional classifiers)</span></span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {</span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Logistic Regression&#39;</span>: LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>),</span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Decision Tree&#39;</span>: DecisionTreeClassifier(),</span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Random Forest&#39;</span>: RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Support Vector Classifier&#39;</span>: SVC(),</span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;K-Nearest Neighbors&#39;</span>: KNeighborsClassifier(),</span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Gradient Boosting Classifier&#39;</span>: GradientBoostingClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Naive Bayes&#39;</span>: GaussianNB()</span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to perform PCA and evaluate the model</span></span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pca_analysis(n_components_list, X_train, X_test, y_train, y_test):</span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> {}</span>
<span id="cb198-27"><a href="#cb198-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb198-28"><a href="#cb198-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n_components <span class="kw">in</span> n_components_list:</span>
<span id="cb198-29"><a href="#cb198-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Apply PCA</span></span>
<span id="cb198-30"><a href="#cb198-30" aria-hidden="true" tabindex="-1"></a>        pca <span class="op">=</span> PCA(n_components<span class="op">=</span>n_components)</span>
<span id="cb198-31"><a href="#cb198-31" aria-hidden="true" tabindex="-1"></a>        X_train_pca <span class="op">=</span> pca.fit_transform(X_train)</span>
<span id="cb198-32"><a href="#cb198-32" aria-hidden="true" tabindex="-1"></a>        X_test_pca <span class="op">=</span> pca.transform(X_test)</span>
<span id="cb198-33"><a href="#cb198-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb198-34"><a href="#cb198-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Train and evaluate each model</span></span>
<span id="cb198-35"><a href="#cb198-35" aria-hidden="true" tabindex="-1"></a>        model_results <span class="op">=</span> {}</span>
<span id="cb198-36"><a href="#cb198-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> model_name, model <span class="kw">in</span> models.items():</span>
<span id="cb198-37"><a href="#cb198-37" aria-hidden="true" tabindex="-1"></a>            model.fit(X_train_pca, y_train)</span>
<span id="cb198-38"><a href="#cb198-38" aria-hidden="true" tabindex="-1"></a>            y_pred <span class="op">=</span> model.predict(X_test_pca)</span>
<span id="cb198-39"><a href="#cb198-39" aria-hidden="true" tabindex="-1"></a>            accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb198-40"><a href="#cb198-40" aria-hidden="true" tabindex="-1"></a>            model_results[model_name] <span class="op">=</span> accuracy</span>
<span id="cb198-41"><a href="#cb198-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb198-42"><a href="#cb198-42" aria-hidden="true" tabindex="-1"></a>        results[n_components] <span class="op">=</span> model_results</span>
<span id="cb198-43"><a href="#cb198-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb198-44"><a href="#cb198-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb198-45"><a href="#cb198-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-46"><a href="#cb198-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the number of components to test (e.g., 3, 4, 6, 7, 8, etc.)</span></span>
<span id="cb198-47"><a href="#cb198-47" aria-hidden="true" tabindex="-1"></a>n_components_list <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span> , <span class="dv">9</span> , <span class="dv">10</span> , <span class="dv">11</span> , <span class="dv">12</span> , <span class="dv">13</span> , <span class="dv">14</span> , <span class="dv">15</span>]</span>
<span id="cb198-48"><a href="#cb198-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-49"><a href="#cb198-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA analysis</span></span>
<span id="cb198-50"><a href="#cb198-50" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pca_analysis(n_components_list, X_train, X_test, y_train, y_test)</span>
<span id="cb198-51"><a href="#cb198-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-52"><a href="#cb198-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb198-53"><a href="#cb198-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n_components, model_results <span class="kw">in</span> results.items():</span>
<span id="cb198-54"><a href="#cb198-54" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Number of PCA components: </span><span class="sc">{</span>n_components<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb198-55"><a href="#cb198-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> model_name, accuracy <span class="kw">in</span> model_results.items():</span>
<span id="cb198-56"><a href="#cb198-56" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;  </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>accuracy<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb198-57"><a href="#cb198-57" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;-&quot;</span> <span class="op">*</span> <span class="dv">40</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of PCA components: 2
  Logistic Regression: 0.4107
  Decision Tree: 0.3929
  Random Forest: 0.4405
  Support Vector Classifier: 0.4762
  K-Nearest Neighbors: 0.4345
  Gradient Boosting Classifier: 0.4405
  Naive Bayes: 0.4762
----------------------------------------
Number of PCA components: 3
  Logistic Regression: 0.5774
  Decision Tree: 0.4881
  Random Forest: 0.5298
  Support Vector Classifier: 0.5536
  K-Nearest Neighbors: 0.5000
  Gradient Boosting Classifier: 0.5119
  Naive Bayes: 0.5179
----------------------------------------
Number of PCA components: 4
  Logistic Regression: 0.5714
  Decision Tree: 0.4107
  Random Forest: 0.5179
  Support Vector Classifier: 0.5357
  K-Nearest Neighbors: 0.4643
  Gradient Boosting Classifier: 0.5060
  Naive Bayes: 0.5476
----------------------------------------
Number of PCA components: 6
  Logistic Regression: 0.6012
  Decision Tree: 0.4821
  Random Forest: 0.5595
  Support Vector Classifier: 0.5536
  K-Nearest Neighbors: 0.4940
  Gradient Boosting Classifier: 0.5179
  Naive Bayes: 0.5952
----------------------------------------
Number of PCA components: 7
  Logistic Regression: 0.6071
  Decision Tree: 0.4821
  Random Forest: 0.5536
  Support Vector Classifier: 0.5774
  K-Nearest Neighbors: 0.4762
  Gradient Boosting Classifier: 0.5476
  Naive Bayes: 0.4881
----------------------------------------
Number of PCA components: 8
  Logistic Regression: 0.5893
  Decision Tree: 0.4524
  Random Forest: 0.5714
  Support Vector Classifier: 0.5655
  K-Nearest Neighbors: 0.4940
  Gradient Boosting Classifier: 0.5357
  Naive Bayes: 0.4940
----------------------------------------
Number of PCA components: 9
  Logistic Regression: 0.5417
  Decision Tree: 0.4524
  Random Forest: 0.5119
  Support Vector Classifier: 0.5536
  K-Nearest Neighbors: 0.4762
  Gradient Boosting Classifier: 0.5476
  Naive Bayes: 0.4524
----------------------------------------
Number of PCA components: 10
  Logistic Regression: 0.5417
  Decision Tree: 0.4762
  Random Forest: 0.5119
  Support Vector Classifier: 0.5476
  K-Nearest Neighbors: 0.4881
  Gradient Boosting Classifier: 0.5417
  Naive Bayes: 0.4405
----------------------------------------
Number of PCA components: 11
  Logistic Regression: 0.5417
  Decision Tree: 0.4702
  Random Forest: 0.5238
  Support Vector Classifier: 0.5417
  K-Nearest Neighbors: 0.4583
  Gradient Boosting Classifier: 0.5417
  Naive Bayes: 0.4167
----------------------------------------
Number of PCA components: 12
  Logistic Regression: 0.5536
  Decision Tree: 0.4762
  Random Forest: 0.5298
  Support Vector Classifier: 0.5595
  K-Nearest Neighbors: 0.4524
  Gradient Boosting Classifier: 0.5476
  Naive Bayes: 0.3988
----------------------------------------
Number of PCA components: 13
  Logistic Regression: 0.5536
  Decision Tree: 0.4107
  Random Forest: 0.5119
  Support Vector Classifier: 0.5536
  K-Nearest Neighbors: 0.4286
  Gradient Boosting Classifier: 0.5357
  Naive Bayes: 0.4048
----------------------------------------
Number of PCA components: 14
  Logistic Regression: 0.5536
  Decision Tree: 0.4583
  Random Forest: 0.5417
  Support Vector Classifier: 0.5595
  K-Nearest Neighbors: 0.4643
  Gradient Boosting Classifier: 0.5298
  Naive Bayes: 0.4048
----------------------------------------
Number of PCA components: 15
  Logistic Regression: 0.5774
  Decision Tree: 0.4762
  Random Forest: 0.5536
  Support Vector Classifier: 0.5417
  K-Nearest Neighbors: 0.4821
  Gradient Boosting Classifier: 0.5060
  Naive Bayes: 0.4048
----------------------------------------
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="120"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:49:59.812989Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:49:59.811543Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:50:11.976520Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:50:11.975208Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:49:59.812938Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb200"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score , mean_absolute_error</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Models to train</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear Regression&quot;</span>: LinearRegression(),</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Decision Tree Regression&quot;</span>: DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Random Forest Regression&quot;</span>: RandomForestRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Support Vector Regression&quot;</span>: SVR(),</span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;K-Nearest Neighbors Regression&quot;</span>: KNeighborsRegressor(),</span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Gradient Boosting Regression&quot;</span>: GradientBoostingRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through PCA components (2 to 9)</span></span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n_components <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">16</span>):</span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Training with </span><span class="sc">{</span>n_components<span class="sc">}</span><span class="ss"> PCA components...&quot;</span>)</span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply PCA for dimensionality reduction</span></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a>    pca <span class="op">=</span> PCA(n_components<span class="op">=</span>n_components)</span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a>    X_train_pca <span class="op">=</span> pca.fit_transform(X_train)</span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a>    X_test_pca <span class="op">=</span> pca.transform(X_test)</span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluate each model</span></span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> model_name, model <span class="kw">in</span> models.items():</span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Train the model</span></span>
<span id="cb200-28"><a href="#cb200-28" aria-hidden="true" tabindex="-1"></a>        model.fit(X_train_pca, y_train)</span>
<span id="cb200-29"><a href="#cb200-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-30"><a href="#cb200-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Make predictions</span></span>
<span id="cb200-31"><a href="#cb200-31" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> model.predict(X_test_pca)</span>
<span id="cb200-32"><a href="#cb200-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-33"><a href="#cb200-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Evaluate performance</span></span>
<span id="cb200-34"><a href="#cb200-34" aria-hidden="true" tabindex="-1"></a>        mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb200-35"><a href="#cb200-35" aria-hidden="true" tabindex="-1"></a>        mae <span class="op">=</span> mean_absolute_error(y_test, y_pred)</span>
<span id="cb200-36"><a href="#cb200-36" aria-hidden="true" tabindex="-1"></a>        r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb200-37"><a href="#cb200-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-38"><a href="#cb200-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the results</span></span>
<span id="cb200-39"><a href="#cb200-39" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss"> - PCA </span><span class="sc">{</span>n_components<span class="sc">}</span><span class="ss"> components:&quot;</span>)</span>
<span id="cb200-40"><a href="#cb200-40" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;  MSE: </span><span class="sc">{</span>mse<span class="sc">:.4f}</span><span class="ss">, MAE: </span><span class="sc">{</span>mae<span class="sc">:.4f}</span><span class="ss">, R2: </span><span class="sc">{</span>r2<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb200-41"><a href="#cb200-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;-&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Training with 2 PCA components...
Linear Regression - PCA 2 components:
  MSE: 0.6492, MAE: 0.6459, R2: 0.0306
Decision Tree Regression - PCA 2 components:
  MSE: 1.2321, MAE: 0.7083, R2: -0.8397
Random Forest Regression - PCA 2 components:
  MSE: 0.7204, MAE: 0.6554, R2: -0.0756
Support Vector Regression - PCA 2 components:
  MSE: 0.5620, MAE: 0.6001, R2: 0.1609
K-Nearest Neighbors Regression - PCA 2 components:
  MSE: 0.7764, MAE: 0.6821, R2: -0.1593
Gradient Boosting Regression - PCA 2 components:
  MSE: 0.6369, MAE: 0.6379, R2: 0.0491
--------------------------------------------------
Training with 3 PCA components...
Linear Regression - PCA 3 components:
  MSE: 0.5264, MAE: 0.5536, R2: 0.2141
Decision Tree Regression - PCA 3 components:
  MSE: 1.1369, MAE: 0.6964, R2: -0.6975
Random Forest Regression - PCA 3 components:
  MSE: 0.6650, MAE: 0.6125, R2: 0.0071
Support Vector Regression - PCA 3 components:
  MSE: 0.5007, MAE: 0.5451, R2: 0.2524
K-Nearest Neighbors Regression - PCA 3 components:
  MSE: 0.6936, MAE: 0.6417, R2: -0.0356
Gradient Boosting Regression - PCA 3 components:
  MSE: 0.5752, MAE: 0.5921, R2: 0.1411
--------------------------------------------------
Training with 4 PCA components...
Linear Regression - PCA 4 components:
  MSE: 0.5263, MAE: 0.5537, R2: 0.2142
Decision Tree Regression - PCA 4 components:
  MSE: 1.2619, MAE: 0.7381, R2: -0.8841
Random Forest Regression - PCA 4 components:
  MSE: 0.5748, MAE: 0.5915, R2: 0.1418
Support Vector Regression - PCA 4 components:
  MSE: 0.4875, MAE: 0.5418, R2: 0.2722
K-Nearest Neighbors Regression - PCA 4 components:
  MSE: 0.6038, MAE: 0.6048, R2: 0.0985
Gradient Boosting Regression - PCA 4 components:
  MSE: 0.5428, MAE: 0.5915, R2: 0.1896
--------------------------------------------------
Training with 5 PCA components...
Linear Regression - PCA 5 components:
  MSE: 0.5075, MAE: 0.5428, R2: 0.2422
Decision Tree Regression - PCA 5 components:
  MSE: 0.9048, MAE: 0.6190, R2: -0.3509
Random Forest Regression - PCA 5 components:
  MSE: 0.5190, MAE: 0.5702, R2: 0.2250
Support Vector Regression - PCA 5 components:
  MSE: 0.4668, MAE: 0.5299, R2: 0.3030
K-Nearest Neighbors Regression - PCA 5 components:
  MSE: 0.6367, MAE: 0.6262, R2: 0.0494
Gradient Boosting Regression - PCA 5 components:
  MSE: 0.4929, MAE: 0.5668, R2: 0.2640
--------------------------------------------------
Training with 6 PCA components...
Linear Regression - PCA 6 components:
  MSE: 0.5035, MAE: 0.5398, R2: 0.2482
Decision Tree Regression - PCA 6 components:
  MSE: 1.0179, MAE: 0.7083, R2: -0.5198
Random Forest Regression - PCA 6 components:
  MSE: 0.5019, MAE: 0.5693, R2: 0.2507
Support Vector Regression - PCA 6 components:
  MSE: 0.4609, MAE: 0.5209, R2: 0.3118
K-Nearest Neighbors Regression - PCA 6 components:
  MSE: 0.6007, MAE: 0.5893, R2: 0.1031
Gradient Boosting Regression - PCA 6 components:
  MSE: 0.4930, MAE: 0.5632, R2: 0.2640
--------------------------------------------------
Training with 7 PCA components...
Linear Regression - PCA 7 components:
  MSE: 0.5198, MAE: 0.5494, R2: 0.2239
Decision Tree Regression - PCA 7 components:
  MSE: 1.1607, MAE: 0.7202, R2: -0.7331
Random Forest Regression - PCA 7 components:
  MSE: 0.4982, MAE: 0.5501, R2: 0.2561
Support Vector Regression - PCA 7 components:
  MSE: 0.4396, MAE: 0.5082, R2: 0.3437
K-Nearest Neighbors Regression - PCA 7 components:
  MSE: 0.6112, MAE: 0.5893, R2: 0.0874
Gradient Boosting Regression - PCA 7 components:
  MSE: 0.4820, MAE: 0.5522, R2: 0.2803
--------------------------------------------------
Training with 8 PCA components...
Linear Regression - PCA 8 components:
  MSE: 0.5218, MAE: 0.5516, R2: 0.2210
Decision Tree Regression - PCA 8 components:
  MSE: 1.4762, MAE: 0.8095, R2: -1.2041
Random Forest Regression - PCA 8 components:
  MSE: 0.5015, MAE: 0.5614, R2: 0.2512
Support Vector Regression - PCA 8 components:
  MSE: 0.4382, MAE: 0.5124, R2: 0.3458
K-Nearest Neighbors Regression - PCA 8 components:
  MSE: 0.5874, MAE: 0.5774, R2: 0.1230
Gradient Boosting Regression - PCA 8 components:
  MSE: 0.4662, MAE: 0.5474, R2: 0.3039
--------------------------------------------------
Training with 9 PCA components...
Linear Regression - PCA 9 components:
  MSE: 0.5209, MAE: 0.5544, R2: 0.2222
Decision Tree Regression - PCA 9 components:
  MSE: 1.0952, MAE: 0.7262, R2: -0.6353
Random Forest Regression - PCA 9 components:
  MSE: 0.4973, MAE: 0.5549, R2: 0.2575
Support Vector Regression - PCA 9 components:
  MSE: 0.4368, MAE: 0.5126, R2: 0.3478
K-Nearest Neighbors Regression - PCA 9 components:
  MSE: 0.5690, MAE: 0.5690, R2: 0.1504
Gradient Boosting Regression - PCA 9 components:
  MSE: 0.4787, MAE: 0.5532, R2: 0.2852
--------------------------------------------------
Training with 10 PCA components...
Linear Regression - PCA 10 components:
  MSE: 0.5234, MAE: 0.5567, R2: 0.2185
Decision Tree Regression - PCA 10 components:
  MSE: 0.8571, MAE: 0.5952, R2: -0.2798
Random Forest Regression - PCA 10 components:
  MSE: 0.4999, MAE: 0.5583, R2: 0.2536
Support Vector Regression - PCA 10 components:
  MSE: 0.4496, MAE: 0.5184, R2: 0.3287
K-Nearest Neighbors Regression - PCA 10 components:
  MSE: 0.5621, MAE: 0.5631, R2: 0.1607
Gradient Boosting Regression - PCA 10 components:
  MSE: 0.4738, MAE: 0.5531, R2: 0.2925
--------------------------------------------------
Training with 11 PCA components...
Linear Regression - PCA 11 components:
  MSE: 0.5142, MAE: 0.5512, R2: 0.2323
Decision Tree Regression - PCA 11 components:
  MSE: 1.0417, MAE: 0.6845, R2: -0.5553
Random Forest Regression - PCA 11 components:
  MSE: 0.5028, MAE: 0.5608, R2: 0.2493
Support Vector Regression - PCA 11 components:
  MSE: 0.4340, MAE: 0.5034, R2: 0.3520
K-Nearest Neighbors Regression - PCA 11 components:
  MSE: 0.5564, MAE: 0.5774, R2: 0.1692
Gradient Boosting Regression - PCA 11 components:
  MSE: 0.4814, MAE: 0.5488, R2: 0.2812
--------------------------------------------------
Training with 12 PCA components...
Linear Regression - PCA 12 components:
  MSE: 0.5149, MAE: 0.5522, R2: 0.2312
Decision Tree Regression - PCA 12 components:
  MSE: 1.2262, MAE: 0.7262, R2: -0.8308
Random Forest Regression - PCA 12 components:
  MSE: 0.5078, MAE: 0.5641, R2: 0.2418
Support Vector Regression - PCA 12 components:
  MSE: 0.4338, MAE: 0.5024, R2: 0.3523
K-Nearest Neighbors Regression - PCA 12 components:
  MSE: 0.5895, MAE: 0.5857, R2: 0.1198
Gradient Boosting Regression - PCA 12 components:
  MSE: 0.4882, MAE: 0.5566, R2: 0.2710
--------------------------------------------------
Training with 13 PCA components...
Linear Regression - PCA 13 components:
  MSE: 0.5109, MAE: 0.5528, R2: 0.2371
Decision Tree Regression - PCA 13 components:
  MSE: 1.3929, MAE: 0.8095, R2: -1.0797
Random Forest Regression - PCA 13 components:
  MSE: 0.5102, MAE: 0.5638, R2: 0.2383
Support Vector Regression - PCA 13 components:
  MSE: 0.4317, MAE: 0.5054, R2: 0.3555
K-Nearest Neighbors Regression - PCA 13 components:
  MSE: 0.5721, MAE: 0.5702, R2: 0.1457
Gradient Boosting Regression - PCA 13 components:
  MSE: 0.4944, MAE: 0.5546, R2: 0.2618
--------------------------------------------------
Training with 14 PCA components...
Linear Regression - PCA 14 components:
  MSE: 0.5049, MAE: 0.5504, R2: 0.2462
Decision Tree Regression - PCA 14 components:
  MSE: 1.1190, MAE: 0.7143, R2: -0.6708
Random Forest Regression - PCA 14 components:
  MSE: 0.5021, MAE: 0.5613, R2: 0.2504
Support Vector Regression - PCA 14 components:
  MSE: 0.4262, MAE: 0.5044, R2: 0.3637
K-Nearest Neighbors Regression - PCA 14 components:
  MSE: 0.5974, MAE: 0.5845, R2: 0.1081
Gradient Boosting Regression - PCA 14 components:
  MSE: 0.4976, MAE: 0.5628, R2: 0.2570
--------------------------------------------------
Training with 15 PCA components...
Linear Regression - PCA 15 components:
  MSE: 0.5080, MAE: 0.5507, R2: 0.2415
Decision Tree Regression - PCA 15 components:
  MSE: 1.0357, MAE: 0.7024, R2: -0.5464
Random Forest Regression - PCA 15 components:
  MSE: 0.5114, MAE: 0.5666, R2: 0.2364
Support Vector Regression - PCA 15 components:
  MSE: 0.4265, MAE: 0.5080, R2: 0.3632
K-Nearest Neighbors Regression - PCA 15 components:
  MSE: 0.5879, MAE: 0.5798, R2: 0.1223
Gradient Boosting Regression - PCA 15 components:
  MSE: 0.5208, MAE: 0.5810, R2: 0.2224
--------------------------------------------------
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="117"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T11:44:39.300473Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T11:44:39.299248Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T11:44:40.865963Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T11:44:40.864581Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T11:44:39.300426Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb202"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor, GradientBoostingRegressor</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVR</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, r2_score</span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Models to train (including more models)</span></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {</span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear Regression&quot;</span>: LinearRegression(),</span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Decision Tree Regression&quot;</span>: DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Random Forest Regression&quot;</span>: RandomForestRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Support Vector Regression&quot;</span>: SVR(),</span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;K-Nearest Neighbors Regression&quot;</span>: KNeighborsRegressor(),</span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Gradient Boosting Regression&quot;</span>: GradientBoostingRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb202-16"><a href="#cb202-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb202-17"><a href="#cb202-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-18"><a href="#cb202-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through models</span></span>
<span id="cb202-19"><a href="#cb202-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> model_name, model <span class="kw">in</span> models.items():</span>
<span id="cb202-20"><a href="#cb202-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Training </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss"> without PCA...&quot;</span>)</span>
<span id="cb202-21"><a href="#cb202-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-22"><a href="#cb202-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train the model</span></span>
<span id="cb202-23"><a href="#cb202-23" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb202-24"><a href="#cb202-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-25"><a href="#cb202-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make predictions</span></span>
<span id="cb202-26"><a href="#cb202-26" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb202-27"><a href="#cb202-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-28"><a href="#cb202-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluate performance</span></span>
<span id="cb202-29"><a href="#cb202-29" aria-hidden="true" tabindex="-1"></a>    mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb202-30"><a href="#cb202-30" aria-hidden="true" tabindex="-1"></a>    mae <span class="op">=</span> mean_absolute_error(y_test, y_pred)</span>
<span id="cb202-31"><a href="#cb202-31" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb202-32"><a href="#cb202-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-33"><a href="#cb202-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the results</span></span>
<span id="cb202-34"><a href="#cb202-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">:&quot;</span>)</span>
<span id="cb202-35"><a href="#cb202-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;  MSE: </span><span class="sc">{</span>mse<span class="sc">:.4f}</span><span class="ss">, MAE: </span><span class="sc">{</span>mae<span class="sc">:.4f}</span><span class="ss">, R2: </span><span class="sc">{</span>r2<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb202-36"><a href="#cb202-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;-&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Training Linear Regression without PCA...
Linear Regression:
  MSE: 0.5424, MAE: 0.5833, R2: 0.1901
--------------------------------------------------
Training Decision Tree Regression without PCA...
Decision Tree Regression:
  MSE: 1.0357, MAE: 0.6905, R2: -0.5464
--------------------------------------------------
Training Random Forest Regression without PCA...
Random Forest Regression:
  MSE: 0.4716, MAE: 0.5186, R2: 0.2959
--------------------------------------------------
Training Support Vector Regression without PCA...
Support Vector Regression:
  MSE: 0.4434, MAE: 0.5293, R2: 0.3379
--------------------------------------------------
Training K-Nearest Neighbors Regression without PCA...
K-Nearest Neighbors Regression:
  MSE: 0.6405, MAE: 0.6143, R2: 0.0437
--------------------------------------------------
Training Gradient Boosting Regression without PCA...
Gradient Boosting Regression:
  MSE: 0.5083, MAE: 0.5423, R2: 0.2410
--------------------------------------------------
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="127"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T12:19:11.093582Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T12:19:11.093051Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T12:20:22.730021Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T12:20:22.728603Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T12:19:11.093512Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb204"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor, GradientBoostingRegressor</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVR</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, r2_score</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define regressor models</span></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>regressors <span class="op">=</span> {</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear Regression&quot;</span>: LinearRegression(),</span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Decision Tree Regression&quot;</span>: DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Random Forest Regression&quot;</span>: RandomForestRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Support Vector Regression&quot;</span>: SVR(),</span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;K-Nearest Neighbors Regression&quot;</span>: KNeighborsRegressor(),</span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Gradient Boosting Regression&quot;</span>: GradientBoostingRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Define hyperparameter grids for each regressor</span></span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a>param_grids_regressors <span class="op">=</span> {</span>
<span id="cb204-21"><a href="#cb204-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Linear Regression&quot;</span>: {},</span>
<span id="cb204-22"><a href="#cb204-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Decision Tree Regression&quot;</span>: {</span>
<span id="cb204-23"><a href="#cb204-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;max_depth&quot;</span>: [<span class="va">None</span>, <span class="dv">10</span>, <span class="dv">20</span>],</span>
<span id="cb204-24"><a href="#cb204-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;min_samples_split&quot;</span>: [<span class="dv">2</span>, <span class="dv">5</span>],</span>
<span id="cb204-25"><a href="#cb204-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;min_samples_leaf&quot;</span>: [<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb204-26"><a href="#cb204-26" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb204-27"><a href="#cb204-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Random Forest Regression&quot;</span>: {</span>
<span id="cb204-28"><a href="#cb204-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;n_estimators&quot;</span>: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>],</span>
<span id="cb204-29"><a href="#cb204-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;max_depth&quot;</span>: [<span class="va">None</span>, <span class="dv">10</span>, <span class="dv">20</span>],</span>
<span id="cb204-30"><a href="#cb204-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;min_samples_split&quot;</span>: [<span class="dv">2</span>, <span class="dv">5</span>],</span>
<span id="cb204-31"><a href="#cb204-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;min_samples_leaf&quot;</span>: [<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb204-32"><a href="#cb204-32" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb204-33"><a href="#cb204-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Support Vector Regression&quot;</span>: {</span>
<span id="cb204-34"><a href="#cb204-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;kernel&quot;</span>: [<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;rbf&#39;</span>],</span>
<span id="cb204-35"><a href="#cb204-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;C&quot;</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>],</span>
<span id="cb204-36"><a href="#cb204-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;gamma&quot;</span>: [<span class="st">&#39;scale&#39;</span>, <span class="st">&#39;auto&#39;</span>]</span>
<span id="cb204-37"><a href="#cb204-37" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb204-38"><a href="#cb204-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;K-Nearest Neighbors Regression&quot;</span>: {</span>
<span id="cb204-39"><a href="#cb204-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;n_neighbors&quot;</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb204-40"><a href="#cb204-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;weights&quot;</span>: [<span class="st">&#39;uniform&#39;</span>, <span class="st">&#39;distance&#39;</span>]</span>
<span id="cb204-41"><a href="#cb204-41" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb204-42"><a href="#cb204-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Gradient Boosting Regression&quot;</span>: {</span>
<span id="cb204-43"><a href="#cb204-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;learning_rate&quot;</span>: [<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>],</span>
<span id="cb204-44"><a href="#cb204-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;n_estimators&quot;</span>: [<span class="dv">50</span>, <span class="dv">100</span>],</span>
<span id="cb204-45"><a href="#cb204-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;max_depth&quot;</span>: [<span class="dv">3</span>, <span class="dv">5</span>]</span>
<span id="cb204-46"><a href="#cb204-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb204-47"><a href="#cb204-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb204-48"><a href="#cb204-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-49"><a href="#cb204-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform GridSearchCV for each regressor</span></span>
<span id="cb204-50"><a href="#cb204-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> model_name, model <span class="kw">in</span> regressors.items():</span>
<span id="cb204-51"><a href="#cb204-51" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Grid search for </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb204-52"><a href="#cb204-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb204-53"><a href="#cb204-53" aria-hidden="true" tabindex="-1"></a>    grid_search <span class="op">=</span> GridSearchCV(model, param_grids_regressors[model_name], cv<span class="op">=</span><span class="dv">5</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">&#39;neg_mean_squared_error&#39;</span>)</span>
<span id="cb204-54"><a href="#cb204-54" aria-hidden="true" tabindex="-1"></a>    grid_search.fit(X_train, y_train)</span>
<span id="cb204-55"><a href="#cb204-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb204-56"><a href="#cb204-56" aria-hidden="true" tabindex="-1"></a>    best_model <span class="op">=</span> grid_search.best_estimator_</span>
<span id="cb204-57"><a href="#cb204-57" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> best_model.predict(X_test)</span>
<span id="cb204-58"><a href="#cb204-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb204-59"><a href="#cb204-59" aria-hidden="true" tabindex="-1"></a>    mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb204-60"><a href="#cb204-60" aria-hidden="true" tabindex="-1"></a>    mae <span class="op">=</span> mean_absolute_error(y_test, y_pred)</span>
<span id="cb204-61"><a href="#cb204-61" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb204-62"><a href="#cb204-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb204-63"><a href="#cb204-63" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Best parameters for </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>grid_search<span class="sc">.</span>best_params_<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb204-64"><a href="#cb204-64" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Test MSE: </span><span class="sc">{</span>mse<span class="sc">:.4f}</span><span class="ss">, MAE: </span><span class="sc">{</span>mae<span class="sc">:.4f}</span><span class="ss">, R2: </span><span class="sc">{</span>r2<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb204-65"><a href="#cb204-65" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;-&quot;</span> <span class="op">*</span> <span class="dv">40</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Grid search for Linear Regression...
Best parameters for Linear Regression: {}
Test MSE: 0.5424, MAE: 0.5833, R2: 0.1901
----------------------------------------
Grid search for Decision Tree Regression...
Best parameters for Decision Tree Regression: {&#39;max_depth&#39;: 10, &#39;min_samples_leaf&#39;: 2, &#39;min_samples_split&#39;: 2}
Test MSE: 0.8448, MAE: 0.6547, R2: -0.2614
----------------------------------------
Grid search for Random Forest Regression...
Best parameters for Random Forest Regression: {&#39;max_depth&#39;: 10, &#39;min_samples_leaf&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 100}
Test MSE: 0.4625, MAE: 0.5229, R2: 0.3095
----------------------------------------
Grid search for Support Vector Regression...
Best parameters for Support Vector Regression: {&#39;C&#39;: 1, &#39;gamma&#39;: &#39;scale&#39;, &#39;kernel&#39;: &#39;rbf&#39;}
Test MSE: 0.4434, MAE: 0.5293, R2: 0.3379
----------------------------------------
Grid search for K-Nearest Neighbors Regression...
Best parameters for K-Nearest Neighbors Regression: {&#39;n_neighbors&#39;: 7, &#39;weights&#39;: &#39;distance&#39;}
Test MSE: 0.5905, MAE: 0.5926, R2: 0.1183
----------------------------------------
Grid search for Gradient Boosting Regression...
Best parameters for Gradient Boosting Regression: {&#39;learning_rate&#39;: 0.1, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 50}
Test MSE: 0.4636, MAE: 0.5239, R2: 0.3079
----------------------------------------
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="125"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-11-26T12:15:27.139560Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-11-26T12:15:27.139082Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-11-26T12:16:55.518737Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-11-26T12:16:55.517444Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-11-26T12:15:27.139515Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb206"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier, GradientBoostingClassifier</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define classifier models</span></span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>classifiers <span class="op">=</span> {</span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Logistic Regression&#39;</span>: LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>),</span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Decision Tree&#39;</span>: DecisionTreeClassifier(),</span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Random Forest&#39;</span>: RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Support Vector Classifier&#39;</span>: SVC(),</span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;K-Nearest Neighbors&#39;</span>: KNeighborsClassifier(),</span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Gradient Boosting Classifier&#39;</span>: GradientBoostingClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Naive Bayes&#39;</span>: GaussianNB()</span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Define hyperparameter grids for each classifier</span></span>
<span id="cb206-22"><a href="#cb206-22" aria-hidden="true" tabindex="-1"></a>param_grids_classifiers <span class="op">=</span> {</span>
<span id="cb206-23"><a href="#cb206-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Logistic Regression&#39;</span>: {</span>
<span id="cb206-24"><a href="#cb206-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;C&#39;</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>],</span>
<span id="cb206-25"><a href="#cb206-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;solver&#39;</span>: [<span class="st">&#39;liblinear&#39;</span>, <span class="st">&#39;saga&#39;</span>]</span>
<span id="cb206-26"><a href="#cb206-26" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb206-27"><a href="#cb206-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Decision Tree&#39;</span>: {</span>
<span id="cb206-28"><a href="#cb206-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_depth&#39;</span>: [<span class="va">None</span>, <span class="dv">10</span>, <span class="dv">20</span>],</span>
<span id="cb206-29"><a href="#cb206-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>],</span>
<span id="cb206-30"><a href="#cb206-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb206-31"><a href="#cb206-31" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb206-32"><a href="#cb206-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Random Forest&#39;</span>: {</span>
<span id="cb206-33"><a href="#cb206-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>],</span>
<span id="cb206-34"><a href="#cb206-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_depth&#39;</span>: [<span class="va">None</span>, <span class="dv">10</span>, <span class="dv">20</span>],</span>
<span id="cb206-35"><a href="#cb206-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>],</span>
<span id="cb206-36"><a href="#cb206-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb206-37"><a href="#cb206-37" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb206-38"><a href="#cb206-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Support Vector Classifier&#39;</span>: {</span>
<span id="cb206-39"><a href="#cb206-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;kernel&#39;</span>: [<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;rbf&#39;</span>],</span>
<span id="cb206-40"><a href="#cb206-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;C&#39;</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>],</span>
<span id="cb206-41"><a href="#cb206-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;gamma&#39;</span>: [<span class="st">&#39;scale&#39;</span>, <span class="st">&#39;auto&#39;</span>]</span>
<span id="cb206-42"><a href="#cb206-42" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb206-43"><a href="#cb206-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;K-Nearest Neighbors&#39;</span>: {</span>
<span id="cb206-44"><a href="#cb206-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;n_neighbors&#39;</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb206-45"><a href="#cb206-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;weights&#39;</span>: [<span class="st">&#39;uniform&#39;</span>, <span class="st">&#39;distance&#39;</span>]</span>
<span id="cb206-46"><a href="#cb206-46" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb206-47"><a href="#cb206-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Gradient Boosting Classifier&#39;</span>: {</span>
<span id="cb206-48"><a href="#cb206-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;learning_rate&#39;</span>: [<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>],</span>
<span id="cb206-49"><a href="#cb206-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">50</span>, <span class="dv">100</span>],</span>
<span id="cb206-50"><a href="#cb206-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;max_depth&#39;</span>: [<span class="dv">3</span>, <span class="dv">5</span>]</span>
<span id="cb206-51"><a href="#cb206-51" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb206-52"><a href="#cb206-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Naive Bayes&#39;</span>: {}</span>
<span id="cb206-53"><a href="#cb206-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb206-54"><a href="#cb206-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-55"><a href="#cb206-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform GridSearchCV for each classifier</span></span>
<span id="cb206-56"><a href="#cb206-56" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> model_name, model <span class="kw">in</span> classifiers.items():</span>
<span id="cb206-57"><a href="#cb206-57" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Grid search for </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb206-58"><a href="#cb206-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-59"><a href="#cb206-59" aria-hidden="true" tabindex="-1"></a>    grid_search <span class="op">=</span> GridSearchCV(model, param_grids_classifiers[model_name], cv<span class="op">=</span><span class="dv">5</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>, scoring<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>)</span>
<span id="cb206-60"><a href="#cb206-60" aria-hidden="true" tabindex="-1"></a>    grid_search.fit(X_train, y_train)</span>
<span id="cb206-61"><a href="#cb206-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-62"><a href="#cb206-62" aria-hidden="true" tabindex="-1"></a>    best_model <span class="op">=</span> grid_search.best_estimator_</span>
<span id="cb206-63"><a href="#cb206-63" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> best_model.predict(X_test)</span>
<span id="cb206-64"><a href="#cb206-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-65"><a href="#cb206-65" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb206-66"><a href="#cb206-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-67"><a href="#cb206-67" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Best parameters for </span><span class="sc">{</span>model_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>grid_search<span class="sc">.</span>best_params_<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb206-68"><a href="#cb206-68" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Test Accuracy: </span><span class="sc">{</span>accuracy<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb206-69"><a href="#cb206-69" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;-&quot;</span> <span class="op">*</span> <span class="dv">40</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Grid search for Logistic Regression...
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/model_selection/_split.py:700: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/linear_model/_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Best parameters for Logistic Regression: {&#39;C&#39;: 1, &#39;solver&#39;: &#39;liblinear&#39;}
Test Accuracy: 0.5417
----------------------------------------
Grid search for Decision Tree...
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/model_selection/_split.py:700: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Best parameters for Decision Tree: {&#39;max_depth&#39;: 10, &#39;min_samples_leaf&#39;: 1, &#39;min_samples_split&#39;: 5}
Test Accuracy: 0.5357
----------------------------------------
Grid search for Random Forest...
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/model_selection/_split.py:700: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Best parameters for Random Forest: {&#39;max_depth&#39;: 10, &#39;min_samples_leaf&#39;: 2, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 50}
Test Accuracy: 0.5833
----------------------------------------
Grid search for Support Vector Classifier...
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/model_selection/_split.py:700: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Best parameters for Support Vector Classifier: {&#39;C&#39;: 10, &#39;gamma&#39;: &#39;scale&#39;, &#39;kernel&#39;: &#39;linear&#39;}
Test Accuracy: 0.5060
----------------------------------------
Grid search for K-Nearest Neighbors...
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/model_selection/_split.py:700: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Best parameters for K-Nearest Neighbors: {&#39;n_neighbors&#39;: 7, &#39;weights&#39;: &#39;distance&#39;}
Test Accuracy: 0.4643
----------------------------------------
Grid search for Gradient Boosting Classifier...
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/model_selection/_split.py:700: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Best parameters for Gradient Boosting Classifier: {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 50}
Test Accuracy: 0.5833
----------------------------------------
Grid search for Naive Bayes...
Best parameters for Naive Bayes: {}
Test Accuracy: 0.3036
----------------------------------------
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/model_selection/_split.py:700: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  warnings.warn(
</code></pre>
</div>
</div>
</body>
</html>
